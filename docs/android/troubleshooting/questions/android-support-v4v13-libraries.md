---
title: Оптимизированные пакеты NuGet поддержки Android v4 и v13 в Xamarin
ms.topic: troubleshooting
ms.prod: xamarin
ms.assetid: FE66A82A-6C05-4646-BC52-E806F5DC606C
ms.technology: xamarin-android
author: conceptdev
ms.author: crdun
ms.date: 03/09/2018
ms.openlocfilehash: 64ceacc37a303e69b0dd7073ec6547ed344af51d
ms.sourcegitcommit: 6264fb540ca1f131328707e295e7259cb10f95fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/16/2019
ms.locfileid: "69523432"
---
# <a name="smarter-xamarin-android-support-v4--v13-nuget-packages"></a>Оптимизированные пакеты NuGet поддержки Android v4 и v13 в Xamarin

## <a name="about-the-android-support-libraries"></a>Сведения о библиотеках поддержки Android

Google создал библиотеки поддержки, чтобы сделать новые функции доступными для старых версий Android. Как правило, библиотекам поддержки предоставляется номер версии, который является самым низким уровнем API Android, с которым они совместимы (например: Поддержка — v4 может использоваться только на API уровня 4 и выше. Дополнительные сведения см. в этом [Stack overflow обсуждении](https://stackoverflow.com/questions/9926403/android-support-package-compatibility-library-use-v4-or-v13)). 

Две библиотеки поддержки: `Support-v4` и `Support-v13` не могут использоваться вместе в одном приложении, то есть являются взаимоисключающими. Это связано с `Support-v13` тем, что фактически содержит все типы и `Support-v4`реализацию. Если вы попробуете и сослаться на оба проекта в одном и том же проекте, возникнут ошибки с повторяющимися типами.

## <a name="problems-with-referencing"></a>Проблемы со ссылками

Поскольку `Support-v4` стало настолько популярным, теперь от него зависят многие сторонние библиотеки. Они могут зависеть от support-V13, но чаще всего они зависят от _версии 4_ , так как это дает приложениям, использующим сторонние библиотеки, возможность поддержки уровней API в меньшую сторону до 4.

Если библиотека стороннего производителя Xamarin ссылается `Xamarin.Android.Support.v4.dll` на привязку к `Support-v4`, любое приложение, использующее эту библиотеку, также должно ссылаться на. `Xamarin.Android.Support.v4.dll` Это считается проблемой, когда тому же приложению требуется использовать некоторые функции из `Xamarin.Android.Support.v13.dll` привязки к. `Support-v13` Если вы ссылаетесь на обе привязки, возникнут ошибки с повторяющимися типами.

## <a name="type-forwarded-v4-binding-assembly"></a>Тип-перенаправленная сборка привязки v4

Чтобы обойти эту проблему, `Xamarin.Android.Support.v4.dll` мы создали специальную сборку, которая не имеет реализации, но просто `[assembly: TypeForwardedTo (..)]` атрибуты, перенаправляющие все `Support-v4` типы в реализацию в `Xamarin.Android.Support.v13.dll` сборке.

Это означает, что разработчик может ссылаться на эту сборку перенаправления _типа_ в своем приложении, которая будет соответствовать ссылке `Xamarin.Android.Support.v4.dll` на любые сторонние библиотеки, сохраняя при этом разрешение `Xamarin.Android.Support.v13.dll` на использование в приложении.

## <a name="nuget-assistance"></a>Помощь по NuGet

Хотя разработчик может вручную добавить нужные ссылки, мы можем использовать NuGet, чтобы помочь выбрать правильную сборку (либо обычную привязку _v4_ , либо сборку с пересылкой типа _v4_ ) при установке пакета NuGet.

Таким образом, `Xamarin.Android.Support.v4` пакет NuGet теперь содержит следующую логику:

Если приложение предназначено для API уровня 13 (Gingerbread 3,2) или более поздней версии:

* `Xamarin.Android.Support.v13`NuGet будет автоматически добавлен в качестве зависимости
* На `Xamarin.Android.Support.v4.dll` перенаправленный тип будет указана ссылка в проекте

Если приложение нацелено на нечто меньше, чем API уровня 13, вы получите нормальную `Xamarin.Android.Support.v4.dll` привязку, на которую ссылается проект.

## <a name="do-i-have-to-use-support-v13"></a>Нужно ли использовать support-V13?

Если приложение предназначено для API уровня 13 или выше и вы решили использовать `Xamarin Android Support-v4` пакет NuGet, `Xamarin Android Support v13` то пакет NuGet является обязательной зависимостью.

Мы почувствуете, что очень незначительное увеличение размера приложения (два JAR-файла, отличающиеся 17kb), хорошо проявляется для обеспечения совместимости и меньшего количества проблем.

Если вы непреклонен об использовании `Support-v4` в приложении, ориентированном на API уровня 13 или выше, вы всегда можете вручную `.nupkg`скачать, извлечь и создать ссылку на сборку.
