---
title: "Части RecyclerView и функциональные возможности"
ms.topic: article
ms.prod: xamarin
ms.assetid: 54F999BE-2732-4BC7-A466-D17373961C48
ms.technology: xamarin-android
author: mgmclemore
ms.author: mamcle
ms.date: 03/01/2018
ms.openlocfilehash: 89679f7d825422ab34dd77b31a7a3fde60f36e99
ms.sourcegitcommit: 30055c534d9caf5dffcfdeafd6f08e666fb870a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2018
---
# <a name="recyclerview-parts-and-functionality"></a>Части RecyclerView и функциональные возможности


`RecyclerView` дескрипторы, некоторые задачи внутренним образом (например, прокрутки и повторное использование представлений), но он является по сути диспетчер, координирующий вспомогательные классы для отображения коллекции. `RecyclerView` Класс делегирует задачи для следующих вспомогательных классов.

-   **`Adapter`** &ndash; Увеличивает макеты элементов (создает содержимое файла макета) данные и привязывающий их к представлениям, которые отображаются в `RecyclerView`. Адаптер также сообщает событие щелчка элемента.

-   **`LayoutManager`** &ndash; Измеряет и помещает представления элемента в пределах `RecyclerView` и управляет политикой перезапуска представления.

-   **`ViewHolder`** &ndash; Ищет и сохраняет ссылки на представление. Владелец представления также помогает обеспечивать обнаружение щелчков представление элемента.

-   **`ItemDecoration`** &ndash; Позволяет приложению для добавления специальных смещения рисования и макет для конкретного представления для отображения разделителей между элементами, выделяет и визуальную группировку границы.

-   **`ItemAnimator`** &ndash; Определяет анимацию, возникающие во время выполнения действия с элементами, или как изменения вносятся в адаптер.

Связь между `RecyclerView`, `LayoutManager`, и `Adapter` классы показано на следующей схеме:

![Схема RecyclerView, содержащая LayoutManager, с помощью адаптера для доступа к набору данных](parts-and-functionality-images/01-recyclerview-diagram.png)

Как показано на рисунке, `LayoutManager` можно рассматривать как посредник между `Adapter` и `RecyclerView`. `LayoutManager` Обращающийся к `Adapter` методы от имени `RecyclerView`. Например `LayoutManager` вызовы `Adapter` метод, когда все готово для создания нового представления для определенной позиции в `RecyclerView`. `Adapter` Увеличивает макета для этого элемента и создает `ViewHolder` экземпляра (не показано) для кэширования ссылок на представления в этой позиции. При `LayoutManager` вызовы `Adapter` для привязки к набору данных, какой-либо элемент `Adapter` находит данные для этого элемента, он извлекает из набора данных и копирует его в представлении связанного элемента.

При использовании `RecyclerView` в приложения, не требуется создания производных типов следующие классы:

-   **`RecyclerView.Adapter`** &ndash; Предоставляет привязку из набора данных приложения (который зависит от приложения) для представления элементов, отображаемых в `RecyclerView`. Адаптер данных знает, как связать Каждая позиция представление элемента в `RecyclerView` на конкретные расположения в источнике данных. Кроме того адаптер обрабатывает макета содержимого внутри каждого отдельного элемента и создает владелец представления для каждого представления. Адаптер также отчеты, щелкните элемент события, которые определяются в представление элемента.

-   **`RecyclerView.ViewHolder`** &ndash; Кэширует ссылки на представления в файле макета элемента, чтобы поиск ресурсов без необходимости не повторяются. Владелец представления также упорядочивает для элемента-событий для пересылки адаптер, когда пользователь касается представление владельца представления связанного элемента.

-   **`RecyclerView.LayoutManager`** &ndash; Помещает элементы в пределах `RecyclerView`. Можно использовать один из нескольких стандартных макета менеджеров, или можно реализовать собственный пользовательский макет диспетчера.
    `RecyclerView` делегаты политику макета для диспетчера макета, поэтому можно подключить другой макет диспетчером без внесения значительных изменений приложения.

Кроме того, при необходимости можно расширить следующие классы для изменения внешнего вида `RecyclerView` в приложении:

-   **`RecyclerView.ItemDecoration`**
-   **`RecyclerView.ItemAnimator`**

Если вы не расширили `ItemDecoration` и `ItemAnimator`, `RecyclerView` использует по умолчанию реализации. В этом руководстве не описывается создание пользовательских `ItemDecoration` и `ItemAnimator` классы; Дополнительные сведения об этих классах см. в разделе [RecyclerView.ItemDecoration](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemDecoration.html) и [RecyclerView.ItemAnimator](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemAnimator.html).


<a name="recycling" />

### <a name="how-view-recycling-works"></a>Как просмотреть перезапуск работает

`RecyclerView` не выделяет для представления элемента для каждого элемента в источнике данных. Вместо этого он выделяет количество представления элемента, которые помещаются на экране и будет повторно использоваться макеты этих элементов прокрутке пользователем. При представлении сначала прокручивается за пределы видимости, он проходит через утилизации процесс, представленный на следующем рисунке:

[![Диаграмма, иллюстрирующая шесть шагов перезапуска представления](parts-and-functionality-images/02-view-recycling-sml.png)](parts-and-functionality-images/02-view-recycling.png#lightbox)

1.  При представлении прокручивается за пределы видимости и больше не отображается, она становится *отходов представление*.

2.  Представление отходов помещается в пул и становится *повторно использовать представление*.
    Этот пул — это кэш представлений, которые отображают того же типа данных.

3.  Если новый элемент будет отображаться, представление берется из пула очистки для повторного использования. Так как в этом представлении необходимо повторно привязать адаптером до их отображения, он называется *"грязный" представление*.

4.  Представление «грязных» будет повторен: адаптер находит данные для следующего элемента для отображения и копирует эти данные представления для этого элемента. Ссылки на эти представления извлекаются из владелец представления, связанные с представлением перезапущен.

5.  Повторно добавляется в список элементов в `RecyclerView` , которые к переходу на экране.

6.  Представление перезапущен переходит на экране прокрутке пользователем `RecyclerView` к следующему элементу в списке. В то же время другое представление прокручивается за пределы видимости и будет перезапущен согласно указанные выше шаги.

Помимо представление элементов многократного использования `RecyclerView` также использует другой оптимизации эффективности: просмотр владельцев. Объект *владелец представления* — это простой класс, что кэши Просмотр ссылок. Каждый раз, адаптер увеличивает файл макета элемента также создает соответствующий владелец представления. Владелец представления использует `FindViewById` для получения ссылок на представления в файле увеличенную макета элемента. Эти ссылки используются для загрузки новых данных в представления, каждый раз при перезапуске макет для отображения новых данных.
 


### <a name="the-layout-manager"></a>Диспетчер макета

Диспетчер макет отвечает за размещение элементов в `RecyclerView` отображения; она определяет тип презентации (список или сетки) и ориентацию (ли элементы отображаются вертикально или горизонтально), а также отображать элементы, которые направление (в обычном порядке или в обратном порядке). Диспетчер макета также отвечает за вычисление размера и положения каждого элемента в **RecycleView** отображения.

Диспетчер макета имеет дополнительные назначение: он определяет политику о том, когда нужно перезапустить представления элементов, которые больше не отображаются для пользователя.
Поскольку диспетчер макет учитывает представлений, к которым отображаются (а какие — нет), это наилучшим образом, чтобы определить, когда представление может быть перезапущен. Повторно использовать представление, диспетчера структуры обычно вызывает адаптер для замены содержимого перезапущен представления с другими данными, как описано ранее в [представление перезапуск принцип](#recycling).

Вы можете расширить `RecyclerView.LayoutManager` создать собственный макет manager, или можно использовать диспетчер стандартных макета. `RecyclerView` предоставляет следующие диспетчеры предварительно определенного макета.

-   **`LinearLayoutManager`** &ndash; Упорядочивает элементы в столбце, который может прокручиваться по вертикали или в строке, которая может прокручиваться по горизонтали.

-   **`GridLayoutManager`** &ndash; Отображение элементов в сетке.

-   **`StaggeredGridLayoutManager`** &ndash; Отображение элементов сетки по ширине, где некоторые элементы имеют различные значения высоты и ширины.

Для задания диспетчера макета, создать экземпляр руководителю выбранного макета и передать его в `SetLayoutManager` метод. Обратите внимание, которую *должен* Укажите диспетчер макета &ndash; `RecyclerView` не выбран диспетчер стандартных макета по умолчанию.

Дополнительные сведения о диспетчере макет см. в разделе [ссылку на класс RecyclerView.LayoutManager](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.LayoutManager.html).


### <a name="the-view-holder"></a>Владелец представления

Владелец представления является классом, определить для кэширования ссылок на представление. Адаптер использует эти ссылки представления для привязки каждого представления на его содержимое. Каждый элемент в `RecyclerView` экземпляром владельца связанного представления, который кэширует Просмотр ссылок для этого элемента. Чтобы создать владельца представления, используйте следующие шаги для определения класса, содержащего набор представления каждого элемента:

1.  Подкласс `RecyclerView.ViewHolder`.
2.  Реализуйте конструктор, который ищет и сохраняет Просмотр ссылок.
3.  Реализуйте свойства, которые можно использовать адаптер для доступа к эти ссылки.

Подробный пример `ViewHolder` реализация представлена на [простой пример RecyclerView](~/android/user-interface/layouts/recycler-view/recyclerview-example.md).
Дополнительные сведения о `RecyclerView.ViewHolder`, в разделе [ссылку на класс RecyclerView.ViewHolder](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ViewHolder.html).


### <a name="the-adapter"></a>Адаптер

Большая часть «тяжелых операций» из `RecyclerView` интеграции кода выполняется в адаптере. `RecyclerView` необходимо указать адаптер производными `RecyclerView.Adapter` для доступа к источнику данных и заполнения каждого элемента с содержимым источника данных.
Так как источник данных зависит от конкретного приложения, необходимо реализовать функциональные возможности адаптер, способный осуществлять доступ к данным. Адаптер извлекает данные из источника данных и загружает их в каждый элемент в `RecyclerView` коллекции.

На рисунке показано, как адаптер сопоставление содержимого в источнике данных через представление владельцев отдельных представлений в рамках каждого элемента строки в `RecyclerView`:

[![Диаграмма, иллюстрирующая адаптер, подключенный источник данных для ViewHolders](parts-and-functionality-images/03-recyclerviewer-adapter-sml.png)](parts-and-functionality-images/03-recyclerviewer-adapter.png#lightbox)

Адаптер загружает каждую `RecyclerView` строку с данными для конкретной строки элемента. Для позиции строки *P*, например, адаптер находит связанные данные в позиции *P* в пределах источника данных и копирует эти данные в строку элемента в позиции *P* в `RecyclerView` коллекции.
В документе выше, например, адаптер использует владелец представления для уточняющего запроса ссылок для `ImageView` и `TextView` в этой позиции, поэтому не требуется многократно вызывать `FindViewById` для этих представлений, как пользователь выполняет прокрутку коллекции и повторно использует представления.

При реализации адаптера, необходимо переопределить следующие `RecyclerView.Adapter` методов:

-   **`OnCreateViewHolder`** &ndash; Создает экземпляр владелец файла и представление макета элемента.

-   **`OnBindViewHolder`** &ndash; Загружает данные в указанной позиции в представления, ссылки для которых хранятся в владелец данного представления.

-   **`ItemCount`** &ndash; Возвращает количество элементов в источнике данных.

Диспетчер макета вызывает эти методы, пока он размещение элементов в пределах `RecyclerView`. 



### <a name="notifying-recyclerview-of-data-changes"></a>Уведомление RecyclerView изменений данных

`RecyclerView` не обновляет автоматически изображения при изменении; источника содержимого его данных адаптер должен уведомить `RecyclerView` при наличии изменений в наборе данных. Набор данных можно изменить несколькими способами; Например можно изменить содержимое в элементе или общую структуру данных могут быть изменены.
`RecyclerView.Adapter` предоставляет ряд методов, которые можно вызвать, чтобы `RecyclerView` реагирует на изменения данных, самым эффективным способом:

-  **`NotifyItemChanged`** &ndash; Указывает, был изменен элемент в указанной позиции.

-  **`NotifyItemRangeChanged`** &ndash; Указывает, были изменены элементы в указанном диапазоне позиций.

-  **`NotifyItemInserted`** &ndash; Сигналы вновь вставить элемент в указанной позиции.

-  **`NotifyItemRangeInserted`** &ndash; Сообщает, что вновь вставки элементов в указанном диапазоне позиций.

-  **`NotifyItemRemoved`** &ndash; Указывает, удален ли элемент в указанной позиции.

-  **`NotifyItemRangeRemoved`** &ndash; Сообщает, что были удалены элементы в указанном диапазоне позиций.

-  **`NotifyDataSetChanged`** &ndash; Сигнализирует о наборе данных изменилась (вызывает полное обновление).

Если вы знаете точно, как изменилась набора данных, можно вызвать соответствующие методы выше, чтобы обновить `RecyclerView` наиболее эффективным образом. Если вы не знаете точно, как изменилась набора данных, можно вызвать `NotifyDataSetChanged`, является более эффективным поскольку `RecyclerView` необходимо обновить все представления, которые отображаются для пользователя. Дополнительные сведения об этих методах см. в разделе [RecyclerView.Adapter](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Adapter.html).

В следующем разделе [простой пример RecyclerView](~/android/user-interface/layouts/recycler-view/recyclerview-example.md), пример приложения реализуется для демонстрации реальные примеры частей и функциональных возможностей, описанных выше.


## <a name="related-links"></a>Связанные ссылки

- [RecyclerView](~/android/user-interface/layouts/recycler-view/index.md)
- [Простой пример RecyclerView](~/android/user-interface/layouts/recycler-view/recyclerview-example.md)
- [В примере RecyclerView расширение](~/android/user-interface/layouts/recycler-view/extending-the-example.md)
- [RecyclerView](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html)
