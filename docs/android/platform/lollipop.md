---
title: Возможности Lollipop
description: В этой статье представлен общий обзор новых функций, появившихся в Android 5.0 (Lollipop). К ним относятся новый стиль пользовательского интерфейса под названием Material Theme, а также новые вспомогательные функции, такие как анимация, тени представлений и окраска прорисовываемых ресурсов. В Android 5.0 также включены расширенные уведомления, два новых мини-приложения пользовательского интерфейса, новый планировщик заданий и несколько новых интерфейсов API для улучшения функций хранилища, сети, подключений и мультимедиа.
ms.prod: xamarin
ms.assetid: 1CE99CFE-FAAC-49FC-AEDC-1A21FC6E946E
ms.technology: xamarin-android
author: davidortinau
ms.author: daortin
ms.date: 02/16/2018
ms.openlocfilehash: 297c7806ce8a880d65c38ef0e4672e41fee5acfe
ms.sourcegitcommit: 9ee02a2c091ccb4a728944c1854312ebd51ca05b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2020
ms.locfileid: "76724446"
---
# <a name="lollipop-features"></a>Возможности Lollipop

_В этой статье представлен общий обзор новых функций, появившихся в Android 5.0 (Lollipop). К ним относятся новый стиль пользовательского интерфейса под названием Material Theme, а также новые вспомогательные функции, такие как анимация, тени представлений и окраска прорисовываемых ресурсов. В Android 5.0 также включены улучшенные уведомления, два новых мини-приложения пользовательского интерфейса, новый планировщик заданий и несколько новых интерфейсов API для улучшения функций хранилища, сети, подключений и мультимедиа._

## <a name="lollipop-overview"></a>Обзор Lollipop

В Android 5.0 (Lollipop) представлен новый язык проектирования, *Material Design*, а также ряд совместимых с ним функций, упрощающих использование приложения и делающих работу с ними интуитивно понятной. Благодаря Material Design платформа Android 5.0 не только улучшает оформление системы на телефонах Android, но обеспечивает новый набор правил проектирования для планшетов, компьютеров, часов и устройств Smart TV под управлением Android. Эти правила проектирования придают особое значение простоте и минимализму, а также применению осязаемых атрибутов (например, реалистичной поверхности и граничных меток), чтобы помочь пользователям быстро и интуитивно освоить интерфейс.

*Material Theme* воплощает в себе эти принципы проектирования пользовательского интерфейса в Android. Данная статья начинается с описания вспомогательных функций Material Theme.

- **Анимация** &ndash; анимация *реакции на касания*, *перехода действий*, *изменения состояния просмотра* и *эффектов раскрытия*.

- **Тени и возвышение представлений** &ndash; теперь у представлений имеется свойство `elevation`. Представления с более высоким значением `elevation` отбрасывают более крупные тени на фон.

- **Функции управления цветом** &ndash; *окраска прорисовываемых ресурсов* позволяет многократно использовать ресурсы изображений, изменяя их цвет, а *определение преобладающих цветов* помогает динамически адаптировать тему приложения на основе цветов на изображении.

Многие функции Material Theme уже встроены в пользовательский интерфейс Android 5.0, но некоторые из них нужно явно добавлять в приложения. Например, некоторые стандартные представления (например, кнопки) уже оснащены анимацией реакции на касание, тогда как тени для большинства представлений в приложениях нужно включать отдельно.

Помимо улучшений пользовательского интерфейса, которые были добавлены с помощью Material Theme, Android 5.0 также включает в себя ряд других новых функций, описанных в этой статье:

- **Улучшенные уведомления** &ndash; уведомления в Android 5.0 значительно обновлены за счет нового оформления, поддержки уведомлений на экране блокировки и нового формата представления уведомлений, *Heads-up*.

- **Новые мини-приложения пользовательского интерфейса** &ndash; новое мини-приложении `RecyclerView` упрощает передачу больших наборов данных и сложной информации, а мини-приложение `CardView` предоставляет упрощенный формат представления для отображения текста и изображений на картах.

- **Новые API** &ndash; в Android 5.0 добавлены новые API для поддержки нескольких сетей, улучшения связи Bluetooth, упрощения управления хранилищем и более гибкого управления мультимедийными проигрывателями и камерами. Доступна новая функция планирования заданий для асинхронного выполнения задач в запланированное время. Эта функция помогает повысить время работы аккумулятора, например, за счет планирования выполнения задач на периоды, когда устройство подключено к сети электропитания и заряжается.

## <a name="requirements"></a>Требования

Для использования новых возможностей Android 5.0 в приложениях Xamarin требуется следующее:

- **Xamarin. Android** &ndash; необходимо установить Xamarin.Android 4.20 или более поздней версии и настроить это расширение в Visual Studio или Visual Studio для Mac.

- **Пакет SDK для Android** &ndash; нужно установить пакет SDK для Android 5.0 (API 21) или более поздней версии через Диспетчер SDK Android.

- **Java Developer Kit** &ndash; для Xamarin.Android требуется [JDK 1.8](https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html) или более поздней версии при разработке для уровня API 24 или выше (JDK 1.8 также поддерживает уровни API ниже 24, в том числе Lollipop). 64-разрядная версия JDK 1.8 необходима, если используются пользовательские элементы управления или средство предварительного просмотра Forms.

При разработке специально для уровня API 23 или ниже можно продолжать использовать пакет [JDK 1.7](https://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html).

## <a name="setting-up-an-android-50-project"></a>Настройка проекта Android 5.0

Чтобы создать проект Android 5.0, необходимо установить последние версии инструментов и пакетов SDK. Чтобы настроить проект Xamarin.Android, нацеленный на Android 5.0, выполните следующие действия.

1. Установите инструменты Xamarin.Android и активируйте свою лицензию Xamarin. Дополнительные сведения об установке Xamarin.Android см. в разделе [Настройка и установка](~/android/get-started/installation/index.md).

2. Если вы используете Visual Studio для Mac, установите последние обновления для Android 5.0.

3. Запустите Диспетчер SDK Android (в Visual Studio для Mac выберите элементы **Сервис &gt; Открыть диспетчер пакетов SDK Android&hellip;** ) и установите Android SDK Tools 23.0.5 или более поздней версии.

    [![Выбор Android SDK Tools в Диспетчере SDK Android](lollipop-images/android-l-tools-sml.png)](lollipop-images/android-l-tools.png#lightbox)

   Установите также последние пакеты SDK для Android 5.0 (уровень API 21 и выше).

    [![Установка пакетов SDK Android 5.0 в Диспетчере SDK Android](lollipop-images/android-l-sdk-pkgs-sml.png)](lollipop-images/android-l-sdk-pkgs.png#lightbox)

   Дополнительные сведения об использовании Диспетчера SDK Android см. в разделе [Update the IDE and SDK Tools](https://developer.android.com/tools/help/sdk-manager.html) (Обновление инструментов интегрированной среды разработки и пакетов SDK).

4. Создайте проект Xamarin.Android. Если ранее вы не разрабатывали приложения Android с использованием Xamarin, ознакомьтесь с [этим руководством](~/android/get-started/hello-android/index.md), чтобы узнать о создании проектов Android. При создании проекта Android необходимо настроить параметры версии для Android 5.0.
   В Visual Studio для Mac выберите **Параметры проекта &gt; Сборка &gt; Общие** и в качестве **целевой платформы** выберите **Android 5.0 (Lollipop)** или более поздней версии.

    ![Настройка требуемой версии .NET Framework для Android 5.0 Lollipop](lollipop-images/target-framework.png)

   В разделе **Параметры проекта &gt; Сборка &gt; Приложение Android** в качестве минимальной и целевой версии Android выберите **Автоматически — использовать версию целевой платформы**.

    ![Выбор параметра автоматического выбора минимальной и целевой версий Android](lollipop-images/minimum-android-version.png)

5. Настройте эмулятор или устройство Android для тестирования приложения. Если вы используете эмулятор, ознакомьтесь с разделом [Настройка эмулятора Android](~/android/get-started/installation/android-emulator/index.md), чтобы узнать, как настроить Android Emulator для работы с Xamarin Studio или Visual Studio. Если вы используете устройство Android, ознакомьтесь с разделом [Set up the Android 11 SDK](https://developer.android.com/preview/setup-sdk.html) (Настройка пакета SDK для Android 11), чтобы узнать, как обновить устройство для использования Android 5.0. Сведения о настройке устройства Android для запуска и отладки приложений Xamarin.Android см. в статье [Настройка устройства для разработки](~/android/get-started/installation/set-up-device-for-development.md).

Примечание. Если вы обновляете существующий проект Android, нацеленный на Android L Preview, необходимо изменить значение параметров **Целевая платформа** и **Версия Android**, как описано выше.

## <a name="important-changes"></a>Важные изменения

Изменения в Android 5.0 могут повлиять на ранее опубликованные приложения Android. В частности, в Android 5.0 используется новая среда выполнения и значительно измененный формат уведомлений.

### <a name="android-runtime"></a>Среда выполнения Android

В Android 5.0 по умолчанию используется новая среда выполнения Android (ART) вместо Dalvik. В ART реализовано несколько важных новых функций.

- **AOT-компиляция** &ndash; AOT может повысить производительность приложений, выполняя компиляцию кода приложения перед первым запуском приложения. При установке приложения ART создает скомпилированный исполняемый файл приложения для целевого устройства.

- **Улучшенная сборка мусора (GC)** &ndash; улучшения сборки мусора в ART также могут повысить производительность приложений. Теперь для сборки мусора используется одна приостановка GC, а не две, а параллельные операции GC выполняются более своевременно.

- **Улучшенная отладка приложений** &ndash; ART предоставляет дополнительные диагностические сведения, помогающие анализировать исключения и отчеты о сбоях.

Существующие приложения должны работать без изменений в ART. Исключением могут быть приложения, использующие приемы, уникальные для предыдущей среды выполнения Dalvik. Они могут не работать в ART. Дополнительные сведения об этих изменениях см. в разделе [Verifying app behavior on the Android runtime (ART)](https://developer.android.com/guide/practices/verifying-apps-art.html) (Проверка поведения приложений в среде выполнения Android (ART)).

### <a name="notification-changes"></a>Изменения уведомлений

В Android 5.0 значительно изменились уведомления.

- **Звуки и вибрация обрабатываются по-другому** &ndash; звуки и вибрация для уведомлений теперь обрабатываются `Notification.Builder`, а не `Ringtone`, `MediaPlayer` и `Vibrator`.

- **Новая цветовая схема** &ndash; в соответствии с Material Theme, уведомления отображаются темным текстом на белом или очень светлом фоне. Кроме того, альфа-каналы в значках уведомлений могут быть изменены Android для соответствия системным цветовым схемам.

- **Уведомления на экране блокировки** &ndash; уведомления теперь могут отображаться на экране блокировки устройства.

- **Heads-up** &ndash; высокоприоритетные уведомления теперь отображаются в маленьком всплывающем окне (HUD-уведомлении), когда устройство разблокировано и экран включен.

В большинстве случаев перенос существующих функций управления уведомлениями в приложениях в Android 5.0 требует выполнения следующих действий.

1. Преобразуйте код, чтобы использовать `Notification.Builder` (или `NotificationsCompat.Builder`) для создания уведомлений.

2. Убедитесь, что существующие ресурсы уведомлений отображаются в новой цветовой схеме Material Theme.

3. Выберите параметры видимости уведомлений на экране блокировки. Если уведомление не является общим, какое содержимое должно отображаться на экране блокировки?

4. Настройте категорию уведомлений таким образом, чтобы они правильно обрабатывались в новом режиме Android 5.0 *Не беспокоить*.

Если в уведомлениях представлены элементы управления передачей, отображается состояние воспроизведения мультимедиа, используется `RemoteControlClient` или вызывается `ActivityManager.GetRecentTasks`, ознакомьтесь с разделом [Important Behavior Changes](https://developer.android.com/preview/api-overview.html#Behaviors) (Важные изменения в поведении), чтобы получить дополнительные сведения об изменении уведомлений в Android 5.0.

Дополнительные сведения о создании уведомлений см. в разделе [Локальные уведомления](~/android/app-fundamentals/notifications/local-notifications.md).

## <a name="material-theme"></a>Тема материала

Новая функция Material Theme для Android 5.0 значительно меняет оформление и поведение пользовательского интерфейса Android. Визуальные элементы теперь используют осязаемые поверхности, которые отображают отчетливую графику, шрифтовое оформление и яркие цвета типографских макетов. Примеры Material Theme показаны на снимках экрана ниже.

[![Снимки экрана: домашний экран, экран приложений и экран параметров с применением Material Theme](lollipop-images/android-5-gallery-labeled-sml.png)](lollipop-images/android-5-gallery-labeled.png#lightbox)

Android 5.0 приветствует домашним экраном, отображаемым слева. На центральном снимке экрана показан список приложений, а на снимке экрана справа — экран **Параметры**. Спецификация [Material Design](https://material.io/guidelines/material-design/introduction.html) Google описывает базовые правила проектирования, основанные на новых принципах Material Theme.

Material Theme включает в себя три встроенных варианта приложения, которые можно использовать: темная тема (по умолчанию) `Theme.Material`, тема `Theme.Material.Light` и тема `Theme.Material.Light.DarkActionBar`.

[![Снимки экрана с темами Dark, Light и DarkActionBar](lollipop-images/three-material-themes-sml.png)](lollipop-images/three-material-themes.png#lightbox)

Дополнительные сведения об использовании возможностей Material Theme в приложениях Xamarin.Android см. в разделе [Material Theme](~/android/user-interface/material-theme.md).

## <a name="animations"></a>Анимации

Android 5.0 предоставляет анимацию реакции на касание, перехода действий и изменения состояния просмотра, чтобы сделать интерфейсы приложений более интуитивно понятными для работы. Кроме того, приложения Android 5.0 могут использовать анимацию *эффекта раскрытия* для скрытия или отображения представлений. Вы можете использовать параметры *неравномерного движения*, чтобы настроить скорость отрисовки анимации.

### <a name="touch-feedback-animations"></a>Анимация реакции на касание

Анимация реакции на касание позволяет показать пользователям реакцию на касание представления. Например, теперь кнопки подергиваются рябью при касании &ndash; это анимация реакции на касание по умолчанию в Android 5.0. Анимация ряби реализуется новым классом `RippleDrawable`. Эффект ряби можно настроить так, чтобы он отображался в пределах представления или выходил за его границы. Например, на следующей последовательности снимков экрана показан эффект ряби на кнопке во время анимации касания.

![Покадровые снимки экрана для анимации ряби на кнопке](lollipop-images/touch-animation.png)

Начальное касание кнопки показано на первом изображении слева, а на остальных изображениях в последовательности (слева направо) показывается, как эффект ряби распространяется за края кнопки. Когда анимация ряди завершается, представление возвращается к исходному виду. Анимация ряби по умолчанию длится доли секунды, но ее продолжительность можно настроить, увеличив или сократив.

Дополнительные сведения об анимации реакции на касание в Android 5.0 см. в разделе [Customize Touch Feedback](https://developer.android.com/training/material/animations.html#Touch) (Настройка анимации реакции на касание).

### <a name="activity-transition-animations"></a>Анимация перехода действий

Анимация перехода действий дает пользователям ощущение визуальной непрерывности при переходе одного действия в другое. В приложениях можно указать три типа анимации перехода.

- **Начальный переход** &ndash; используется, когда действие на сцене начинается.

- **Конечный переход** &ndash; используется, когда действие на сцене завершается.

- **Переход с общим элементом** &ndash; используется, когда представление, которое является общим для двух действий, изменяется при переходе ко второму действию.

Например, на следующей последовательности снимков экрана показан переход с общим элементом.

[![Покадровые снимки экрана анимации перехода с общим элементом](lollipop-images/activity-transition-sml.png)](lollipop-images/activity-transition.png#lightbox)

Общий элемент (фотография гусеницы) является одним из нескольких представлений в первом действии. Фотография увеличивается и становится единственным представлением во втором действии, когда первое действие переходит во второе.

#### <a name="enter-transition-animation-types"></a>Типы анимации начального перехода

В Android 5.0 доступны три типа анимации начального перехода.

- **Анимация разворачивания** &ndash; увеличивает представление из центра сцены.

- **Анимация сдвига** &ndash; сдвигает представление к одному из краев сцены.

- **Анимация наплыва** &ndash; плавное появление представления на сцене.

#### <a name="exit-transition-animation-types"></a>Типы анимации конечного перехода

В Android 5.0 доступны три типа анимации конечного перехода.

- **Анимация разворачивания** &ndash; уменьшает представление в центре сцены.

- **Анимация сдвига** &ndash; сдвигает представление из одного из краев сцены.

- **Анимация исчезания** &ndash; плавное исчезание представления на сцене.

#### <a name="shared-element-transition-animation-types"></a>Типы анимации перехода с общим элементом

Переходы с общим элементом поддерживают несколько типов анимации, в том числе следующие:

- изменение макета или обрезка границ представления;

- изменение масштаба и вращение представления;

- изменение размера и типа масштабирования представления.

Дополнительные сведения об анимации переходов действий в Android 5.0 см. в разделе [Customize Activity Transitions](https://developer.android.com/training/material/animations.html#Transitions) (Настройка переходов действий).

### <a name="view-state-transition-animations"></a>Анимация изменения состояния просмотра

Android 5.0 делает возможным анимацию изменения состояния просмотра. Можно анимировать изменение состояния просмотра, используя один из следующих методов.

- Создайте прорисовываемые ресурсы, чтобы анимировать изменения состояния, связанные с конкретным представлением. Новый класс `AnimatedStateListDrawable` позволяет создавать прорисовываемые ресурсы, которые отображают анимацию изменения состояния просмотра.

- Определите функции анимации при изменении состояния просмотра. Новый класс `StateListAnimator` позволяет определить аниматор, который выполняется при изменении состояния просмотра.

Дополнительные сведения об анимации изменения состояния просмотра в Android 5.0 см. в разделе [Animate View State Changes](https://developer.android.com/training/material/animations.html#ViewState) (Анимация изменения состояния просмотра).

### <a name="reveal-effect"></a>Эффект раскрытия

*Эффект раскрытия* — это круг обрезки, который изменяет радиус для отображения или скрытия представления. Вы можете управлять этим эффектом, установив начальный и конечный радиусы обрезки. На следующей последовательности снимков экрана показана анимация эффекта раскрытия от центра экрана.

[![Покадровые снимки экрана анимации раскрытия](lollipop-images/reveal-center-sml.png)](lollipop-images/reveal-center.png#lightbox)

На следующей последовательности показана анимация эффекта раскрытия, которая начинается в левом нижнем углу экрана.

[![Покадровые снимки экрана анимации обрезки](lollipop-images/reveal-left-sml.png)](lollipop-images/reveal-left.png#lightbox)

Анимацию раскрытия можно выполнить наоборот. Это значит, что круг обрезки можно сжать, чтобы скрыть представление, а не увеличить, чтобы его отобразить.

Дополнительные сведения об эффекте раскрытия в Android 5.0 см. в разделе [Use the Reveal Effect](https://developer.android.com/training/material/animations.html#Reveal) (Использование эффекта раскрытия).

### <a name="curved-motion"></a>Неравномерное движение

Помимо описанных выше функций анимации, Android 5.0 также предоставляет новые интерфейсы API, позволяющие задавать время и кривые движения для анимации. Android 5.0 использует эти кривые для интерполяции времени и пространственного перемещения во время анимации. В Android 5.0 определены три кривые.

- **Fast\_out\_linear\_in** &ndash; быстрое ускорение и продолжение ускорения анимации с ускорением до конца.

- **Fast\_out\_slow\_in** &ndash; быстрое ускорение и медленное замедление к концу анимации.

- **Linear\_out\_slow\_in** &ndash; начало анимации на пиковой скорости и медленное замедление до самого конца.

Вы можете использовать новый класс `PathInterpolator`, чтобы задать интерполяцию движения. `PathInterpolator` — это интерполятор, который проходит траектории анимации в соответствии с заданными контрольными точками и кривыми движения. Дополнительные сведения об указании параметров неравномерного движения в Android 5.0 см. в разделе [Use Curved Motion](https://developer.android.com/training/material/animations.html#CurvedMotion) (Использование неравномерного движения).

## <a name="view-shadows--elevation"></a>Тени и возвышение представлений

В Android 5.0 можно указать *возвышение* представления над поверхностью, задав новое свойство `Z`. Чем больше значение `Z`, тем большую тень отбрасывает представление на фон, что визуально приподнимает представление над фоном. Начальное возвышение представления можно задать, настроив его атрибут `elevation` в макете.

В следующем примере показаны тени, отбрасываемые пустым элементом управления `TextView`, когда его атрибут возвышения имеет значение 2DP, 4dp и 6DP соответственно.

[![Снимки экрана с увеличивающейся тенью представления](lollipop-images/view-shadows-sml.png)](lollipop-images/view-shadows.png#lightbox)

Параметры теней представления могут быть статическими (как показано выше) или использоваться в анимации, чтобы представление временно приподнималось над фоном. Для анимации возвышения представления можно использовать класс `ViewPropertyAnimator`. Повышение представления определяется параметром макета `elevation` и свойством `translationZ`, которое можно задать с помощью вызова метода `ViewPropertyAnimator`.

Дополнительные сведения о тенях представлений в Android 5.0 см. в разделе [Defining Shadows and Clipping Views](https://developer.android.com/training/material/shadows-clipping.html) (Определение теней и обрезка представлений).

## <a name="color-features"></a>Функции управления цветом

Android 5.0 предоставляет две новые функции для управления цветом в приложениях.

- *Окраска прорисовываемых ресурсов* позволяет изменять цвета ресурсов изображения путем изменения атрибута макета.

- *Определение преобладающих цветов* позволяет динамически настраивать цветовую тему приложения в соответствии с цветовой палитрой отображаемого изображения.

### <a name="drawable-tinting"></a>Окраска прорисовываемых ресурсов

Макеты Android 5.0 распознают новый атрибут `tint`, который можно использовать для задания цвета прорисовываемых ресурсов без необходимости создания нескольких версий этих ресурсов для отображения в различном цвете. Чтобы использовать эту функцию, необходимо определить растровое изображение в качестве альфа-маски и указать атрибут `tint` для определения цвета ресурса. Это позволяет один раз создать ресурсы и раскрасить их в своем макете в соответствии с установленной темой.

В следующем примере один ресурс изображения &ndash; белый логотип с прозрачным фоном &ndash; используется для создания вариантов с разной окраской.

![Белый логотип Xamarin с прозрачным фоном](lollipop-images/xamarin-logo-white.png)

Этот логотип отображается на синем круглом фоне, как показано в следующих примерах. На изображении слева показано, как выглядит логотип без параметра `tint`. На центральном изображении для атрибута `tint` логотипа задан темно-серый цвет. На изображении справа для атрибута `tint` задан светло-серый цвет.

![Примеры приведенного выше логотипа с различными параметрами окраски](lollipop-images/drawable-tinting.png)

Дополнительные сведения об окраске в Android 5.0 см. в разделе [Drawable Tinting](https://developer.android.com/training/material/drawables.html#DrawableTint) (Окраска прорисовываемых ресурсов).

### <a name="prominent-color-extraction"></a>Определение преобладающих цветов

Новый класс `Palette` в Android 5.0 позволяет извлекать цвета из изображения, чтобы их можно было динамически применять к пользовательской цветовой палитре. Класс `Palette` извлекает шесть цветов из изображения и помечает их в соответствии с их относительными уровнями насыщенности и яркости:

- насыщенный;

- насыщенный темный;

- насыщенный светлый;

- приглушенный;

- приглушенный темный;

- приглушенный светлый.

Например, на следующих снимках экрана приложение для просмотра фотографий извлекает из изображения преобладающие цвета и использует их для адаптации цветовой схемы приложения в соответствии с изображением.

[![Снимки экрана определения зеленого, розового и синего цветов для темы](lollipop-images/prominent-color-extraction-sml.png)](lollipop-images/prominent-color-extraction.png#lightbox)

На приведенных выше снимках экрана для панели действий задается определенный "насыщенный светлый" цвет, а для фона — определенный "насыщенный темный" цвет. В каждом из приведенных выше примеров для демонстрации цветов палитры, извлеченных из изображения, показана строка небольших цветных квадратов.

Дополнительные сведения об определении цветов в Android 5.0 см. в разделе [Extracting Prominent Colors from an Image](https://developer.android.com/training/material/drawables.html#ColorExtract) (Определение преобладающих цветов на изображении).

## <a name="new-ui-widgets"></a>Новые мини-приложения пользовательского интерфейса

В Android 5.0 появились два новых мини-приложения пользовательского интерфейса.

- `RecyclerView` &ndash; группа представлений, в которой отображается список прокручиваемых элементов.

- `CardView` &ndash; базовый макет со скругленными углами.

Оба мини-приложения включают в себя поддержку функций темы Material Theme. Например, `RecyclerView` использует анимацию для добавления и удаления представлений, а `CardView` использует тени представлений для того, чтобы каждая карта отображалась над фоном. Примеры этих новых мини-приложений показаны на следующих снимках экрана.

[![Снимки экрана приложений с функциями RecyclerView](lollipop-images/recyclerview-cardview-sml.png)](lollipop-images/recyclerview-cardview.png#lightbox)

На снимке экрана слева показан пример использования `RecyclerView` в приложении электронной почты, а на снимке экрана справа — пример использования `CardView` в приложении для подачи заявок на командировку.

### <a name="recyclerview"></a>RecyclerView

`RecyclerView` аналогичен `ListView,`, но лучше подходит для больших наборов представлений или списков с динамически изменяемыми элементами. Как и для `ListView,`, следует указать адаптер для доступа к базовому набору данных. Однако в отличие от `ListView,`, для размещения элементов внутри `RecyclerView` используется *диспетчер макетов*. Диспетчер макетов также отвечает за перезапуск представления. Он управляет повторным использованием элементов представлений, которые больше не видны пользователю.

При использовании мини-приложения `RecyclerView` необходимо указать `LayoutManager` и адаптер. Как показано на этом рисунке, `LayoutManager` является посредником между адаптером и `RecyclerView`.

![Схема RecyclerView с поддержкой диспетчера макетов, адаптера и набора данных](lollipop-images/recyclerview-diagram.png)

На следующих снимках экрана показан `RecyclerView`, содержащий 100 элементов (каждый элемент состоит из `ImageView` и `TextView`).

[![Снимки экрана приложения RecyclerView с прокруткой изображений](lollipop-images/recyclerview-scroll-sml.png)](lollipop-images/recyclerview-scroll.png#lightbox)

`RecyclerView` легко обрабатывает этот большой набор данных &ndash; прокрутка от начала до конца списка в этом примере приложения занимает всего несколько секунд. `RecyclerView` также поддерживает анимацию. На самом деле анимация для добавления и удаления элементов включена по умолчанию. Когда элемент добавляется в `RecyclerView`, он плавно появляется, как показано на этой последовательности снимков экрана.

[![Покадровые снимки экрана плавного появления фотографии](lollipop-images/recyclerview-animation-sml.png)](lollipop-images/recyclerview-animation.png#lightbox)

Дополнительные сведения о `RecyclerView` см. в разделе [RecyclerView](~/android/user-interface/layouts/recycler-view/index.md).

### <a name="cardview"></a>CardView

`CardView` — это простое представление, имитирующее всплывающую карту со скругленными углами. Так как элемент `CardView` использует встроенные тени представления, он позволяет легко добавить визуальную глубину в приложение. На следующих снимках экрана показаны три примера, применяющие `CardView` для текста.

[![Примеры снимков экрана приложений с использованием RecyclerView с элементов CardView](lollipop-images/recyclerview-cardview-sml.png)](lollipop-images/recyclerview-cardview.png#lightbox)

Каждая из карт в приведенном выше примере содержит `TextView`. Цвет фона задается с помощью атрибута `cardBackgroundColor`.

Дополнительные сведения о `CardView` см. в разделе [CardView](~/android/user-interface/controls/card-view.md).

## <a name="enhanced-notifications"></a>Улучшенные уведомления

Система уведомлений в Android 5.0 была значительно изменена за счет нового визуального формата и новых функций. В Android 5.0 уведомления выглядят по-новому. Например, теперь уведомления в Android 5.0 используют темный текст на светлом фоне.

![Пример нераскрытого уведомления Android 5.0](lollipop-images/expanded-notification-contracted.png)

Когда в уведомлении отображается крупный значок (как показано в примере выше), Android 5.0 представляет маленький значок в виде индикатора событий над крупным значком.

В Android 5.0 уведомления также могут отображаться на экране блокировки устройства.
Например, ниже приведен пример снимка экрана блокировки с одним уведомлением.

[![Снимок экрана с уведомлением на экране блокировки](lollipop-images/lockscreen-notification-sml.png)](lollipop-images/lockscreen-notification.png#lightbox)

Пользователи могут дважды коснуться уведомления на экране блокировки, чтобы разблокировать устройство и перейти к приложению, из которого поступило это уведомление, или провести по экрану, чтобы закрыть уведомление. Для уведомлений добавлен параметр *видимости*, определяющий, сколько содержимого может отображаться на экране блокировки. Пользователи могут выбрать, разрешить ли отображение конфиденциального содержимого в уведомлениях на экране блокировки.

В Android 5.0 появился новый формат представления высокоприоритетных уведомлений, который называется *Heads-up*. HUD-уведомления разворачиваются из верхней части экрана на несколько секунд, а затем сворачиваются обратно в область уведомлений вверху. HUD-уведомления позволяют пользовательскому интерфейсу системы отобразить важную информацию для пользователя, не мешая выполнению текущего действия.
В следующем примере показано простое HUD-уведомление, отображаемое поверх приложения.

[![Пример HUD-уведомления](lollipop-images/heads-up-notification-sml.png)](lollipop-images/heads-up-notification.png#lightbox)

HUD-уведомления обычно используются для следующих событий:

- новое сообщение;

- входящий телефонный звонок;

- низкий заряд аккумулятора;

- сигнал будильника.

Android 5.0 отображает HUD-уведомление только в том случае, если для него задан высокий или максимальный приоритет.

В Android 5.0 можно предоставить метаданные уведомлений, чтобы упростить сортировку и отображение уведомлений Android. Android 5.0 организовывает уведомления в соответствии с приоритетом, видимостью и категорией.
Категории уведомлений используются для фильтрации уведомлений, которые могут быть показаны, когда устройство находится в режиме *Не беспокоить*.

Дополнительные сведения о создании и запуске уведомлений с помощью новых функций Android 5.0 см. в разделе [Локальные уведомления](~/android/app-fundamentals/notifications/local-notifications.md).

## <a name="new-apis"></a>Новые интерфейсы API

Помимо новых функций, описанных выше, в Android 5.0 добавлены новые интерфейсы API, расширяющие возможности существующих функций мультимедиа, хранилища и связи. Кроме того, Android 5.0 включает в себя новые API, обеспечивающие поддержку новой функции планировщика заданий.

### <a name="camera"></a>Камера

Android 5.0 предоставляет несколько новых интерфейсов API для улучшенных возможностей камеры. Новое пространство имен `Android.Hardware.Camera2` включает в себя функции для доступа к отдельным устройствам камеры, подключенным к устройству Android. Кроме того, `Android.Hardware.Camera2` моделирует каждое устройство камеры как конвейер: он принимает запрос на запись, записывает изображение, а затем выводит результат. Такой подход позволяет приложениям поставить в очередь несколько запросов на запись, отправленных на устройство камеры.

Для реализации этих возможностей служба приведенные ниже API.

- `CameraManager.GetCameraIdList` &ndash; позволяет программно получить доступ к камере. Для подключения к определенному устройству камеры используется `CameraManager.OpenCamera`.

- `CameraCaptureSession` &ndash; позволяет осуществить запись или потоковую передачу изображений с устройства камеры. Для управления новыми событиями записи изображения следует реализовать интерфейс `CameraCaptureSession.CaptureListener`.

- `CaptureRequest` &ndash; определяет параметры записи.

- `CaptureResult` &ndash; предоставляет результаты операции записи изображения.

Дополнительные сведения о новых API камеры в Android 5.0 см. в разделе [Media](https://developer.android.com/about/versions/android-5.0.html#Media) (Мультимедиа).

### <a name="audio-playback"></a>Воспроизведение звука

В Android 5.0 обновлен класс `AudioTrack` для улучшения воспроизведения звука.

- `ENCODING_PCM_FLOAT` &ndash; настраивает `AudioTrack` для приема звуковых данных в формате с плавающей запятой для улучшения динамического диапазона, повышения запаса по динамическому диапазону и повышения качества (благодаря увеличению точности). Кроме того, формат с плавающей запятой помогает избежать обрезки звука.

- `ByteBuffer` &ndash; теперь звуковые данные можно передавать в `AudioTrack` в виде массива байтов.

- `WRITE_NON_BLOCKING` &ndash; этот параметр упрощает буферизацию и многопоточную обработку для некоторых приложений.

Дополнительные сведения об улучшениях `AudioTrack` в Android 5.0 см. в разделе [Media](https://developer.android.com/about/versions/android-5.0.html#Media) (Мультимедиа).

### <a name="media-playback-control"></a>Управление воспроизведением мультимедиа

В Android 5.0 появился новый класс `Android.Media.MediaController`, который заменяет `RemoteControlClient`. `Android.Media.MediaController` предоставляет упрощенные API управления передачей и обеспечивает потокобезопасное управление воспроизведением вне контекста пользовательского интерфейса. Приведенные ниже новые интерфейсы API отвечают за управление передачей.

- `Android.Media.Session.MediaSession` &ndash; сеанс управления мультимедиа, который обрабатывает несколько контроллеров. Чтобы запросить маркер, используемый приложением для взаимодействия с сеансом, необходимо вызвать `MediaSession.GetSessionToken`.

- `MediaController.TransportControls` &ndash; обрабатывает команды передачи, такие как **Play**, **Stop** и **Skip**.

Кроме того, можно использовать новый класс `Android.App.Notification.MediaStyle`, чтобы связать сеанс мультимедиа с содержимым расширенного уведомления (например, для получения и отображения обложки альбома).

Дополнительные сведения о новых функциях управления воспроизведением мультимедиа в Android 5.0 см. в разделе [Media](https://developer.android.com/about/versions/android-5.0.html#Media) (Мультимедиа).

### <a name="storage"></a>Хранилище

В Android 5.0 обновлена платформа доступа к хранилищу, чтобы упростить работу приложений с каталогами и документами.

- Чтобы выбрать поддерево каталога, можно создать и отправить намерение `Android.Intent.Action.OPEN_DOCUMENT_TREE`. Это намерение укажет системе отобразить все экземпляры поставщиков, поддерживающих выбор поддерева. Затем пользователь может найти и выбрать каталог.

- Для создания новых документов и каталогов и управления ими в любом месте поддерева используются новые методы `DocumentsContract` — `CreateDocument`, `RenameDocument` и `DeleteDocument`.

- Чтобы получить пути к каталогам мультимедиа на всех общих устройствах хранения, следует вызвать новый метод `Android.Content.Context.GetExternalMediaDirs`.

Дополнительные сведения о новых API хранилища в Android 5.0 см. в разделе [Storage](https://developer.android.com/preview/api-overview.html#Storage) (Хранилище).

### <a name="wireless--connectivity"></a>Беспроводная связь и сетевые подключения

В Android 5.0 добавлены перечисленные ниже улучшения API для беспроводной связи и сетевых подключений.

- Новые *многосетевые* API, позволяющие приложениям находить и выбирать сети с определенными возможностями перед подключением.

- Функция трансляции Bluetooth, позволяющая устройству Android 5.0 выступать в роли периферийного устройства Bluetooth с низким энергопотреблением.

- Улучшения NFC, упрощающие использование функций связи ближнего действия для обмена данными с другими устройствами.

Дополнительные сведения о новых интерфейсах API для беспроводной связи и сетевых подключений в Android 5.0 см. в разделе [Wireless and Connectivity](https://developer.android.com/preview/api-overview.html#Wireless) (Беспроводная связь и сетевые подключения).

### <a name="job-scheduling"></a>Планирование заданий

В Android 5.0 появился новый API `JobScheduler`, который помогает пользователям снизить нагрузку на аккумулятор, позволяя планировать выполнение определенных задач только на периоды, когда устройство подключено к сети электропитания и заряжается. Эту функцию планировщика заданий можно также использовать, чтобы запланировать выполнение задачи, когда условия больше подходят для этой задачи. Например, скачивать большой файл целесообразнее, когда устройство подключено к сети Wi-Fi, а не к лимитной сети.

Дополнительные сведения о новых API планирования заданий в Android 5.0 см. в разделе [Scheduling Jobs](https://developer.android.com/preview/api-overview.html#JobScheduler) (Планирование заданий).

## <a name="summary"></a>Сводка

В этой статье приводятся общие сведения о важных новых возможностях Android 5.0 для разработчиков приложений Xamarin.Android:

- Material Theme;

- анимация;

- тени и возвышение представлений;

- функции управления цветом, такие как окраска прорисовываемых ресурсов и определение преобладающих цветов;

- новые мини-приложения `RecyclerView` и `CardView`;

- усовершенствования уведомлений;

- новые интерфейсы API для камеры, воспроизведения звука, управления мультимедиа, хранилища, беспроводной связи, сетевых подключений и планирования заданий.

Если вы не знакомы с разработкой для Xamarin.Android, прочитайте раздел [Настройка и установка](~/android/get-started/installation/index.md), чтобы приступить к работе с Xamarin.Android.
[Привет, Android](~/android/get-started/hello-android/index.md) — это отличное введение в процесс создания проектов Android.

## <a name="related-links"></a>Связанные ссылки

- [Android L Developer Preview](https://developer.android.com/preview/index.html)
- [Скачивание пакета SDK для Android](https://developer.android.com/sdk/index.html#Other)
- [Material Design](https://developer.android.com/preview/material/index.html)
