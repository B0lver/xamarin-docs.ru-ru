---
title: Связывание приложения в Android
description: В этом руководстве будут рассматриваться как Android 6.0 поддерживает приложения связывание, это метод, который позволяет мобильным приложениям реагировать на URL-адреса на веб-сайтах. Рассмотрим, какие компоновка приложения, как реализовать приложение связывания в приложении Android 6.0 и способы настройки веб-сайт для предоставления разрешений в мобильное приложение для домена.
ms.prod: xamarin
ms.assetid: 48174E39-19FD-43BC-B54C-9AF11D4B1F91
ms.technology: xamarin-android
author: conceptdev
ms.author: crdun
ms.date: 02/16/2018
ms.openlocfilehash: dd4ba236df8e5993c7f7ed86393eb66ce01db595
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60956163"
---
# <a name="app-linking-in-android"></a>Связывание приложения в Android

_В этом руководстве будут рассматриваться как Android 6.0 поддерживает приложения связывание, это метод, который позволяет мобильным приложениям реагировать на URL-адреса на веб-сайтах. Рассмотрим, какие компоновка приложения, как реализовать приложение связывания в приложении Android 6.0 и способы настройки веб-сайт для предоставления разрешений в мобильное приложение для домена._

## <a name="app-linking-overview"></a>Общие сведения о связывании приложения

Мобильные приложения больше не live изолированы &ndash; во многих случаях они важных компонентов сотрудников, а также их веб-сайта. Желательно для предприятий, легко подключать их присутствие в Интернете и мобильных приложений, со ссылками на веб-сайте запуск мобильных приложений и отображение соответствующего содержимого в мобильном приложении. *Связывание приложения* (называемый также *связывание глубокого*) — один метод, который позволяет мобильному устройству для реагировать на URI и запуск мобильного приложения, соответствующий этому URI-коду.

Android обрабатывает связывание приложений через *система намерений* &ndash; при нажатии на ссылку в браузере мобильного устройства, мобильных браузер отправляет объект intent, которые будут делегировать зарегистрированного приложения Android. Например щелкнув ссылку на приготовление веб-сайте откройте мобильное приложение, которое связано с этого веб-сайта и отображения определенного набора для пользователя. При наличии более чем одним приложением, зарегистрированном для обработки этого намерения, а затем Android будет вызывать так называемое *диалоговое окно устранения неоднозначности* , попросит пользователя какое приложение, чтобы выбрать приложение, которая должна обрабатывать намерения, для Пример:

![Пример снимка экрана диалоговое окно устранения неоднозначности](app-linking-images/01-disambiguation-dialog.png)

Android 6.0 позволяет с помощью обработки автоматическую ссылку. Возможно, для Android автоматически зарегистрировать приложение в качестве обработчика по умолчанию для URI &ndash; приложение автоматически запустить и перейти непосредственно на соответствующие действия. Как Android 6.0 определяет для обработки щелчка URI зависит от следующих критериев:

1. **Существующее приложение уже связана с URI** &ndash; пользователя могут быть уже связаны существующее приложение с URI. В этом случае Android будут продолжать использовать в дальнейшем.
2. **Нет существующего приложения связывается с URI, но установки вспомогательные приложения** &ndash; в этом случае пользователь не указал существующее приложение, поэтому Android будет использовать установленного вспомогательные приложения для обработки запроса.
3. **Нет существующего приложения связана с URI, но во многих приложениях, поддерживающих устанавливаются** &ndash; существует несколько приложений, которые поддерживают URI, отображается диалоговое окно устранения неоднозначности, и пользователь должен выбрать, какие приложения будут Обработка URI.

Если у пользователя нет приложения, установленные, которые поддерживают URI, а впоследствии установлено одно, затем Android установит это приложение как обработчик по умолчанию для URI после проверки связи с веб-сайта, которая связана с URI.

В этом руководстве будут рассмотрены способы настройки приложения Android 6.0 и как создать и опубликовать файл цифровых активов ссылки, чтобы обеспечить поддержку компоновки приложения в Android 6.0.

## <a name="requirements"></a>Требования

С этим руководством требуется Xamarin.Android 6.1 и приложение, предназначенное Android 6.0 (уровень API 23) или более поздней версии.

Связывание приложения в более ранних версиях Android с помощью [пакет NuGet заклепок](https://www.nuget.org/packages/Rivets/) в магазине компонентов Xamarin. Пакет крепления несовместим при связывании приложения в Android 6.0; он не поддерживает связывание приложения Android 6.0.

## <a name="configuring-app-linking-in-android-60"></a>Настройка связывания приложения в Android 6.0

Настройка связей приложения в Android 6.0 состоит из двух основных этапов:

1. **Добавление одного или нескольких намерение фильтров для URI веб сайта** &ndash; фильтры намерений руководство по Android, в том, как обрабатывать щелчок URL-адрес в браузере мобильного устройства.
2. **Публикация *цифровых активов ссылки JSON* файл на веб-сайт** &ndash; это файл, который передается на веб-сайт и используется системой Android для проверки связи между мобильного приложения и веб-сайта. Без этого Android не смогут установить его как дескриптор по умолчанию для URI; пользователь должен сделать это вручную.

<a name="configure-intent-filter" />

### <a name="configuring-the-intent-filter"></a>Настройка условий фильтра

Бывает необходимо настроить фильтр намерений, связанной с действием в приложении Android URI (или возможные набор кодов URI) веб-сайт. В Xamarin.Android, эта связь устанавливается с Декорирование действие, которое [IntentFilterAttribute](https://developer.xamarin.com/api/type/Android.App.IntentFilterAttribute/). Фильтр намерений необходимо объявить следующие сведения:

* **`Intent.ActionView`** &ndash; Регистрирует фильтр намерений отвечать на запросы для просмотра сведений
* **`Categories`** &ndash;  Фильтр намерений необходимо зарегистрировать обе **[Intent.CategoryBrowsable](https://developer.xamarin.com/api/field/Android.Content.Intent.CategoryBrowsable/)** и **[Intent.CategoryDefault](https://developer.xamarin.com/api/field/Android.Content.Intent.CategoryDefault/)** чтобы иметь возможность правильно Обработка веб-узла URI.
* **`DataScheme`** &ndash; Необходимо объявить фильтр намерений `http` и/или `https`. Это единственные допустимые схемы.
* **`DataHost`** &ndash; Это домен, в которой коды URI будет получен из.
* **`DataPathPrefix`** &ndash; Это дополнительный путь к ресурсам веб-сайта.
* **`AutoVerify`** &ndash; `autoVerify` Атрибут сообщает Android, чтобы проверить связь между приложением и веб-сайта. Это более подробно ниже.

В следующем примере показано, как использовать [IntentFilterAttribute](https://developer.xamarin.com/api/type/Android.App.IntentFilterAttribute/) для обработки ссылки из `https://www.recipe-app.com/recipes` и из `http://www.recipe-app.com/recipes`:

```csharp
[IntentFilter(new [] { Intent.ActionView },
              Categories = new[] { Intent.CategoryBrowsable, Intent.CategoryDefault },
              DataScheme = "http",
              DataHost = "recipe-app.com",
              DataPathPrefix = "/recipe",
              AutoVerify=true)]
public class RecipeActivity : Activity
{
    // Code for the activity omitted
}
```

Android будет проверять каждый узел, который определяется параметром фильтры намерений с цифровым файлом ресурсов веб-сайта, перед регистрацией приложения в качестве обработчика по умолчанию для URI. Все фильтры намерений должен пройти проверку подлинности перед Android можно установить приложение в качестве обработчика по умолчанию.

### <a name="creating-the-digital-assets-link-file"></a>Создание файла ссылки цифровых активов

Связывание приложения Android 6.0 требует, что Android проверьте связь между приложением и веб-сайта перед установкой приложения как обработчик по умолчанию для URI. Такая проверка будет выполняться при первой установке приложения. *Цифровых активов ссылки* файл является файлом JSON, размещенная в соответствующие webdomain(s).

> [!NOTE]
> `android:autoVerify` Атрибут следует задавать с помощью условий фильтра &ndash; в противном случае Android не будет выполнять проверку.

Файл помещается по мастеру домена в расположении **https://domain/.well-known/assetlinks.json**.

Цифровых активов файл содержит необходимые метаданные для Android проверить связь. **Assetlinks.json** файл имеет следующие пары "ключ значение":

* `namespace` &ndash; пространство имен приложения Android.
* `package_name` &ndash; Имя пакета приложения Android (объявленные в манифесте приложения).
* `sha256_cert_fingerprints` &ndash; отпечатки пальцев SHA256, подписанные приложения. Можно найти в руководстве [отображение MD5 и SHA1 сигнатур](~/android/deploy-test/signing/keystore-signature.md) Дополнительные сведения о том, как получить отпечаток SHA1 приложения.

Ниже приведен пример **assetlinks.json** с одним приложением в списке:

```json
[
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"com.example",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   }
]
```

Его можно зарегистрировать несколько отпечатков пальцев SHA256 для поддержки разных версий или сборок приложения. Дальнейшие действия **assetlinks.json** файл — это пример регистрации нескольких приложений:

```json
[
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"example.com.puppies.app",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   },
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"example.com.monkeys.app",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   }
]
```

[Веб-сайте Google цифровых активов ссылки](https://developers.google.com/digital-asset-links/tools/generator) имеет интерактивное средство, которое может помочь с созданием и тестирование файла цифровых активов.

### <a name="testing-app-links"></a>Тестирование приложения ссылки

После реализации приложения ссылки, необходимо тестировать различные фрагменты, чтобы убедиться, что они работают должным образом.

Это возможно, чтобы убедиться, что файл цифровых активов правильно отформатирован и размещенные с помощью цифровых активов ссылки API идентификаторов экземпляра Google, как показано в следующем примере:

```html
https://digitalassetlinks.googleapis.com/v1/statements:list?source.web.site=
  https://<WEB SITE ADDRESS>:&relation=delegate_permission/common.handle_all_urls
```

Существует два теста, которые могут быть выполнены, чтобы убедиться, что фильтры намерений настроены правильно и что приложение установлено как обработчик по умолчанию для URI:

1.  Цифровой файла ресурса-контейнера размещается должным образом, как описано выше. Первый тест передает объект intent, в которой должен выполнить перенаправление в мобильное приложение Android. Приложения Android необходимо запустить и отображает операции, зарегистрированный для URL-адрес. В командной строке введите:

    ```shell
    $ adb shell am start -a android.intent.action.VIEW \
        -c android.intent.category.BROWSABLE \
        -d "http://<domain1>/recipe/scalloped-potato"
    ```

2.  Отобразить существующую ссылку обработки политики для приложений, установленных на данном устройстве. Следующая команда будет дампа список политик ссылку для каждого пользователя на устройстве со следующими сведениями. В командной строке введите следующую команду:

    ```shell
    $ adb shell dumpsys package domain-preferred-apps
    ```

    * **`Package`** &ndash; Имя пакета приложения.
    * **`Domain`** &ndash; Домены (разделенных пробелами), веб-ссылок будет обрабатываться приложением
    * **`Status`** &ndash; Это текущее состояние обработки связи для приложения. Значение **всегда** означает, что приложение имеет `android:autoVerify=true` объявляются и успешно прошел проверку системы. Его следует шестнадцатеричное число, представляющее запись системы Android предпочтения.

    Пример:

    ```shell
    $ adb shell dumpsys package domain-preferred-apps

    App linkages for user 0:
    Package: com.android.vending
    Domains: play.google.com market.android.com
    Status: always : 200000002
    ```

## <a name="summary"></a>Сводка

В этом руководстве описывается связывание приложение работает в Android 6.0. Он затем рассмотрели, как настроить приложение Android 6.0 для поддержки и реагировать на них ссылки на приложение. Обсуждается проверка связывания приложения в приложении Android.


## <a name="related-links"></a>Связанные ссылки

- [Отображение MD5 и SHA1 сигнатур](~/android/deploy-test/signing/keystore-signature.md)
- [Действиями и объектами Intent](https://university.xamarin.com/classes#4)
- [AppLinks](http://applinks.org/)
- [Ссылки активы Google Digital](https://developers.google.com/digital-asset-links/)
- [Генератор списка инструкции и тест-инженер](https://developers.google.com/digital-asset-links/tools/generator)
