---
title: "Связывание приложения в Android"
description: "В этом руководстве будут рассматриваться как Android 6.0 поддерживает приложения связь, это способ, который позволяет мобильных приложений для ответа на URL-адреса на веб-сайтах. Рассмотрим, какие связывание приложения является, как реализовать приложение связывания в приложении Android 6.0 и настройка веб-сайта, чтобы предоставить разрешения на мобильное приложение для домена."
ms.topic: article
ms.prod: xamarin
ms.assetid: DDE54082-6E2B-9ED9-05FB-D9C1D1B1258E
ms.technology: xamarin-android
author: mgmclemore
ms.author: mamcle
ms.date: 02/16/2018
ms.openlocfilehash: 726890e48407dd26f52c5aeaecf4eab51dcc5182
ms.sourcegitcommit: 6cd40d190abe38edd50fc74331be15324a845a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2018
---
# <a name="app-linking-in-android"></a>Связывание приложения в Android

_В этом руководстве будут рассматриваться как Android 6.0 поддерживает приложения связь, это способ, который позволяет мобильных приложений для ответа на URL-адреса на веб-сайтах. Рассмотрим, какие связывание приложения является, как реализовать приложение связывания в приложении Android 6.0 и настройка веб-сайта, чтобы предоставить разрешения на мобильное приложение для домена._

## <a name="app-linking-overview"></a>Общие сведения о связывании приложения

Приложения для мобильных устройств больше не расположены в приемника команд &ndash; во многих случаях они являются важными компонентами сотрудников, вместе с их веб-сайта. Желательно организациям легко соединить их веб-приложения и мобильные приложения со ссылками на веб-сайте запуск приложений для мобильных устройств и отображение соответствующего содержимого в мобильном приложении. *Связывание приложения* (также называется *сложного связывания*) является одним из способов позволяет мобильного устройства отвечать на URI и запуска мобильного приложения, соответствующий этому URI-коду.

Android обрабатывает связывания приложения через *намерения системы* &ndash; при нажатии на ссылку в браузере мобильного мобильного браузер отправляет цели, которые будут делегировать зарегистрированного приложения Android. Например щелчок ссылки на приготовления веб-сайте будет откройте мобильного приложения, связанный с веб-сайта и отображения определенного набора для пользователя. При наличии более одного приложения, зарегистрированного для обработки этого намерения, а затем вызывает Android как *диалоговое окно устранения неоднозначности* , будет запрашивать пользователя какое приложение, чтобы выбрать приложение, которое следует обрабатывать цель, для Пример:

![Снимок экрана примера уточнение диалогового окна](app-linking-images/01-disambiguation-dialog.png)

Android 6.0 позволяет с помощью автоматического ссылку обработки. Возможно, для Android, приложение автоматически регистрируется как обработчик по умолчанию для URI &ndash; приложение будет автоматически запускаться и перейти непосредственно к соответствующие действия. Как Android 6.0 решает обрабатывать щелчок URI зависит от следующих критериев:

1. **Существующее приложение уже связан с URI** &ndash; пользователя могут быть уже связаны существующего приложения с помощью URI. В этом случае Android будут продолжать использовать это приложение.
2. **Нет существующего приложения связывается с URI, но вспомогательные приложение устанавливается** &ndash; в этом случае пользователь не указал существующего приложения, поэтому Android будет использовать установленного вспомогательные приложения для обработки запроса.
3. **Нет существующего приложения связывается с URI, но во многих приложениях, поддерживающих устанавливаются** &ndash; так как существует несколько приложений, которые поддерживают URI, отображается диалоговое окно устранения неоднозначности, и пользователь должен выбрать, какие приложения будут Обработка URI.

Если пользователь имеет не установлены приложения, которые поддерживают URI, а впоследствии установлено одно, затем Android установит это приложение как обработчик по умолчанию для URI после проверки связи с веб-сайта, которая связана с URI.

В этом руководстве обсудим, как настроить приложение Android 6.0 и как создать и опубликовать файл цифровых активов ссылки, чтобы поддерживать связывание приложения в Android 6.0.

## <a name="requirements"></a>Требования

В этом руководстве требует Xamarin.Android 6.1 и приложение, предназначенное для Android 6.0 (API уровня 23) или более поздней версии.

Связывание приложения можно реализовать в более ранних версиях Android с помощью [пакет NuGet заклепок](https://www.nuget.org/packages/Rivets/) магазине компонент Xamarin. Пакет крепления несовместим с компоновкой приложения в Android 6.0; он не поддерживает связывание приложения Android 6.0.

## <a name="configuring-app-linking-in-android-60"></a>Настройка связывания приложения в Android 6.0

Настройка приложения ссылки в Android 6.0 состоит из двух основных шагов:

1. **Добавление одного или нескольких намерение фильтры для веб-URI сайта** &ndash; намерения фильтры руководство по Android в том, как обрабатывать щелчок URL-адрес в браузере мобильных устройств.
2. **Публикация *цифровых активов ссылки JSON* файл на веб-сайт** &ndash; это файл, который загружается в веб-сайт и используется системой Android для проверки связи между мобильного приложения и домена веб-сайта. Без этого Android не удается установить приложение как дескриптор по умолчанию для URI; пользователь должен сделать это вручную.

<a name="configure-intent-filter" />

### <a name="configuring-the-intent-filter"></a>Настройка условий фильтра

Это необходимо для настройки намерения фильтр, который сопоставляет URI (или возможные набор кодов URI) с веб-сайта с действием из приложения. В Xamarin.Android, эта связь устанавливается с Декорирование действие с [IntentFilterAttribute](https://developer.xamarin.com/api/type/Android.App.IntentFilterAttribute/). Блокировка с намерением фильтра необходимо объявить следующие сведения:

* **`Intent.ActionView`** &ndash; Регистрирует намерения фильтр, чтобы отвечать на запросы для просмотра сведений
* **`Categories`** &ndash;  Блокировка с намерением фильтра необходимо зарегистрировать обе  **[Intent.CategoryBrowsable](https://developer.xamarin.com/api/field/Android.Content.Intent.CategoryBrowsable/)**  и  **[Intent.CategoryDefault](https://developer.xamarin.com/api/field/Android.Content.Intent.CategoryDefault/)**  возможность правильно обрабатывать URI веб-сайте.
* **`DataScheme`** &ndash; Блокировка с намерением фильтра необходимо объявить `http` и/или `https`. Это единственные допустимые схемы.
* **`DataHost`** &ndash; Это домен, который будет инициироваться URL-адреса.
* **`DataPathPrefix`** &ndash; Это дополнительный путь к ресурсам веб-сайта.
* **`AutoVerify`** &ndash; `autoVerify` Атрибут сообщает Android, чтобы проверить связь между приложением и веб-сайта. Это будет будет описано ниже.

В следующем примере показано, как использовать [IntentFilterAttribute](https://developer.xamarin.com/api/type/Android.App.IntentFilterAttribute/) для обработки ссылки из `https://www.recipe-app.com/recipes` и из `http://www.recipe-app.com/recipes`:

```csharp
[IntentFilter(new [] { Intent.ActionView },
              Categories = new[] { Intent.CategoryBrowsable, Intent.CategoryDefault },
              DataScheme = "http",
              DataHost = "recipe-app.com",
              DataPathPrefix = "/recipe"),
              AutoVerify=true]
public class RecipeActivity : Activity
{
    // Code for the activity omitted
}
```

Android проверит каждого узла, заданного с намерением фильтров для цифровой файл ресурсов на веб-сайт до регистрации приложения в качестве обработчика по умолчанию для URI. Блокировка с намерением фильтры должны пройти проверку перед Android можно установить приложения в качестве обработчика по умолчанию.

### <a name="creating-the-digital-assets-link-file"></a>Создание файла ссылки цифровых активов

Связывание приложения Android 6.0 требует, что Android проверьте связь между приложением и веб-сайт, прежде чем устанавливать приложение как обработчик по умолчанию для URI. Эта проверка будет выполняться после установки приложения. *Цифровых активов ссылки* файл является файлом JSON, размещенная в соответствующей webdomain(s).

> [!NOTE]
> **Примечание:** `android:autoVerify` атрибут должен быть задан с намерением фильтра &ndash; в противном случае Android не будет выполнять проверку.

Файл расположен по мастеру домена в расположении **https://domain/.well-known/assetlinks.json**.

Файл цифровых активов содержит необходимые метаданные для Android проверить связь. **Assetlinks.json** файл имеет следующие пары ключ значение:

* `namespace` &ndash; пространство имен приложения Android.
* `package_name` &ndash; Имя пакета приложения Android (объявлено в манифесте приложения).
* `sha256_cert_fingerprints` &ndash; отпечатки пальцев SHA256 знаком приложения. Можно найти в руководстве [поиск MD5 или SHA1 подписи в хранилище ключей](~/android/deploy-test/signing/keystore-signature.md) Дополнительные сведения о том, как получить отпечаток SHA1 приложения.

Ниже приведен пример **assetlinks.json** с одного приложения в списке:

```json
[
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"com.example",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   }
]
```

Его можно зарегистрировать несколько отпечатков пальцев SHA256 для поддержки разных версий или построений приложения. Дальнейшие действия **assetlinks.json** файла является примером регистрации нескольких приложений:

```json
[
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"example.com.puppies.app",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   },
   {
      "relation":[
         "delegate_permission/common.handle_all_urls"
      ],
      "target":{
         "namespace":"android_app",
         "package_name":"example.com.monkeys.app",
         "sha256_cert_fingerprints":[
            "14:6D:E9:83:C5:73:06:50:D8:EE:B9:95:2F:34:FC:64:16:A0:83:42:E6:1D:BE:A8:8A:04:96:B2:3F:CF:44:E5"
         ]
      }
   }
]
```

[Веб-сайте Google цифровых активов ссылки](https://developers.google.com/digital-asset-links/tools/generator) имеет интерактивное средство, которое может помочь с создания и тестирования файлов цифровых активов.

### <a name="testing-app-links"></a>Тестирование приложения ссылки

После реализации приложения ссылки, чтобы убедиться в их работе необходимо протестировать различные фрагменты.

Можно подтвердить, что файл цифровых активов правильно отформатирован и размещенных с помощью Google цифровых активов ссылки API, как показано в следующем примере:

```html
https://digitalassetlinks.googleapis.com/v1/statements:list?source.web.site=
  https://<WEB SITE ADDRESS>:&relation=delegate_permission/common.handle_all_urls
```

Существует два теста, которые можно выполнить, чтобы убедиться, что намерением фильтры настроены правильно и что приложение установлено как обработчик по умолчанию для URI:

1.  Цифровой файл актива размещается должным образом, как описано выше. Первый тест отправляет цели, которой следует перенаправить Android для мобильного приложения. Приложение Android должен запустить и отобразить зарегистрированные URL-адрес действия. В командной строке введите:

    ```shell
    $ adb shell am start -a android.intent.action.VIEW \
        -c android.intent.category.BROWSABLE \
        -d "http://<domain1>/recipe/scalloped-potato"
    ```

2.  Отображение существующую ссылку обработки политики для приложений, установленных на данном устройстве. Следующая команда будет дампа список политик связи для каждого пользователя на устройство со следующими сведениями. В командной строке введите следующую команду:

    ```shell
    $ adb shell dumpsys package domain-preferred-apps
    ```

    * **`Package`** &ndash; Имя пакета приложения.
    * **`Domain`** &ndash; Домены (разделенные пробелами) которого веб-ссылок будет обрабатываться приложением
    * **`Status`** &ndash; Это текущее состояние обработки связи для приложения. Значение **всегда** означает, что приложение имеет `android:autoVerify=true` объявлено и прошла проверку системы. За ним следует шестнадцатеричное число, представляющее записи системы Android приоритета.

    Пример:

    ```shell
    $ adb shell dumpsys package domain-preferred-apps

    App linkages for user 0:
    Package: com.android.vending
    Domains: play.google.com market.android.com
    Status: always : 200000002
    ```

## <a name="summary"></a>Сводка

В этом руководстве рассматривается связывание приложение работает в Android 6.0. Затем он рассматривается настройка приложения для поддержки и отвечать на ссылки на приложения Android 6.0. Он также описаны способы проверки связывания приложения в приложение.


## <a name="related-links"></a>Связанные ссылки

- [Поиск MD5 или SHA1 подписи в хранилище ключей](~/android/deploy-test/signing/keystore-signature.md)
- [Действия и целей](https://university.xamarin.com/classes#4)
- [AppLinks](http://applinks.org/)
- [Цифровая подпись Google активы ссылки](https://developers.google.com/digital-asset-links/)
- [Генератор списка инструкции и тест-инженер](https://developers.google.com/digital-asset-links/tools/generator)
