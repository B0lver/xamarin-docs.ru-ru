---
title: Функции Marshmallow
description: Эта статья поможет вам приступить к работе с с помощью Xamarin. Android для разработки приложений для Android 6,0 Marshmallow.
ms.prod: xamarin
ms.assetid: E4D6F183-98D2-460A-9D65-937639A899E0
ms.technology: xamarin-android
author: davidortinau
ms.author: daortin
ms.date: 03/01/2018
ms.openlocfilehash: fb1ba92be9527d490b3d34bd4c0e454b0a750837
ms.sourcegitcommit: 2fbe4932a319af4ebc829f65eb1fb1816ba305d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73019991"
---
# <a name="marshmallow-features"></a>Функции Marshmallow

_Эта статья поможет вам приступить к работе с с помощью Xamarin. Android для разработки приложений для Android 6,0 Marshmallow._

В этой статье представлен обзор новых возможностей Android 6,0 Marshmallow, объясняется, как подготовить Xamarin. Android для Android Marshmallow Development и ссылки на примеры приложений, демонстрирующие использование новых Android Marshmallow функции в приложениях Xamarin. Android. 

## <a name="overview"></a>Обзор

[Android 6,0 Marshmallow](https://developer.android.com/about/versions/marshmallow/index.html)— это следующий основной выпуск Android после пакета интерфейса для Android.
Xamarin. Android поддерживает Android Marshmallow и включает в себя:

- **Привязки API 23/Android 6,0** &ndash; Android 6,0 добавляет множество новых API для новых функций, описанных ниже. Эти API-интерфейсы доступны для приложений Xamarin. Android при использовании API уровня 23. Дополнительные сведения об API-интерфейсах Android 6,0 см. в разделе [API-интерфейсы android 6,0](https://developer.android.com/preview/api-overview.html). 

[![Hero изображения планшетов и телефонов с Marshmallow](marshmallow-images/android-m-hero-sml.png)](marshmallow-images/android-m-hero.png#lightbox)

Хотя выпуск Marshmallow в основном сосредоточен на "польском и качественном", он также предоставляет множество новых функций, представляющих интерес для разработчиков Xamarin. Android. Эти функции включают перечисленные ниже. 

- **Разрешения среды выполнения** &ndash; этой возможности позволяют пользователям утверждать разрешения безопасности в зависимости от конкретного варианта во время выполнения. 

- **Улучшения проверки Подлинности** &ndash; начиная с Android Marshmallow, приложения теперь могут использовать датчики отпечатков пальцев для проверки подлинности пользователей, а новая функция *подтверждения учетных данных* снижает потребность в вводе паролей. 

- **Связывание приложений** &ndash; эта функция позволяет устранить необходимость всплывающего окна **выбора приложения** путем автоматического связывания приложений с веб-доменами. 

- **Прямой общий доступ** &ndash; можно определить *прямые целевые объекты общего* доступа, которые упрощают и интуитивно понятны для пользователей. Эта функция позволяет пользователям обмениваться содержимым с другими приложениями. 

- **Голосовые взаимодействия** &ndash; этом новом API позволяет создавать в приложении функции голосовых голосов. 

- **4-килобайтный режим просмотра** &ndash; в Android Marshmallow. приложение может запросить 4-килобайтное разрешение экрана для оборудования, которое его поддерживает. 

- **Новые функции аудио** &ndash; начиная с Marshmallow, Android теперь поддерживает протокол MIDI. Он также предоставляет новые классы для создания цифровых аудио-и воспроизводимых объектов и предлагает новые обработчики API для связывания аудио-и входных устройств. 

- **Новые функции видео** &ndash; Marshmallow предоставляет новый класс, который помогает приложениям визуализировать звуковые и видеопотоки в синхронизации. Этот класс также обеспечивает поддержку динамического воспроизведения. 

- **Android for** &ndash; Marshmallow включает расширенные элементы управления для корпоративных устройств с одним пользователем. Он поддерживает автоматическую установку и удаление приложений с помощью владельца устройства, автоматическое принятие обновлений системы, улучшенное управление сертификатами, отслеживание использования данных, Управление разрешениями и уведомления о состоянии работы. 

- **Библиотека поддержки конструирования материалов** &ndash; Новая *Библиотека поддержки проектирования* содержит компоненты и шаблоны проектирования, облегчающие создание внешнего вида и оформления материалов в приложении. 

Кроме того, многие основные обновления библиотеки Android были выпущены с Android M, и эти обновления предоставляют новые функции для Android M и более ранних версий Android.

Кроме того, многие основные обновления библиотеки Android были выпущены с Android Marshmallow, и эти обновления предоставляют новые функции для Android Marshmallow и более ранних версий Android. В этой статье объясняется, как приступить к созданию приложений с помощью Android Marshmallow и содержит общие сведения о новых функциях Android 6,0. 

## <a name="requirements"></a>Требования

Для использования новых функций Android Marshmallow в приложениях на основе Xamarin необходимо следующее: 

- **Xamarin. android** &ndash; Xamarin. Android 5.1.7.12 или более поздней версии должен быть установлен и настроен с помощью Visual Studio или Xamarin Studio.

- **Visual Studio для Mac** или **Visual Studio** &ndash; если вы используете Visual Studio для Mac, требуется версия 5.9.7.22 или более поздняя. Если вы используете Visual Studio, требуется версия 3.11.1537 или более поздней версии инструментов Xamarin для Visual Studio. 

- **Пакет SDK для Android** &ndash; пакет SDK для Android 6,0 (API 23) или более поздней версии необходимо установить с помощью диспетчера пакет SDK для Android.

- Для **Java Developer Kit** &ndash; Xamarin. Android требуется [JDK 1,8](https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html) или более поздняя версия при разработке для API уровня 24 или выше (JDK 1,8 также поддерживает уровни API раньше 24, включая Marshmallow). 64-разрядная версия JDK 1,8 необходима, если используются пользовательские элементы управления или средства просмотра форм.

Вы можете продолжать использовать [JDK 1,7](https://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html) при разработке специально для API уровня 23 или более ранней версии. 

## <a name="getting-started"></a>Начало работы

Чтобы приступить к работе с Android Marshmallow с Xamarin. Android, перед созданием проекта Marshmallow для Android необходимо загрузить и установить последние версии средств и пакетов SDK: 

1. Установите последние обновления Xamarin из **стабильного** канала. 

2. Установите пакеты и средства пакета SDK для Android 6,0 Marshmallow.

3. Создайте новый проект Xamarin. Android, предназначенный для Android 6,0 Marshmallow (API уровня 23). 

4. Настройте эмулятор или устройство для Android Marshmallow.

Каждое из этих действий описано в следующих разделах:

### <a name="install-xamarin-updates"></a>Установка обновлений Xamarin

Чтобы обновить Xamarin таким образом, чтобы он включал поддержку Android 6,0 Marshmallow, измените канал обновления на **стабильный** и установите все обновления. Дополнительные сведения об установке обновлений из канала обновлений см. в разделе [изменение канала обновлений](https://github.com/xamarin/recipes/tree/master/Recipes/cross-platform/ide/change_updates_channel). 

### <a name="install-the-android-60-sdk"></a>Установка пакета SDK для Android 6,0

Чтобы создать проект Xamarin. Android для Android Marshmallow, сначала необходимо использовать диспетчер пакет SDK для Android для установки пакета SDK для Android 6,0:

- Запустите диспетчер пакет SDK для Android (в Visual Studio для Mac используйте **инструменты > диспетчер пакетов SDK**; в Visual Studio используйте **средства > Android > пакет SDK для Android Manager**) и установите последнюю Android SDK Tools:

    [![выбор средств пакет SDK для Android в диспетчере пакет SDK для Android](marshmallow-images/mnc-preview-tools.png)](marshmallow-images/mnc-preview-tools.png#lightbox)

- Кроме того, установите новейшие пакеты SDK для **Android 6,0** :

    [![выборе пакетов SDK для Android 6,0 в диспетчере пакет SDK для Android](marshmallow-images/mnc-preview-packages.png)](marshmallow-images/mnc-preview-packages.png#lightbox)

Необходимо установить Android SDK Tools редакции 24.3.4 или более поздней версии.
Дополнительные сведения об использовании диспетчера пакет SDK для Android для установки пакета SDK для Android 6,0 см. в разделе [Диспетчер пакетов SDK](https://developer.android.com/tools/help/sdk-manager.html).

### <a name="start-a-xamarinandroid-project"></a>Запуск проекта Xamarin. Android

Создайте новый проект Xamarin. Android. Если вы не знакомы с разработкой Android с помощью Xamarin, ознакомьтесь со статьей [Hello, Android,](~/android/get-started/hello-android/index.md) чтобы узнать о создании проектов Android. 

При создании проекта Android необходимо настроить параметры версии для целевого устройства Android 6,0 MarshMallow. Чтобы указать проект для Marshmallow, необходимо настроить проект на **уровне API 23 (поддержка Xamarin. Android v 6.0)** . Дополнительные сведения о настройке уровней уровня API Android см. в разделе [Общие сведения об уровнях API Android](~/android/app-fundamentals/android-api-levels.md).

### <a name="configure-an-emulator-or-device"></a>Настройка эмулятора или устройства

Если вы используете эмулятор, запустите Android AVD Manager и создайте новое устройство, используя следующие параметры:

- Устройство: хранилища 5, 6 или 9.
- Цель: Android 6,0 — API уровня 23
- ABI: x86

Например, это виртуальное устройство настроено для эмуляции хранилища 5:

[![настройке AVD с помощью устройства хранилища 6,0, целевого сервера Android и Intel Atom (x86)](marshmallow-images/android-m-avd.png)](marshmallow-images/android-m-avd.png#lightbox)

При использовании физического устройства, например хранилища 5, 6 или 9, можно установить предварительный образ Android Marshmallow. Дополнительные сведения об обновлении устройства до Android Marshmallow см. в разделе [аппаратные образы системы](https://developer.android.com/preview/download.html#images).

## <a name="new-features"></a>Новые функции

Многие изменения, появившиеся в Android Marshmallow, сосредоточены на улучшении пользовательского интерфейса Android, увеличении производительности и исправлении ошибок. Однако в Marshmallow также появились некоторые обширные изменения в основ платформы Android. В следующих разделах описаны эти улучшения и приведены ссылки, которые помогут вам приступить к использованию новых функций Android Marshmallow в приложении. 

### <a name="runtime-permissions"></a>Разрешения среды выполнения

Система разрешений Android была значительно оптимизирована и упрощена с момента запуска интерфейса Android. В Android Marshmallow пользователи предоставляют разрешения для каждого случая в среде выполнения, а не во время установки. Для поддержки этой функции в Android Marshmallow и более поздних версиях вы разрабатываете приложение, чтобы запрашивать у пользователя разрешения во время выполнения (в контексте, где требуются разрешения). Это изменение позволяет пользователям быстрее начать работу с приложением, так как оно упрощает процесс установки и обновления приложения. 

Дополнительные сведения о реализации разрешений среды выполнения в приложениях Xamarin. Android см. [в разделе Запрос разрешений среды выполнения в Android Marshmallow](https://blog.xamarin.com/requesting-runtime-permissions-in-android-marshmallow/) .
Xamarin также предоставляет пример приложения, демонстрирующий работу разрешений среды выполнения в Android Marshmallow (и более поздних версиях): [рунтимепермиссионс](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-runtimepermissions).

В этом примере приложения демонстрируется следующее.

- Проверка и запрос разрешений во время выполнения.
- Как объявить разрешения для устройств Android M.

Чтобы использовать этот пример приложения, сделайте следующее:

1. Коснитесь кнопки **Камера** или **Контакты** , чтобы открыть диалоговое окно запроса разрешений.
2. Предоставьте разрешение на просмотр фрагментов камеры или контактов.

Дополнительные сведения о новых функциях разрешений среды выполнения в Android Marshmallow см. в разделе [Работа с разрешениями системы](https://developer.android.com/preview/features/runtime-permissions.html).

### <a name="authentication-enhancements"></a>Усовершенствования проверки подлинности

Android Marshmallow включает два улучшения проверки подлинности, которые помогают устранить необходимость в паролях:

- **Проверка подлинности отпечатков пальцев** &ndash; использует проверку отпечатков пальцев для проверки подлинности пользователей.

- **Подтверждение учетных данных** &ndash; проверяет подлинность пользователей в зависимости от того, как долго устройство было разблокировано.

Ссылки и примеры приложений, описанные далее, помогут вам ознакомиться с этими новыми функциями.

#### <a name="fingerprint-authentication"></a>Проверка подлинности по отпечаткам

На устройствах, поддерживающих проверку отпечатков пальцев, можно использовать новый класс `FingerPrintManager` для проверки подлинности пользователя.
Дополнительные сведения о функции проверки подлинности отпечатков пальцев в Android Marshmallow см. в разделе [Проверка подлинности отпечатков пальцев](https://developer.android.com/preview/api-overview.html#fingerprint-authentication).

Xamarin предоставляет пример приложения, демонстрирующий использование зарегистрированных отпечатков пальцев для проверки подлинности пользователя в приложении: [финжерпринтдиалог](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-fingerprintdialog).

Чтобы использовать этот пример приложения, сделайте следующее:

1. Коснитесь кнопки **приобрести** , чтобы открыть диалоговое окно проверки подлинности отпечатков пальцев.
2. Просмотрите зарегистрированный отпечаток пальца, чтобы выполнить аутентификацию.

Обратите внимание, что для этого примера приложения требуется устройство с модулем чтения отпечатков пальцев.
Это приложение не сохраняет отпечаток (или ваш пароль).

#### <a name="voice-interactions"></a>Голосовое взаимодействие

Новая функция взаимодействия с голосовыми сообщениями, появившаяся в Android Marshmallow, позволяет пользователям приложения использовать свои голоса для подтверждения действий и выбора из списка параметров. Дополнительные сведения о голосовом взаимодействии см. [в разделе Обзор API голосового взаимодействия](https://developers.google.com/voice-actions/interaction/). 

Дополнительные сведения (включая примеры кода) о реализации голосовых взаимодействий в приложениях Xamarin. Android см. [в статье Добавление диалога в приложение Android с помощью голосового взаимодействия](https://blog.xamarin.com/add-a-conversation-to-your-android-app-with-voice-interactions/) .
Доступен пример приложения, демонстрирующий использование API голосов в приложении Xamarin. Android: [голосовое взаимодействие](https://github.com/jamesmontemagno/MarshmallowSamples/tree/master/VoiceInteractions).

#### <a name="confirm-credential"></a>Подтверждение учетных данных

Используя новую функцию *подтверждения учетных данных* в Android Marshmallow, вы можете освобождать пользователей от необходимости запоминать и вводить пароли для конкретных приложений, проверяя их подлинность в зависимости от того, как долго устройство было разблокировано.
Для этого используется новый метод `SetUserAuthenticationValidityDurationSeconds` `KeyGenerator`. Используйте метод `CreateConfirmDeviceCredentialIntent` `KeyGuardManager`для повторной проверки подлинности пользователя в приложении. Дополнительные сведения об этой новой функции в Android Marshmallow см. в разделе [подтверждение учетных данных](https://developer.android.com/preview/api-overview.html#confirm-credential).

Xamarin предоставляет пример приложения, демонстрирующий использование учетных данных устройства (например, ПИН-кода, шаблона или пароля) в приложении: [конфирмкредентиал](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-confirmcredential)

Чтобы использовать этот пример приложения, сделайте следующее:

1. Настройте экран защищенной блокировки на устройстве (**secure > Security > скринлокк**).
2. Нажмите кнопку **приобрести** и подтвердите учетные данные для экрана защищенной блокировки.

### <a name="chrome-custom-tabs"></a>Пользовательские вкладки Chrome

Разработчики приложений предпочитают выбирать, когда пользователь касается URL-адреса: приложение может запустить браузер или использовать браузер в приложении на основе `WebView`. Оба варианта предоставляют проблемы &ndash; запуске браузера — это очень интенсивное переключение контекста, которое не настраивается, а `WebView`s не имеют общего состояния в браузере. Кроме того, использование `WebView`s может добавить дополнительные затраты на обслуживание. 

*Настраиваемые вкладки Chrome* позволяют легко и элегантной отображать веб-сайты с возможностями Chrome без необходимости оставлять пользователей в приложении. Эта функция предоставляет приложению больший контроль над веб-интерфейсом пользователя; Это делает переходы между собственным и веб-содержимым более плавным, не прибегая к `WebView`. Приложение также может повлиять на вид и оформление Chrome, настроив следующие действия. 

- Цвет панели инструментов

- Вход и выход из анимации

- Настраиваемые действия на панели инструментов Chrome и меню переполнения

- Предварительный запуск и предварительная загрузка содержимого Chrome (для ускорения загрузки)

Чтобы воспользоваться этой функцией в приложении Xamarin. Android, скачайте и установите [библиотеку пользовательских вкладок поддержки Android](https://www.nuget.org/packages/Xamarin.Android.Support.CustomTabs/).
Дополнительные сведения об этой функции см. в разделе [пользовательские вкладки Chrome](https://developer.chrome.com/multidevice/android/customtabs).

### <a name="material-design-support-library"></a>Библиотека поддержки дизайна материалов

В интерфейсе программирования Android появился [Дизайн материалов](https://www.google.com/design/spec/material-design/introduction.html) в качестве нового языка разработки для обновления интерфейса Android (см. [тему материалов](~/android/user-interface/material-theme.md) для получения сведений об использовании дизайна материалов в приложениях Xamarin. Android). В Android Marshmallow в Google появилась *Библиотека поддержки разработки Android* , которая упрощает разработчикам приложений внедрение внешнего вида и поведения дизайна материалов. Эта библиотека включает следующие компоненты:

- **Курдинаторлайаут** &ndash; новое мини-приложение `CoordinatorLayout` аналогично, но более мощным, чем `FrameLayout`. `CoordinatorLayout` можно использовать как контейнер для дочерних представлений или как макет верхнего уровня. он предоставляет атрибут `layout_anchor`, который можно использовать для привязки представлений относительно других представлений.

- **Свертывание панелей инструментов** &ndash; новой `CollapsingToolbarLayout` — это панель приложения, которая является оболочкой для `Toolbar`. (Обратите внимание, что *панель приложений* раньше называлась *панелью действий*.)

- **Плавающая кнопка действия** &ndash; круглую кнопку, которая обозначает основное действие в интерфейсе приложения.

- **Плавающие метки для редактирования текста** &ndash; используют новое мини-приложение `TextInputLayout` (которое заключает `EditText`) для отображения плавающей метки, когда подсказка скрыта, когда пользователь вводит текст.

- **Представление "Навигация** " &ndash; новом мини-приложении `NavigationView` помогает использовать область навигации так, чтобы пользователям было проще перемещаться.

- **Снаккбар** &ndash; новое мини-приложение `SnackBar` — это облегченный механизм обратной связи (аналогичный всплывающему), который отображает короткое сообщение в нижней части экрана, которое появляется над всеми остальными элементами на экране.

- **Вкладки материалов** &ndash; новое мини-приложение `TabLayout` предоставляет горизонтальный макет для отображения вкладок как способ реализации навигации верхнего уровня в приложении.

Чтобы воспользоваться [библиотекой поддержки разработки](https://developer.android.com/tools/support-library/features.html#design) в приложении Xamarin. Android, скачайте и установите пакет NuGet для [создания библиотеки поддержки Xamarin Xamarin](https://www.nuget.org/packages/Xamarin.Android.Support.Design/) .

Дополнительные сведения см. в статье [Проектирование привлекательных материалов с помощью библиотеки разработки поддержки Android](https://blog.xamarin.com/add-beautiful-material-design-with-the-android-support-design-library/) (включая примеры кода) об использовании библиотеки поддержки дизайна материалов в приложениях Xamarin. Android.
Xamarin предоставляет пример приложения, которое демонстрирует новую библиотеку разработки Android на Xamarin. Android &ndash; [чисескуаре](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android50-cheesesquare).
В этом образце демонстрируются следующие возможности библиотеки конструирования.

- Свертывание панели инструментов
- Кнопка "плавающее действие"
- Привязать к просмотру
- Представления navigationview
- снаккбар

Дополнительные сведения о библиотеке разработки см. в разделе [Библиотека поддержки разработки Android](https://android-developers.googleblog.com/2015/05/android-design-support-library.html) в блоге разработчика Android.

### <a name="additional-library-updates"></a>Дополнительные обновления библиотеки

Помимо Android Marshmallow, Google объявил о связанных обновлениях нескольких основных библиотек Android. Xamarin предоставляет поддержку Xamarin. Android для этих обновлений через несколько предварительных версий пакетов NuGet: 

- [Сервисы Google Play](https://www.nuget.org/packages?q=Xamarin+Google+Play+Services) &ndash; последняя версия сервисы Google Play включает функцию новых *приглашений в приложение* , которая позволяет пользователям совместно использовать свои приложения с друзьями. Дополнительные сведения об этой функции см. в разделе [расширение доступности приложения с помощью приглашений приложения Google](https://blog.xamarin.com/expand-your-apps-reach-with-googles-app-invites/). 

- [Библиотеки поддержки Android](https://www.nuget.org/packages?q=xamarin+support+library) &ndash; эти NuGet предлагают функции, доступные только для API-интерфейсов библиотеки, при этом обеспечивается обратная совместимость версий API-интерфейсов платформы Android. 

- [Библиотека носимого пользователем для Android](https://www.nuget.org/packages/Xamarin.Android.Wear) &ndash; этот NuGet содержит привязки сервисы Google Play. Последняя версия библиотеки носимого пользователем предоставляет новые возможности (в том числе упрощенную навигацию для пользовательских приложений) на платформу Android износа. 

## <a name="summary"></a>Сводка

В этой статье представлено использование Android Marshmallow и объясняется, как установить и настроить новейшие средства и пакеты для разработки Xamarin. Android на Marshmallow. В нем также предоставлен обзор наиболее интересных новых функций Android Marshmallow для разработки Xamarin. Android.

## <a name="related-links"></a>Связанные ссылки

- [Android 6,0 Marshmallow](https://developer.android.com/about/versions/marshmallow/index.html)
- [Получение пакет SDK для Android](https://developer.android.com/sdk/index.html#Other)
- [Обзор возможностей](https://developer.android.com/preview/api-overview.html)
- [Заметки о выпуске](https://github.com/xamarin/release-notes-archive/blob/master/release-notes/android/xamarin.android_5/xamarin.android_5.1.99/index.md)
- [Рунтимепермиссионс (пример)](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-runtimepermissions)
- [Конфирмкредентиал (пример)](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-confirmcredential)
- [Финжерпринтдиалог (пример)](https://docs.microsoft.com/samples/xamarin/monodroid-samples/android-m-fingerprintdialog)
