---
title: Принципы работы поставщиков содержимого
ms.prod: xamarin
ms.assetid: B9E2EF89-7EBE-45F5-1ED9-7D2C70BE792C
ms.technology: xamarin-android
author: davidortinau
ms.author: daortin
ms.date: 02/16/2018
ms.openlocfilehash: e61be6f0189eb825c15fd75764a16706e588ebc9
ms.sourcegitcommit: b0ea451e18504e6267b896732dd26df64ddfa843
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2020
ms.locfileid: "73020519"
---
# <a name="how-content-providers-work"></a>Принципы работы поставщиков содержимого

Существует два класса, участвующих во взаимодействии `ContentProvider`:

- **ContentProvider** &ndash; реализует API, который предоставляет набор данных стандартным способом. Основные методы — это Query (запрос), Insert (вставка), Update (обновление) and Delete (удаление).

- **ContentResolver** &ndash; статический прокси-сервер, который взаимодействует с `ContentProvider` для доступа к его данным из того же или из другого приложения.

Поставщик содержимого обычно использует базу данных SQLite, но API означает, что для использования кода потребителя не нужно ничего знать о базовом SQL. Запросы выполняются через универсальный код ресурса (URI), в котором для имен столбцов используются константы (чтобы уменьшить зависимости от базовой структуры данных), и для кода потребителя, по которому выполняется итерация, возвращается `ICursor`.

## <a name="consuming-a-contentprovider"></a>Использование ContentProvider

`ContentProviders` предоставляет свои функциональные возможности через URI, зарегистрированный в **AndroidManifest.xml** приложения, которые публикуют данные. Существует соглашение о том, что предоставляемые URI и столбцы данных, должны быть доступны в виде констант, чтобы упростить привязку к данным. Встроенные `ContentProviders` в Android предоставляют удобные классы с константами, которые ссылаются на структуру данных в пространстве имен [`Android.Providers`](xref:Android.Provider).

### <a name="built-in-providers"></a>Встроенные поставщики

Android предоставляет доступ к широкому спектру системных и пользовательских данных с помощью `ContentProviders`:

- *Browser* &ndash; закладки и журнал браузера (требуется разрешение `READ_HISTORY_BOOKMARKS` и/или `WRITE_HISTORY_BOOKMARKS`).

- *CallLog* &ndash; последние вызовы, сделанные или полученные на устройстве.

- *Contacts* &ndash; подробные сведения из списка контактов пользователя, включая людей, телефоны, фотографии & группы.

- *MediaStore* &ndash; содержимое устройства пользователя: аудио (альбомы, исполнители, жанры, списки воспроизведения), изображения (включая эскизы) и видео.

- *Settings* &ndash; параметры и настройки устройства на уровне системы.

- *UserDictionary* &ndash; содержимое заданного пользователем словаря, который используется для прогнозирования при вводе текста.

- *Voicemail* &ndash; журнал сообщений голосовой почты.

## <a name="classes-overview"></a>Общие сведения о классах

Ниже показаны основные классы, используемые при работе с `ContentProvider`.

[![Диаграмма классов приложения поставщика содержимого и взаимодействия приложения-потребителя](how-it-works-images/classdiagram1.png)](how-it-works-images/classdiagram1.png#lightbox)

На этой схеме `ContentProvider` реализует запросы и регистрирует URI, которые используются другими приложениями для нахождения данных. `ContentResolver` выступает в качестве посредника для `ContentProvider` (методы Query, Insert, Update и Delete). `SQLiteOpenHelper` содержит данные, используемые `ContentProvider`, но он не предоставляется напрямую приложениям-потребителям.
`CursorAdapter` передает курсор, возвращаемый `ContentResolver`, для вывода в `ListView`. `UriMatcher` — это вспомогательный класс, который анализирует коды URI при обработке запросов.

Назначение каждого класса дано ниже.

- **ContentProvider** &ndash; реализует методы этого абстрактного класса для предоставления данных. API доступен для других классов и приложений через атрибут URI, который добавляется в определение класса.

- **SQLiteOpenHelper** &ndash; помогает реализовать это хранилище данных SQLite, предоставляемое `ContentProvider`.

- **UriMatcher** &ndash; использует `UriMatcher` в реализации `ContentProvider`, чтобы облегчить управление кодами URI, которые используются для запроса содержимого.

- **ContentResolver** &ndash; кода потребителя использует `ContentResolver` для доступа к экземпляру `ContentProvider`. Эти два класса совместно устраняют проблемы межпроцессного взаимодействия, позволяя легко обмениваться данными между приложениями. Код потребителя никогда не создает класс `ContentProvider` явным образом. Вместо этого доступ к данным осуществляется путем создания курсора на основе URI, предоставляемого приложением `ContentProvider`.

- **CursorAdapter** &ndash; использует `CursorAdapter` или `SimpleCursorAdapter` для вывода доступа к данным через `ContentProvider`.

API `ContentProvider` позволяет приложениям-потребителям выполнять различные операции с данными, например:

- запрашивать данные для возврата списков или отдельных записей;
- изменять отдельные записи;
- добавлять новые записи;
- удалять записи.

Этот документ содержит пример, в котором используется предоставляемый системой `ContentProvider`, а также простой пример только для чтения, реализующий пользовательский `ContentProvider`.
