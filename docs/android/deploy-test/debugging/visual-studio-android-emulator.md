---
title: "Эмулятор Visual Studio для Android"
description: "В этом руководстве содержатся сведения о настройке и использовании эмулятора Visual Studio для Android для разработки приложений Xamarin.Android в Visual Studio 2015."
ms.topic: article
ms.prod: xamarin
ms.assetid: CD128CB9-499F-4558-B49F-77248824EFDF
ms.technology: xamarin-android
author: mgmclemore
ms.author: mamcle
ms.date: 03/01/2018
ms.openlocfilehash: a31d90e6d5abd574eb6187953082e1b70f66a113
ms.sourcegitcommit: 0fdb243b46cf21be47584900805cadcd077121bf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2018
---
# <a name="visual-studio-android-emulator"></a>Эмулятор Visual Studio для Android

_В этом руководстве содержатся сведения о настройке и использовании эмулятора Visual Studio для Android для разработки приложений Xamarin.Android в Visual Studio 2015._

## <a name="visual-studio-android-emulator-overview"></a>Обзор эмулятора Visual Studio для Android

В состав Microsoft Visual Studio 2015 входит эмулятор Android, который можно использовать в качестве целевого объекта для отладки приложения Xamarin.Android: *Эмулятор Visual Studio для Android*. Этот эмулятор использует возможности Hyper-V компьютера разработки, что сокращает время запуска и выполнения по сравнению с показателями эмулятора по умолчанию, входящего в состав пакета SDK для Android. При разработке приложения Xamarin.Android эмулятор Visual Studio для Android можно использовать в качестве альтернативы эмулятору SDK для Android по умолчанию.

В этом руководстве содержатся сведения о запуске эмулятора Microsoft Android из Visual Studio для тестирования приложения и описываются различные функции, доступные в эмуляторе. Вы узнаете, как выбирать *профили устройств* (аналогичные определениям устройств в эмуляторе SDK для Android) для моделирования различных типов устройств Android. В разделе по устранению неполадок рассматриваются общие проблемы и приводятся варианты их устранения.

## <a name="requirements"></a>Требования

Чтобы запустить эмулятор, компьютер должен удовлетворять требованиям для запуска Hyper-V. Для Hyper-V необходима 64-разрядная версия профессионального выпуска Windows 8, Windows 8.1, Windows 10 или более поздней версии. Дополнительные сведения о требованиях см. в статье [Требования к системе для эмулятора Visual Studio для Android](https://msdn.microsoft.com/en-us/library/mt228280.aspx).

> [!NOTE]
> HAXM (используемый эмулятором пакета SDK для Android) нельзя использовать, если включена технология Hyper-V. Дополнительные сведения об ограничениях и возможных проблемах с HAXM см. в статье [Конфликты виртуализации HAXM](~/android/deploy-test/debugging/android-sdk-emulator/troubleshooting.md#virt-conflicts).


## <a name="running-the-emulator"></a>Запуск эмулятора

В Visual Studio в раскрывающемся меню **Целевой объект отладки** доступно несколько предварительно настроенных профилей целевых устройств (как показано на следующем снимке экрана). Целевые объекты эмулятора Microsoft Android начинаются с сегмента **Эмулятор VS**:

[![Предварительно настроенные профили целевых устройств](visual-studio-android-emulator-images/01-vs-emulator-defaults-vs-sml.png)](visual-studio-android-emulator-images/01-vs-emulator-defaults-vs.png#lightbox)

Когда Visual Studio запускает приложение Xamarin.Android, запускается эмулятор с выбранным целевым устройством, и приложение развертывается в эмуляторе. В левом нижнем углу Visual Studio появится сообщение, информирующее о запуске эмулятора:

[![Запуск эмулятора Visual Studio](visual-studio-android-emulator-images/02-emulator-starting-vs-sml.png)](visual-studio-android-emulator-images/02-emulator-starting-vs.png#lightbox)

После задержки запуска отображается экран эмулятора, аналогичный приведенному на нижнем левом изображении. Перетащите значок блокировки на экране вверх, чтобы разблокировать устройство.
После этого приложение Xamarin.Android должно выполняться в эмуляторе, как показано на изображении справа:

[![Снимки экрана эмулятора](visual-studio-android-emulator-images/03-first-screen-vs-sml.png)](visual-studio-android-emulator-images/03-first-screen-vs.png#lightbox)

Как и в случае с эмулятором SDK для Android по умолчанию, можно устанавливать точки останова в коде, проверять значения переменных и просматривать стек вызовов. На вертикальной панели инструментов в правой части эмулятора находятся кнопки для доступа к функциям эмулятора:

[![Кнопки на вертикальной панели инструментов](visual-studio-android-emulator-images/04-vertical-toolbar-vs-sml.png)](visual-studio-android-emulator-images/04-vertical-toolbar-vs.png#lightbox)

В следующем списке перечислены функции каждой кнопки на вертикальной панели инструментов:

-   **Закрыть** &ndash; завершает работу приложения эмулятора. Эта кнопка используется нечасто &ndash; как правило, эмулятор остается в рабочем состоянии после первого запуска (во избежание задержки перезапуска эмулятора) и закрывается, только когда он больше не нужен.

-   **Свернуть** &ndash; оставляет эмулятор запущенным, но сворачивает его на панель задач.

-   **Вкл** &ndash; моделирует включение и выключение устройства. (Эмулятор продолжает работать.)

-   **Мультисенсорный ввод** &ndash; накладывает на экран устройства несколько точек, действующих в качестве точек касания для увеличения и уменьшения масштаба жестами.
    При перетаскивании одной точки другая точка перемещается в обратном направлении, что имитирует перемещение двумя пальцами.

-   **Одноточечный ввод мышью** &ndash; возвращает устройство в режим одноточечного ввода мышью (после использования мультисенсорного ввода).

-   **Повернуть влево/Повернуть вправо** &ndash; помогает проверить реакцию приложения на изменение ориентации. Например, при первом нажатии кнопки *Повернуть влево* эмулятор переключится в режим альбомной ориентации. При нажатии кнопки *Повернуть вправо* эмулятор вернется в режим книжной ориентации.

-   **По размеру экрана** &ndash; увеличивает размер экрана эмулятора в соответствии с размером рабочего стола.

-   **Масштаб** &ndash; масштабирует экран эмулятора на 33 %, 50 %, 66 %, 100 % или на указанное пользователем значение.


Кнопка *Дополнительные инструменты* открывает диалоговое окно со списком дополнительных функций эмулятора:

[![Диалоговое окно "Дополнительные инструменты"](visual-studio-android-emulator-images/05-additional-tools-vs-sml.png)](visual-studio-android-emulator-images/05-additional-tools-vs.png#lightbox)


Дополнительные функции доступны в строке вкладок в верхней части диалогового окна:

-   **Акселерометр** &ndash; моделирует перемещение устройства в трехмерном пространстве.

-   **Расположение** &ndash; представляет карту, которую можно использовать для выбора и моделирования GPS-расположения. На этой карте можно создать *точки* для моделирования перемещения между расположениями.

-   **Батарея** &ndash; предоставляет ползунок для моделирования уровня заряда батареи.

-   **Снимок экрана** &ndash; На этой вкладке находится кнопка **Запись**, которая делает снимок экрана и сразу же отображает его. Кнопка *Сохранить* используется для сохранения снимка.

-   **Камера** &ndash; моделирует съемку с помощью фиксированного анимированного изображения, фото из файла или с подключенной веб-камеры на главном компьютере. Можно выбрать переднюю или заднюю камеры.

-   **SD-карта** &ndash; Эмулятор может создать на главном компьютере доступную для устройства папку в виде SD-карты.
    Когда приложение считывает и записывает файлы на смоделированную SD-карту, к файлам можно обращаться напрямую с рабочего стола без использования команды `adb`.

-   **Сеть** &ndash; отображает сводку сетевых параметров эмулятора (эмулятор использует сетевое подключение на главном компьютере).

Дополнительные сведения об использовании этих функций см. в статье [Введение в эмулятор Visual Studio для Android](https://blogs.msdn.microsoft.com/visualstudioalm/2014/11/12/introducing-visual-studios-emulator-for-android/).



## <a name="configuring-device-profiles"></a>Настройка профилей устройств

Эмулятор Microsoft Android содержит набор профилей устройств, которые представляют наиболее популярные версии Android, размеры экранов и свойства оборудования для устройств Android. Кроме того, эти профили устройств уже настроены для различных версий Android, например KitKat, Lollipop и Marshmallow.

Установка, удаление и запуск профилей устройств выполняются с помощью *диспетчера эмуляторов*. В меню **Сервис** выберите **Эмулятор Visual Studio для Android...** , как показано на этом снимке экрана:

[![Запуск эмулятора из меню "Сервис"](visual-studio-android-emulator-images/06-launch-emulator-manager-vs-sml.png)](visual-studio-android-emulator-images/06-launch-emulator-manager-vs.png#lightbox)

Откроется диалоговое окно **Профили устройств**. Установленные профили выделены в верхней части списка профилей устройств. Профили, которые не установлены (но доступны для установки), выделены серым цветом:

[![Значки профилей устройств](visual-studio-android-emulator-images/07-device-profiles-vs-sml.png)](visual-studio-android-emulator-images/07-device-profiles-vs.png#lightbox)

Чтобы установить новый профиль, щелкните значок установки профиля (указывающая вниз стрелка, как показано в приведенном выше снимке экрана). Например, при щелчке значка установки профиля для **5.7" Marshmallow (6.0.0) XHDPI Phone** диспетчер эмуляторов скачает профиль, как показано ниже:

[![Пример скачивания профилей](visual-studio-android-emulator-images/08-downloading-profile-vs-sml.png)](visual-studio-android-emulator-images/08-downloading-profile-vs.png#lightbox)

Скачанный профиль устройства будет выделен, чтобы указать, что профиль установлен успешно. Если щелкнуть значок *Показать подробности*, будет отображен тип платформы, архитектура ЦП, размер и разрешение экрана и объем доступной памяти на устройстве:

[![Отображение сведений о профиле устройства](visual-studio-android-emulator-images/09-show-details-vs-sml.png)](visual-studio-android-emulator-images/09-show-details-vs.png#lightbox)

Теперь в раскрывающемся меню Visual Studio **Целевой объект отладки** новый установленный профиль устройства доступен как целевой объект:

[![Новый профиль в раскрывающемся меню целевого объекта](visual-studio-android-emulator-images/10-debug-target-vs-sml.png)](visual-studio-android-emulator-images/10-debug-target-vs.png#lightbox)

Этот список можно сократить, щелкнув **Удалить этот профиль** в *диспетчере эмуляторов*, чтобы удалить неиспользуемые профили устройств. Обратите внимание, что сейчас нет возможности для создания настроенного профиля устройства в этом эмуляторе.


## <a name="troubleshooting"></a>Устранение неполадок

В этом разделе описываются некоторые распространенные ошибки, возникающие при использовании *эмулятора Visual Studio для Android* с Xamarin.Android, и приводятся способы их устранения.

<a name="cant_connect" />

### <a name="emulator-will-not-start"></a>Эмулятор не запускается

В некоторых случаях эмулятор не запустится при наличии проблем совместимости между процессором узла и виртуальной машиной Hyper-V. Чтобы решить эту проблему, настройте Hyper-V для ограничения функций процессора, доступных виртуальной машине &ndash; это позволит улучшить совместимость виртуальной машины с различными версиями процессора узла.
Чтобы внести это изменение, выполните следующие действия:

1.  Нажмите кнопку **Пуск**, введите **MMC** и нажмите клавишу **ВВОД**. Щелкните **Диспетчер Hyper-V** как показано ниже:

    [![Диспетчер Hyper-V](visual-studio-android-emulator-images/15-launch-hyperv-manager.png)](visual-studio-android-emulator-images/15-launch-hyperv-manager.png#lightbox)

2.  В области **Виртуальные машины** диспетчера Hyper-V щелкните правой кнопкой мыши эмулятор для изменения и выберите пункт **Параметры...**:

    [![Пункт "Параметры" в меню виртуальных машин](visual-studio-android-emulator-images/16-vm-settings.png)](visual-studio-android-emulator-images/16-vm-settings.png#lightbox)

3.  В окне параметров найдите раздел **Совместимость** (выберите **Оборудование > Процессор**) и выберите параметр **Выполнить перенос на физический компьютер с другой версией процессора**:

    [![Выбранный параметр переноса](visual-studio-android-emulator-images/17-set-compatibility-vs-sml.png)](visual-studio-android-emulator-images/17-set-compatibility-vs.png#lightbox)

4.  Нажмите кнопку **OK** и закройте окно диспетчера Hyper-V.



### <a name="app-deploys-and-starts-but-fails-immediately"></a>Приложение развертывается и запускается, но сразу завершается ошибкой

В этом случае эмулятор запускается, приложение успешно развертывается в эмуляторе и запускается. Однако приложение сразу же завершается ошибкой.
Во многих случаях эта проблема возникает из-за несовместимостей между процессором узла и виртуальной машиной Hyper-V. Чтобы устранить эту ошибку, следуйте инструкциям в разделе [Эмулятор не запускается](#cant_connect) выше.


### <a name="emulator-stops-with-the-diagnostic-message-libaot-mscorlibdllso-not-found"></a>Эмулятор останавливается с диагностическим сообщением: **libaot-mscorlib.dll.so не найден**

Чтобы устранить эту ошибку, выполните следующие действия по отключению Fast Deployment:

1.  Чтобы устранить эту ошибку, следуйте инструкциям в разделе [Эмулятор не запускается](#cant_connect) выше.

2.  Дважды щелкните **Свойства**.

3.  Щелкните **Параметры Android** и снимите флажок **Использовать Fast Deployment (только в режиме отладки)**:

    [![Снятый флажок "Использовать быстрое развертывание"](visual-studio-android-emulator-images/18-fast-deployment-vs-sml.png)](visual-studio-android-emulator-images/18-fast-deployment-vs.png#lightbox)



### <a name="drag-and-drop-does-not-work"></a>Перетаскивание не работает

Если *эмулятор Visual Studio для Android* запущен с правами администратора (или запущен из Visual Studio, работающей с правами администратора), перетаскивание APK- или ZIP-файлов может не работать. Чтобы устранить эту проблему, запустите *эмулятор Visual Studio для Android* без повышенных разрешений (т. е. не от имени администратора).


### <a name="other-errors"></a>Другие ошибки

Приведенные выше советы по устранению неполадок действуют для наиболее распространенных проблем при использовании эмулятора Visual Studio для Android с Xamarin.Android. Более полное руководство по устранению неполадок эмулятора Visual Studio для Android см. в статье [Устранение неполадок эмулятора Visual Studio для Android](https://msdn.microsoft.com/en-us/library/mt228282.aspx).



## <a name="summary"></a>Сводка

В этой статье был представлен *эмулятор Visual Studio для Android*, описывалось использование эмулятора для отладки приложений Xamarin.Android в Visual Studio, рассматривались функции кнопок на вертикальной панели инструментов и давался краткий обзор функций, доступных в диалоговом окне **Дополнительные инструменты**. Здесь объяснялось использование *диспетчера эмуляторов* для установки, удаления и запуска профилей устройств. В разделе *Устранение неполадок* описывались распространенные проблемы, возникающие при использовании эмулятора, и приводились способы их решения.


## <a name="related-links"></a>Связанные ссылки

- [Эмулятор Visual Studio для Android](https://www.visualstudio.com/en-us/explore/msft-android-emulator-vs.aspx)
- [Введение в эмулятор Visual Studio для Android](https://blogs.msdn.microsoft.com/visualstudioalm/2014/11/12/introducing-visual-studios-emulator-for-android/)
