---
title: "Автоматический макет с помощью конструктора Xamarin для iOS"
description: "В этом руководстве описаны iOS автоматический макет и нового ограничения рабочего процесса доступными в конструкторе Xamarin для операций ввода-вывода."
ms.topic: article
ms.prod: xamarin
ms.assetid: CAC7A715-55BB-45E2-BB6D-2168D36D428F
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/21/2017
ms.openlocfilehash: ff19048504ee76db614306adebb71b7237139091
ms.sourcegitcommit: 73bd0c7e5f237f0a1be70a6c1384309bb26609d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2018
---
# <a name="auto-layout-with-the-xamarin-designer-for-ios"></a>Автоматический макет с помощью конструктора Xamarin для iOS

_В этом руководстве описаны iOS автоматический макет и нового ограничения рабочего процесса доступными в конструкторе Xamarin для операций ввода-вывода._

Автоматический макет (также называется «адаптивной макета») — это гибкий Дизайн подход. В отличие от системы переходные макет, где каждый элемент находится жестко запрограммировано на точку на экране, автоматический макет посвящен *связи* -позиции элементов относительно других элементов в рабочей области конструирования. Основа автоматический макет является идея ограничения или правила, которые определяют положение элемента или набора элементов в контексте других элементов на экране. Так как элементы не связаны с определенной позиции на экране, ограничения помогают создать адаптивный макета, удобная для разных размеров и ориентации устройства.

В этом руководстве мы представим, ограничения и способы работы с ними в конструкторе Xamarin iOS. В данном руководстве не рассматривается работа с ограничениями программным способом. Сведения об использовании автоматический макет программно, см. [документации Apple](https://developer.apple.com/library/prerelease/ios/documentation/UserExperience/Conceptual/AutolayoutPG/ProgrammaticallyCreatingConstraints.html).

## <a name="requirements"></a>Требования

Конструктор Xamarin для операций ввода-вывода доступна в Visual Studio для Mac в Visual Studio 2015 и 2017 г. в Windows.

В этом руководстве предполагается знаний компоненты конструктора из [введение в конструктор iOS](~/ios/user-interface/designer/introduction.md) руководства.

## <a name="introduction-to-constraints"></a>Общие сведения об ограничениях

Ограничение — математическое преобразование связь между двумя элементами на экране. Представляет пользовательский Интерфейс положение элемента математические связи позволяет решить несколько проблем, связанных с жестко запрограммированные расположение элемента пользовательского интерфейса. Например если бы мы поместите 20px кнопок в нижней части экрана в книжной ориентации, положение кнопки будет за пределы экрана в альбомной ориентации. Чтобы избежать этого, мы удалось задать ограничение, которое помещает нижнего края 20px кнопок в нижней части представления. Позиция для края кнопки затем будет вычисляться как *button.bottom = view.bottom - 20px*, который помещается в режиме книжной и альбомной 20px кнопок в нижней части представления. Возможность вычисления на основе математические связи размещения — почему ограничения полезна при разработке пользовательского интерфейса.

При задании ограничения, мы создадим `NSLayoutConstraint` объекта, который принимает в качестве аргументов, объектов, ограниченных и свойств, или *атрибуты*, который будет действовать ограничение. В конструкторе операций ввода-вывода атрибуты включают границ, таких как *левой*, *правой*, *верхней*, и *нижней* элемента. Они также содержат атрибуты размера например *высота* и *ширина*и центр расположение, точки *centerX* и *centerY*. Например если добавить ограничение по позиции от левой границы две кнопки, конструктор создает следующий код на самом деле:

```csharp
View.AddConstraint (NSLayoutConstraint.Create (Button1, NSLayoutAttribute.Left, NSLayoutRelation.Equal, Button2, NSLayoutAttribute.Left, 1, 10));
```

В следующем разделе рассматривается работа с ограничений при помощи конструктора, включая Включение и отключение автоматический макет и с помощью панели инструментов ограничения iOS.

## <a name="enable-auto-layout"></a>Включить автоматический макет

Конфигурации по умолчанию для конструктора операций ввода-вывода был включен режим ограничения. Однако следует необходимо включить или отключить его вручную, это можно сделать в два этапа:

1.  Щелкните пустое место в области конструктора. Это отменяет выбор всех элементов и отображается окно свойств для документа раскадровки.
1.  Установите или снимите **Autolayout используйте** флажок на панели «Свойства»:

    ![](designer-auto-layout-images/image01.png "Флажок использования Autolayout на панели «Свойства»")


По умолчанию никаких ограничений, созданный или отображается в рабочей области. Вместо этого они автоматически вывести из сведений о кадре во время компиляции. Чтобы добавить ограничения, нам нужно выберите элемент в области конструктора и добавьте к нему ограничения. Мы можем сделать, используя **инструментов ограничение**.

## <a name="constraints-toolbar"></a>Ограничения инструментов

 [![](designer-auto-layout-images/toolbarnew.png "Команды контекстного меню")](designer-auto-layout-images/toolbarnew.png#lightbox)

Ограничения инструментов уже был обновлен и теперь состоит из двух основных частей:

- **Кнопка переключателя ограничения режима**: ранее, вы ввели ограничения режим, еще раз щелкнув выбранное представление в области конструктора. Теперь следует использовать этот выключатель в строке ограничения:

  ![Переключение режимов ограничений](designer-auto-layout-images/constraints.png)

- **Кнопка «Ограничения на обновление»:** важно Обратите внимание, что изменения в зависимости от того, если в режиме редактирования ограничения.
  - В режиме редактирования ограничение нажатием этой кнопки изменяется ограничения для сопоставления элемента фрейма.
  - В режиме редактирования кадре нажатием этой кнопки изменяется фрейма элемента в соответствии с указанной позиции определении ограничения.


## <a name="surface-based-constraint-editing"></a>Ограничения на основе область редактирования

В предыдущем разделе мы узнали, ограничения по умолчанию добавлять и удалять ограничения с помощью панели инструментов ограничения. Для более точно настроить ограничение изменения, могут взаимодействовать ограничения непосредственно на поверхности разработки. Этот раздел знакомит с основами ограничения на основе область редактирования, в том числе элементов управления, областей и работа с различных типов ограничений интервалы ПИН-код.

### <a name="creating-constraints"></a>Создание ограничения

Средство конструктора iOS предлагает два типа элементов управления для управления элементами в рабочей области конструирования. *Перетаскивание элементов управления* и *интервалы ПИН-код элементов управления*, как показано на следующем рисунке:

![элементы управления представлением](designer-auto-layout-images/controls.png)

Они включаются, выбрав в строке ограничения режима «ограничения».

Определение 4 маркеры T-образный на каждой стороне элемента *верхней*, *правой*, *нижней*, и *левой* краями элемента для ограничение. Я форме маркеры в правой и нижней части элемента определения *высота* и *ширина* ограничение соответственно. Средний квадрат обрабатываются *centerX* и *centerY* ограничения.

Для создания ограничения, выбрать дескриптор и перетащите его где-либо в области конструктора. Когда пользователь начинает перетаскивание, ряд зеленые линии или прямоугольники будут отображаться в рабочей области, о том, что можно ограничить. Например на снимке экрана ниже, мы ограничиваемого в верхней части средней кнопки:

 [![](designer-auto-layout-images/image07.png "Ограничение в верхней части средней кнопки")](designer-auto-layout-images/image07.png#lightbox)

Обратите внимание, три пунктирных линий зеленый через две другие кнопки. Зеленые линии указывают *области размещения*, или другие элементы, к которым можно ограничить атрибуты. На снимке экрана выше, две другие кнопки предлагают 3 вертикальной областей ( *нижней*, *centerY*, *верхней*) для ограничения кнопку. Пунктирной зеленой линией в верхней части представления означает контроллер представление имеет ограничение в верхней части представления, а сплошной зеленой рамке означает, что контроллер представление имеет ограничение ниже верхнего разметку.

> [!IMPORTANT]
> Направляющие представляют собой особый тип ограничения целевых объектов, которые позволяют создавать верхней и нижней ограничения, которые учитывают наличие полосы системы, таких как строки состояния или панели инструментов. Одно из основных способов использования – заставить приложения совместимы с iOS 6 и iOS 7, с момента последней версии имеет вид контейнера, расположенного под в строке состояния. Дополнительные сведения о структуре макета верхнего посвящены [документации Apple](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/transitionguide/AppearanceCustomization.html#//apple_ref/doc/uid/TP40013174-CH15-SW2).



В следующих трех разделах вводятся работа с различных типов ограничений.

### <a name="size-constraints"></a>Ограничения размеров

С ограничениями по размеру - *высота* и *ширина* -имеются две возможности. Первый вариант — перетащите маркер, чтобы ограничить размер элемента соседнего узла, как показано в приведенном выше примере. Другим вариантом является дважды щелкните маркер, чтобы создать ограничение self. Это позволяет указать размер постоянное значение, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/sizec.png "Перетащите маркер, чтобы ограничить размер элемента соседнего узла, как показано здесь")](designer-auto-layout-images/sizec.png#lightbox)

### <a name="center-constraints"></a>Ограничения Center

Квадратный маркер создаст *centerX* или *centerY* ограничение, в зависимости от контекста. Квадратный маркер перетаскивания появится другие элементы предлагать обоих вертикальные и горизонтальные областей, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/centerc.png "Ограничения Center")](designer-auto-layout-images/centerc.png#lightbox)

При выборе вертикальная область, *centerY* создается ограничение. При выборе горизонтальная область ограничение будет основываться на *centerX*.

### <a name="combinational-constraints"></a>Combinational ограничения

Для создания выравнивания и ограничения размеров равенство между двумя элементами, можно выбрать элементы из верхней части панели инструментов для указания - в порядке: выравнивание по горизонтали, выравнивание по вертикали и размер равенства, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image06.png "Combinational ограничения")](designer-auto-layout-images/image06.png#lightbox)

### <a name="visualizing-and-editing-constraints"></a>Визуализации и редактирования ограничения

При добавлении ограничения, он отображается в рабочей области конструирования как синей линией при выборе элемента:

 [![](designer-auto-layout-images/image09.png "Визуализация ограничения")](designer-auto-layout-images/image09.png#lightbox)

Ограничение можно выбрать, щелкнув на синюю линию и редактирования значений ограничений непосредственно на панели «Свойства». Кроме того дважды щелкнув на синюю линию появится popover, который позволяет изменять значения непосредственно в области конструктора:

 [![](designer-auto-layout-images/image08.png "Изменение ограничений")](designer-auto-layout-images/image08.png#lightbox)

## <a name="constraint-issues"></a>Проблемы ограничения

Несколько типов проблемы могут возникнуть при использовании ограничения:

-  **Конфликтующие ограничения** — это происходит, когда несколько ограничений принудительно элемента может иметь конфликтующие значения для атрибута и ограничение engine не удалось согласовать их.
-  **Underconstrained элементы** — свойства элемента (расположение + размер) должен полностью покрываться свой набор ограничений и встроенная функция размеры для ограничения недействителен. Если эти значения являются неоднозначными, считается, что элемент будет underconstrained.
-  **Кадр потери портативного компьютера** — это происходит, когда фрейма элемента и его набор ограничений определяют двух разных полученный прямоугольников.


В этом разделе будут рассмотрены в трех перечисленных выше проблем и предоставляет подробные сведения о том, как их обрабатывать.

### <a name="conflicting-constraints"></a>Конфликтующие ограничения

Конфликтующие ограничения помечаются красным цветом и иметь символ предупреждения. Вызывает popover с сведения о конфликте наведении указателя мыши на предупреждение символы:

 [![](designer-auto-layout-images/image11.png "Конфликтующие ограничения предупреждение")](designer-auto-layout-images/image11.png#lightbox)

### <a name="underconstrained-items"></a>Underconstrained элементов

Underconstrained элементы выделены оранжевым цветом и запустить внешний вид маркера оранжевый значка панели объекта контроллера представления:

 [![](designer-auto-layout-images/image02.png "Underconstrained элементы выделены оранжевым цветом")](designer-auto-layout-images/image02.png#lightbox)

При нажатии на значок этого маркера можно получить сведения о underconstrained элементы в сцене и разрешения проблем, либо полностью ограничение их или, удалив их ограничений, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image10.png "Исправление Underconstrained элементов")](designer-auto-layout-images/image10.png#lightbox)

### <a name="frame-misplacement"></a>Кадр потери портативного компьютера

Кадр потери портативного компьютера используется один и тот же код цвет как underconstrained элементы. Элемент всегда отображается на поверхность, используя его фрейм машинного кода, но в случае потери портативного компьютера кадра красный прямоугольник отметит которой элемент будет заканчиваться при запуске приложения, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image05.png "Пример представления кадра потери портативного компьютера")](designer-auto-layout-images/image05.png#lightbox)

Для устранения ошибок кадров потери портативного компьютера выберите **обновления кадров на основе ограничений** кнопки на панели инструментов ограничения (правого кнопка):

 [![](designer-auto-layout-images/image03.png "Обновляются кадры, в зависимости от ограничений кнопки панели инструментов")](designer-auto-layout-images/image03.png#lightbox)

Это автоматически настроит фрейма элемента для соответствия позициях, определенных элементов управления.

<a name="modifying-in-code" />

## <a name="modifying-constraints-in-code"></a>Изменение ограничений в коде

Зависимости от требований приложения, возможны ситуации, когда необходимо изменить ограничение в коде. Например чтобы изменить размер или положение представления ограничение, чтобы изменить приоритет ограничение или полностью отключить ограничение.

Для доступа к ограничению в коде, сначала нужно предоставлять его в конструкторе iOS следующим образом:

1. Создание ограничения в обычном режиме (с помощью любого из перечисленных выше методов).
2. В **обозреватель документов структура**, найти нужное ограничение и выберите его:

    [![](designer-auto-layout-images/modify01.png "В обозревателе структуры документа")](designer-auto-layout-images/modify01.png#lightbox)
3. Затем назначить **имя** с ограничением в **мини-приложение** вкладке **свойства обозревателя**:

    [![](designer-auto-layout-images/modify02.png "Вкладка мини-приложения")](designer-auto-layout-images/modify02.png#lightbox)
4. Сохраните изменения.

Изменения выше, в месте можно получить доступ к ограничению в коде и изменение его свойств. Например можно использовать следующие для задания высоты представления, присоединенные к нулю:

```csharp
ViewInfoHeight.Constant = 0;
```

Рассмотрим следующий параметр для ограничения в конструкторе iOS:

[![](designer-auto-layout-images/modify03.png "Изменение ограничения на обозреватель свойств")](designer-auto-layout-images/modify03.png#lightbox)

### <a name="the-deferred-layout-pass"></a>Отложенное передачи макета

Вместо мгновенно обновлением вложенного отчета в ответ на изменения ограничения, обработчик макетов автоматически назначает _передачи макета отложенный_ на ближайшее время. Во время этого этапа отложенное не только является ограничением для данного представления обновлены, ограничения для каждого представления в иерархии повторно и обновлены с учетом нового макета.

В любой момент можно запланировать собственную передачи макета отложенный путем вызова `SetNeedsLayout` или `SetNeedsUpdateConstraints` методы родительского представления. 

Передачи макета отложенный состоит из двух уникальных проходит через представление иерархии.

- **На этапе обновления** -в этом сеансе обработчик макетов автоматически проходит через представление иерархии и вызывает `UpdateViewConstraints` метод на всех контроллерах представление и `UpdateConstraints` метод для всех представлений.
- **Передачи макета** — еще раз, обработчик макетов автоматически проходит через представление иерархии, но этот раз вызывает `ViewWillLayoutSubviews` метод на всех контроллерах представление и `LayoutSubviews` метод для всех представлений. `LayoutSubviews` Метод обновляет `Frame` вычисляемые свойства каждого вложенное представление с прямоугольником обработчиком макетов автоматически.

### <a name="animating-constraint-changes"></a>Анимация изменения ограничения

В дополнение к изменению свойств ограничения, можно использовать основной анимации анимировать изменения представления ограничений. Пример:

```csharp
UIView.BeginAnimations("OpenInfo");
UIView.SetAnimationDuration(1.0f);
ViewInfoHeight.Constant = 237;
View.LayoutIfNeeded();

//Execute Animation
UIView.CommitAnimations();
```

Основная идея вызывает `LayoutIfNeeded` метод родительского представления внутри блока анимации. Это значение определяет представления для рисования каждого «frame» анимированных расположение или изменения размера. Без этой строки представление было просто подключить к окончательной версии без анимации.

## <a name="summary"></a>Сводка

В этом руководстве представлена iOS Auto (или «adaptive») макет и концепция ограничения как математические представления связей между элементами в рабочей области конструирования. Оно описано, как включить автоматический макет в конструкторе операций ввода-вывода, работа с **инструментов ограничения**и изменение ограничений по отдельности в рабочей области конструирования. Далее он описывается устранение неполадок три общие ограничения. Наконец оно было показано, как изменить ограничения в коде.

## <a name="related-links"></a>Связанные ссылки

- [Введение в раскадровку](~/ios/user-interface/storyboards/index.md)
- [Проектирование пошагового руководства элементы управления iOS](~/ios/user-interface/designer/ios-designable-controls-walkthrough.md)
- [Общие сведения о конструкторе Android](~/android/user-interface/android-designer/index.md)
- [Программные ограничения](~/ios/user-interface/programmatic-layout-constraints.md)
- [Apple — руководство по макета Auto](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/AutolayoutPG/Introduction/Introduction.html#/apple_ref/doc/uid/TP40010853-CH13-SW1)
