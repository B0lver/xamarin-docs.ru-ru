---
title: Автоматический макет в конструкторе Xamarin для iOS
description: В этом руководстве представлены iOS автоматический макет и описывается, как использовать конструктор Xamarin для iOS, создавать и редактировать макеты, используя ограничения. В нем также описывается изменение ограничений в коде, анимация изменения ограничения и многое другое.
ms.prod: xamarin
ms.assetid: CAC7A715-55BB-45E2-BB6D-2168D36D428F
ms.technology: xamarin-ios
author: lobrien
ms.author: laobri
ms.date: 03/21/2017
ms.openlocfilehash: 41a9ec90b4b734dde7a982ac3d4b2e7b2082321c
ms.sourcegitcommit: 650458de1d362cd7de174cacef7838f0e74426f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2019
ms.locfileid: "58070870"
---
# <a name="auto-layout-with-the-xamarin-designer-for-ios"></a>Автоматический макет в конструкторе Xamarin для iOS

Автоматический макет (также называется «адаптивный макет») — это гибкий Дизайн подход. В отличие от системы transitional макета, где каждый элемент расположение — это жестко в точку на экране, автоматический макет посвящен *связи* -позиции элементов относительно других элементов в рабочей области конструирования. В сердце автоматический макет является идея ограничения или правила, определяющие расположение элемента или набора элементов в контексте других элементов на экране. Так как элементы не привязаны к конкретной должности на экране, ограничения помогают создать адаптивный макет, который хорошо выглядит на экранах различных размеров и ориентации устройства.

В этом руководстве мы представляем, ограничения и способы работы с ними в конструкторе iOS Xamarin. В этом руководстве не рассматривается работа с ограничениями программным способом. Сведения об использовании автоматический макет программными средствами см. [документации Apple](https://developer.apple.com/library/prerelease/ios/documentation/UserExperience/Conceptual/AutolayoutPG/ProgrammaticallyCreatingConstraints.html).

## <a name="requirements"></a>Требования

Конструктор Xamarin для iOS доступен в Visual Studio для Mac в Visual Studio 2017 и более поздней версии на Windows.

В этом руководстве предполагается знание компоненты конструктора из [введение в конструктор iOS](~/ios/user-interface/designer/introduction.md) руководства.

## <a name="introduction-to-constraints"></a>Введение ограничений

Ограничение — математическое представление связи между двумя элементами на экране. Представляющий пользовательский Интерфейс положение элемента как математическую связь позволяет решить несколько проблем, связанных с жестко запрограммированного расположение элемент пользовательского интерфейса. Например если поместить 20px кнопку в нижней части экрана в книжной ориентации, положения кнопки будет на экране в альбомной ориентации. Чтобы избежать этого, нам удалось задать ограничение, которое помещает нижнего края 20px кнопку в нижней части представления. Позиция для края кнопки затем будет вычисляться как *button.bottom = view.bottom - 20px*, который следует поместить 20px кнопку в нижней части представления в режиме книжной и альбомной ориентации. Возможность размещения, основанной на отношении математические вычисления это и делает ограничения настолько полезен при разработке пользовательского интерфейса.

Если установить значение ограничения, мы создадим `NSLayoutConstraint` объекта, который принимает в качестве аргументов, объекты для ограничения и свойства, или *атрибуты*, будет действовать ограничение. В конструкторе iOS атрибуты включают границ, таких как *левой*, *правой*, *верхней*, и *нижней* элемента. Они также включают атрибуты размера например *высота* и *ширины*и расположение, точки центра *centerX* и *centerY*. Например при добавлении ограничения на положение левой границы из двух кнопок, конструктор создает следующий код на самом деле:

```csharp
View.AddConstraint (NSLayoutConstraint.Create (Button1, NSLayoutAttribute.Left, NSLayoutRelation.Equal, Button2, NSLayoutAttribute.Left, 1, 10));
```

Следующий раздел рассматривается работа с ограничениями, с помощью iOS Designer, включая Включение и отключение автоматического макета и используя панель инструментов ограничений.

## <a name="enable-auto-layout"></a>Включить автоматический макет

Конфигурация по умолчанию для конструктора iOS был включен режим ограничений. Тем не менее, если для вас для включения или отключения его вручную, это можно сделать в два этапа:

1.  Щелкните пустое место на поверхности разработки. Это отменяет выделение какие-либо элементы и свойства для документа раскадровки можно открыть.
1.  Установите или снимите флажок **Автомакет используйте** флажок на панели свойств:

    ![](designer-auto-layout-images/image01.png "Флажок использования Автомакет на панели «Свойства»")


По умолчанию никаких ограничений, созданный или он отображается в рабочей области. Вместо этого они автоматически вывести из сведений о кадре во время компиляции. Чтобы добавить ограничения, нам нужно выберите элемент в области конструктора и добавьте его ограничения. Мы можно сделать с помощью **инструментов ограничение**.

## <a name="constraints-toolbar"></a>Панель инструментов ограничений

 [![](designer-auto-layout-images/toolbarnew.png "Команды контекстного меню")](designer-auto-layout-images/toolbarnew.png#lightbox)

Панель инструментов ограничений был обновлен и теперь состоит из двух основных частей:

- **Кнопка переключателя режима ограничений**: Ранее вы включения режима ограничений требовалось повторно щелкать выбранное представление на поверхности разработки. Теперь следует использовать выключателя на панели ограничения:

  ![Переключить режимы ограничения](designer-auto-layout-images/constraints.png)

- **Кнопка «Ограничения обновления»:** Очень важно Обратите внимание, что изменения в зависимости от того, если вы в ограничениях режима редактирования.
  - В режиме редактирования ограничение нажатием этой кнопки изменяется ограничения для сопоставления элемента фрейма.
  - В режиме редактирования кадре нажатием этой кнопки изменяется элемент кадр в соответствии с указанной позиции определении ограничения.


## <a name="surface-based-constraint-editing"></a>Ограничение на основе область редактирования

В предыдущем разделе мы узнали, как добавить ограничения по умолчанию и удалите ограничения, используя панель инструментов ограничений. Для более тонкой настройки ограничения редактирования, могут взаимодействовать ограничения непосредственно на поверхности разработки. Этот раздел содержит базовые ограничения на основе область редактирования, в том числе элементов управления, областей и работа с различных типов ограничений пробельного ПИН-код.

### <a name="creating-constraints"></a>Создание ограничения

Средство конструктора iOS предлагает два типа элементов управления для управления элементами в области конструктора. *Перетаскивание элементов управления* и *интервал ПИН-код элементов управления*, как показано на следующем рисунке:

![элементы управления представления](designer-auto-layout-images/controls.png)

Они переключаются, нажав кнопку режим ограничения в строке ограничения.

Определите 4 T-образный дескрипторы каждой стороны элемента *верхней*, *правой*, *нижней*, и *левой* краями элемента для ограничение. Я форме маркеры справа и внизу элемента определяют *высота* и *ширины* ограничение соответственно. Средний квадрат обрабатывает оба *centerX* и *centerY* ограничения.

Чтобы создать ограничение, выберите маркер и перетащите его где-то в области конструктора. При запуске перетаскивания, ряд зеленые линии или прямоугольники будут отображаться в области, о том, что вы можете ограничить. Например в нашем примере мы ограничиваемого верхней части средней кнопки:

 [![](designer-auto-layout-images/image07.png "Ограничение в верхней части средней кнопки")](designer-auto-layout-images/image07.png#lightbox)

Обратите внимание три пунктирные линии зеленый через две другие кнопки. Зеленые линии обозначают *областей*, или других элементов, к которым можно ограничить атрибуты. На снимке экрана выше, две другие кнопки предлагают 3 вертикальной областей ( *нижней*, *centerY*, *верхней*) для ограничения наши кнопки. Пунктирной зеленой линией в верхней части представления означает, что контроллер представления предлагает ограничение в верхней части представления, а сплошной зеленой рамкой означает, что контроллер представления предлагает ограничение ниже Верхняя направляющая макета.

> [!IMPORTANT]
> Направляющие разметки — это особые типы ограничения целевых объектов, которые позволяют создать верхней и нижней ограничения, которые учитывают наличие полос системы, например строки состояния или панели инструментов. Одним из основных применений является совместимость между iOS 6 и iOS 7 приложения с момента последней версии имеет представление контейнера, расположенного под строке состояния. Дополнительные сведения о Верхняя направляющая макета, см. [документации Apple](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/transitionguide/AppearanceCustomization.html#//apple_ref/doc/uid/TP40013174-CH15-SW2).



Следующих трех разделах представлена работа с различных типов ограничений.

### <a name="size-constraints"></a>Ограничения размера

С ограничениями размера - *высота* и *ширины* -можно двумя способами. Первый вариант — перетащите маркер, чтобы ограничить размер элемента соседа, в том случае, как показано в приведенном выше примере. Другой вариант — дважды щелкните маркер, чтобы создать ограничение self. Это позволяет указать значение постоянного размера, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/sizec.png "Перетащите маркер, чтобы ограничить размер элемента соседа, в том случае, как показано ниже")](designer-auto-layout-images/sizec.png#lightbox)

### <a name="center-constraints"></a>Ограничения Center

Квадратный маркер создаст *centerX* или *centerY* ограничение, в зависимости от контекста. Квадратный маркер перетаскивания работают и другие элементы предложить оба вертикальные и горизонтальные областей, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/centerc.png "Ограничения Center")](designer-auto-layout-images/centerc.png#lightbox)

При выборе вертикальная область, *centerY* создается ограничение. Если горизонтальная область, ограничение будет основываться на *centerX*.

### <a name="combinational-constraints"></a>Комбинированные ограничения

Чтобы создать выравнивания и размера ограничения проверки на равенство между двумя элементами, можно выбрать элементы из верхней части панели инструментов для указания — в порядке: выравнивание по горизонтали, выравнивание по вертикали и размер равенства, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image06.png "Комбинированные ограничения")](designer-auto-layout-images/image06.png#lightbox)

### <a name="visualizing-and-editing-constraints"></a>Визуализации и редактирования ограничения

При добавлении ограничения, он отображается в области конструктора как синяя линия при выборе элемента:

 [![](designer-auto-layout-images/image09.png "Визуализация ограничения")](designer-auto-layout-images/image09.png#lightbox)

Ограничение можно выбрать, щелкнув синяя линия и редактирования значений ограничений непосредственно на панели «Свойства». Кроме того щелкнув синяя линия приведет к появлению контекстном, которая позволяет изменять значения непосредственно в области конструктора:

 [![](designer-auto-layout-images/image08.png "Изменение ограничения")](designer-auto-layout-images/image08.png#lightbox)

## <a name="constraint-issues"></a>Проблемы ограничения

Несколько видов проблемы могут возникнуть при использовании ограничения:

-  **Конфликтующие ограничения** — это происходит, когда несколько ограничений принудительно элемента может содержать конфликтующие значения для атрибута, а ограничение обработчику не удалось согласовать их.
-  **Underconstrained элементы** — свойства элемента ("Расположение" + "размер") должен быть полностью охвачен от свой набор ограничений и внутренние размеры для ограничений был допустимым. Если эти значения являются неоднозначными, считается, что элемент быть underconstrained.
-  **Frame потери портативного компьютера** — это происходит, когда фрейма элемента и его набор ограничений определяют два разных итоговый прямоугольника.


В этом разделе описываются три перечисленных выше проблем и приведены сведения о том, как их обрабатывать.

### <a name="conflicting-constraints"></a>Конфликтующие ограничения

Конфликтующие ограничения помечаются красным цветом и иметь символ предупреждения. При наведении курсора на символы предупреждения можно открыть контекстном с информацией о конфликте:

 [![](designer-auto-layout-images/image11.png "Конфликтующие ограничения предупреждение")](designer-auto-layout-images/image11.png#lightbox)

### <a name="underconstrained-items"></a>Underconstrained элементов

Underconstrained элементы выделены оранжевым цветом и активировать внешний вид значка оранжевый маркера в строке объекта контроллера представления:

 [![](designer-auto-layout-images/image02.png "Underconstrained элементы отображаются оранжевым цветом")](designer-auto-layout-images/image02.png#lightbox)

Если щелкнуть этот значок маркера можно получить сведения о underconstrained элементы в сцене и решить проблемы, либо полностью ограничение их, или удалив их ограничения, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image10.png "Исправление Underconstrained элементов")](designer-auto-layout-images/image10.png#lightbox)

### <a name="frame-misplacement"></a>Кадр потери портативного компьютера

Потери портативного компьютера кадров использует один и тот же код цвета underconstrained элементами. Элемент всегда отображается в рабочей области с помощью его фрейм машинного кода, но в случае потери портативного компьютера кадра красный прямоугольник помечает где элемента будет в итоге при запуске приложения, как показано на снимке экрана ниже:

 [![](designer-auto-layout-images/image05.png "Пример представления кадра потери портативного компьютера")](designer-auto-layout-images/image05.png#lightbox)

Для устранения ошибок потери портативного компьютера кадров выберите **обновления кадры на основе ограничений** кнопки на панели инструментов ограничений (правой кнопки):

 [![](designer-auto-layout-images/image03.png "Обновить кадры, в зависимости от ограничений кнопки панели инструментов")](designer-auto-layout-images/image03.png#lightbox)

Это автоматически настроит фрейма элемента в соответствии с позициях, определенных в элементах управления.

<a name="modifying-in-code" />

## <a name="modifying-constraints-in-code"></a>Изменение ограничений в коде

Зависимости от требований вашего приложения, возможны ситуации при необходимости изменить ограничение в коде. Например чтобы изменить размер или положение представления ограничение, чтобы изменить приоритет ограничения или полностью отключить ограничение.

Для доступа к ограничение в коде, сначала необходимо предоставить его в конструкторе iOS следующим образом:

1. Создайте ограничение в обычном режиме (с помощью любого из перечисленных выше методов).
2. В **обозреватель документов структуры**, найти нужное ограничение и выберите его:

    [![](designer-auto-layout-images/modify01.png "Окно структуры документа")](designer-auto-layout-images/modify01.png#lightbox)
3. Затем назначить **имя** ограничения в **мини-приложение** вкладке **обозревателе свойств**:

    [![](designer-auto-layout-images/modify02.png "На вкладке мини-приложения")](designer-auto-layout-images/modify02.png#lightbox)
4. Сохраните изменения.

С помощью изменения на месте можно использовать ограничение в коде и изменять его свойства. Например можно использовать следующие задать высоту вложенные представления до нуля:

```csharp
ViewInfoHeight.Constant = 0;
```

Рассмотрим следующий параметр для ограничения в конструкторе iOS:

[![](designer-auto-layout-images/modify03.png "Изменение ограничения на обозреватель свойств")](designer-auto-layout-images/modify03.png#lightbox)

### <a name="the-deferred-layout-pass"></a>Отложенное прохода макета

Вместо мгновенно обновления вложенные представления в ответ на изменения ограничения, обработчик макетов автоматически планирует _прохода макета отложенный_ в ближайшем будущем. Во время этого этапа отложенного не только — ограничение, заданное представление обновлены, ограничения, каждого представления в иерархии будут пересчитаны и обновлены с учетом нового макета.

В любой момент вы можете запланировать собственные прохода макета отложенный путем вызова `SetNeedsLayout` или `SetNeedsUpdateConstraints` методы родительского представления. 

Проход разметки отложенный состоит из двух уникальных проходит через иерархию представлений:

- **На проход обновления** -в течение этого прохода обработчик макетов автоматически проходит через иерархию представлений и вызывает `UpdateViewConstraints` метод на все контроллеры представлений и `UpdateConstraints` метод для всех представлений.
- **Проход разметки** — опять же, обработчик макетов автоматически проходит через иерархию представлений, но этот раз вызывает `ViewWillLayoutSubviews` метод на все контроллеры представлений и `LayoutSubviews` метод для всех представлений. `LayoutSubviews` Метод обновляет `Frame` свойства каждого вложенное представление с прямоугольником, вычисляются механизмом формирования структуры автоматически.

### <a name="animating-constraint-changes"></a>Анимация изменения ограничения

Помимо изменения свойств ограничения, можно использовать базовой анимации для анимации изменения представления ограничений. Пример:

```csharp
UIView.BeginAnimations("OpenInfo");
UIView.SetAnimationDuration(1.0f);
ViewInfoHeight.Constant = 237;
View.LayoutIfNeeded();

//Execute Animation
UIView.CommitAnimations();
```

Основная идея вызывает `LayoutIfNeeded` метод родительского представления внутри блока анимации. Это указывает представлению для рисования каждого «frame» анимированных расположение или изменения размера. Без этой строки представление будет просто прикрепляются к окончательной версии без анимации.

## <a name="summary"></a>Сводка

Это руководство содержит общие iOS Auto (или «adaptive») макет и концепция ограничения как математические представления связей между элементами в области конструктора. Оно было описано, как включить автоматический макет в конструкторе iOS, работа с **панель инструментов ограничений**и изменение ограничений по отдельности в рабочей области конструирования. Затем он было рассмотрено, как устранить три распространенные неполадки, ограничения. Наконец показал, как изменить ограничения в коде.

## <a name="related-links"></a>Связанные ссылки

- [Введение в раскадровку](~/ios/user-interface/storyboards/index.md)
- [Проектирование Пошаговое руководство элементы управления iOS](~/ios/user-interface/designer/ios-designable-controls-walkthrough.md)
- [Общие сведения о конструкторе Android](~/android/user-interface/android-designer/index.md)
- [Программные ограничения](~/ios/user-interface/programmatic-layout-constraints.md)
- [Apple - направляющая макета Auto](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/AutolayoutPG/Introduction/Introduction.html#/apple_ref/doc/uid/TP40010853-CH13-SW1)
