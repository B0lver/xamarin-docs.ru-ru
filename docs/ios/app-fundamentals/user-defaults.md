---
title: "Работа со значениями по умолчанию пользователя"
description: "В этой статье рассматривается работа с NSUserDefault, чтобы сохранить параметры по умолчанию в Xamarin iOS приложения или расширения."
ms.topic: article
ms.prod: xamarin
ms.assetid: DAE7FFC4-B8C9-4D9E-886A-9B2388452EEB
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 06/07/2016
ms.openlocfilehash: 73f3beb87fffcb37ef3e36d54f634c3bc62da538
ms.sourcegitcommit: 73bd0c7e5f237f0a1be70a6c1384309bb26609d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2018
---
# <a name="working-with-user-defaults"></a>Работа со значениями по умолчанию пользователя

_В этой статье рассматривается работа с NSUserDefault, чтобы сохранить параметры по умолчанию приложения Xamarin.iOS или расширении._


`NSUserDefaults` Класс предоставляет способ для операций ввода-вывода приложения и расширения для программного взаимодействия с системой всей системы по умолчанию. С помощью системы по умолчанию, пользователь может настроить поведение приложения или стиля в соответствии с их предпочтениями (с учетом разработки приложения). Например, чтобы представить данные в vs метрики Имперский измерения или выберите тему данного пользовательского интерфейса.

При использовании групп приложений, `NSUserDefaults` также предоставляет способ для обмена данными между приложениями (или расширения) из данной группы.

<a name="About-User-Defaults" />

## <a name="about-user-defaults"></a>О пользовательские параметры по умолчанию

Как упоминалось выше, пользователь по умолчанию (`NSUserDefaults`) можно добавлять в приложение (или расширения) и используется для предоставления настраиваемых параметров, которые конечный пользователь может изменять для настройки внешнего вида или операции во время выполнения приложения.

Если приложение сначала выполняется, `NSUserDefaults` считывает ключи и значения из базы данных приложения пользователя по умолчанию и кэширует их в памяти, чтобы избежать открытия и чтения базы данных каждый раз, значение является обязательным. 

> [!IMPORTANT]
> Apple больше не рекомендует вызова разработчика `Synchronize` метод для синхронизации кэша в памяти с базой данных напрямую. Вместо этого он будет автоматически вызван с периодическими интервалами для синхронизации с базой данных пользователя по умолчанию кэш в памяти.

`NSUserDefaults` Класс содержит несколько удобных методов для чтения и записи значений привилегированных для основных типов данных, таких как: строка, целое число, число с плавающей запятой, boolean и URL-адреса. Другие типы данных можно архивировать с помощью `NSData`, затем считывается или записывается в базу данных пользователей по умолчанию. Дополнительные сведения см. в разделе Apple [предпочтений и руководство по программированию на параметры](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i).

<a name="Accessing-the-Shared-NSUserDefaults-Instance" />

## <a name="accessing-the-shared-nsuserdefaults-instance"></a>Доступ к экземпляру общего NSUserDefaults 

Экземпляр по умолчанию общие пользователя предоставляет доступ к пользователя по умолчанию для текущего пользователя устройства. Если объект Общие параметры по умолчанию не существует, он создается первый раз доступ и инициализирован со следующими сведениями:

- `NSArgumentDomain` Состоящий из значения по умолчанию, извлеченными из текущего приложения.
- Домен приложения, введите идентификатор пакета.
- `NSGlobalDomain` Состоящий из значения по умолчанию, общие для всех приложений.
- Отдельный домен для каждого из языков предпочтительный для пользователя.
- `NSRegistrationDomain` С набором временные значения по умолчанию, которые могут быть изменены в приложении, чтобы обеспечить поисков всегда выполняются успешно.

Для доступа к экземпляру Общие параметры по умолчанию пользователя, используйте следующий код:

```csharp
// Get Shared User Defaults
var plist = NSUserDefaults.StandardUserDefaults;
```

<a name="Accessing-an-App-Group-NSUserDefaults-Instance" />

## <a name="accessing-an-app-group-nsuserdefaults-instance"></a>Доступ к экземпляру NSUserDefaults группы приложений

Как упоминалось выше, с помощью групп приложений, `NSUserDefaults` может использоваться для обмена данными между приложениями (или расширения) из данной группы. Во-первых, необходимо убедиться, что имя группы приложения и необходимые идентификаторы приложений должным образом настроены в **сертификатов, профили & идентификаторы** статьи на [центра разработки iOS](https://developer.apple.com/devcenter/ios/) и были установлены в среде разработки.

Далее приложение и/или расширение проектов необходимо иметь одно из допустимых идентификаторов приложений, созданных ранее и `Entitlements.plist` файл имеет должны быть включены в пакет приложения с группами приложение включен и указан.

С все это на месте Общие приложения группа пользователя по умолчанию может осуществляться с использованием следующий код:

```csharp
// Get App Group User Defaults
var plist = new NSUserDefaults ("group.com.xamarin.todaysharing", NSUserDefaultsType.SuiteName);
```

Где `group.com.xamarin.todaysharing` группы приложения создается в **сертификатов, профили & идентификаторы** , необходимо получить доступ. Дополнительные сведения см. в разделе [возможности группами приложений](~/ios/deploy-test/provisioning/capabilities/app-groups-capabilities.md) документации.

<a name="Reading-Default-Values" />

## <a name="reading-default-values"></a>Чтение значений по умолчанию

После запуска необходимую базу данных пользователя по умолчанию, могут считывать значения из значения по умолчанию, с помощью пары «ключ-значение» и несколько удобных методов, в зависимости от типа данных, считываемых:

- `ArrayForKey` — Возвращает массив `NSObjects` для данного значения ключа.
- `BoolForKey` — Возвращает логическое значение для указанного ключа.
- `DataForKey` — Возвращает `NSData` объекта для указанного ключа.
- `DictionaryForKey` — Возвращает `NSDictionary` для указанного ключа.
- `DoubleForKey` — Возвращает значение типа double для указанного ключа.
- `FloatForKey` — Возвращает значение с плавающей запятой для указанного ключа.
- `IntForKey` — Возвращает целочисленное значение для указанного ключа.
- `StringArrayForKey` — Возвращает массив `String` объекты из заданного значения ключа.
- `StringForKey` — Возвращает строковое значение для указанного ключа.
- `URLForKey` — Возвращает `NSUrl` значение для указанного ключа.

Например следующий код будет читать логическое значение из пользователя по умолчанию:

```csharp
// Get Shared User Defaults
var plist = NSUserDefaults.StandardUserDefaults;
...

// Get value
var useHeader = plist.BoolForKey("UseHeader");

```

<a name="Writing-Default-Values" />

## <a name="writing-default-values"></a>Запись значений по умолчанию

Так же как при чтении значений, приведенных выше, после запуска нужного пользователя по умолчанию базы данных, можно написать значения по умолчанию, используя пары «ключ-значение» и несколько удобных методов, на основе типа записываемых данных:

- `SetBool` -Записывает заданное логическое значение для указанного ключа.
- `SetDouble` -Записывает заданное значение типа double с заданным ключом.
- `SetFloat` -Записывает значение заданного типа float с заданным ключом.
- `SetString` -Записывает заданную строку значение с заданным ключом.
- `SetURL` -Записывает заданный URL-адрес (`NSUrl`) значение с заданным ключом.

Например следующий код написать логическое значение для пользователя по умолчанию:

```csharp
// Get Shared User Defaults
var plist = NSUserDefaults.StandardUserDefaults;
...

// Save value
plist.SetBool(useHeader, "UseHeader");
...

```

> [!IMPORTANT]
> Если приложение сначала выполняется, `NSUserDefaults` считывает ключи и значения из базы данных приложения пользователя по умолчанию и кэширует их в памяти, чтобы избежать открытия и чтения базы данных каждый раз, значение является обязательным.



<a name="Summary" />

## <a name="summary"></a>Сводка

В этой статье был проиллюстрирован `NSUserDefaults` класс и как он может использоваться для предоставления набора параметров, которые конечный пользователь можно использовать для настройки приложения Xamarin.iOS. Кроме того он рассматривается использование групп приложений для обмена данными между расширения и его родительского приложения или приложения в группе.


## <a name="related-links"></a>Связанные ссылки

- [Примеры tvOS](https://developer.xamarin.com/samples/tvos/all/)
- [Параметры системы и руководство по программированию](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i)
- [NSUserDefaults](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/#//apple_ref/doc/constant_group/NSUserDefaults_Domains)
