---
title: Работа с локализацией watchOS в Xamarin
description: В этом документе описывается локализация приложений watchOS, созданных с помощью Xamarin. В нем рассматриваются приложения для наблюдения, расширения, строки в коде, текст раскадровки, тестирование и многое другое.
ms.prod: xamarin
ms.assetid: 55834877-757B-4860-AF2F-933A948BE38D
ms.technology: xamarin-ios
author: davidortinau
ms.author: daortin
ms.date: 03/17/2017
ms.openlocfilehash: 82b739697705ac4c90390a36405d755a5f523159
ms.sourcegitcommit: 2fbe4932a319af4ebc829f65eb1fb1816ba305d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73028406"
---
# <a name="working-with-watchos-localization-in-xamarin"></a>Работа с локализацией watchOS в Xamarin

_Адаптация приложений watchOS для нескольких языков_

![](localization-images/both-languages-sml.png "Apple Watch displaying localized content")

watchOS приложения локализованы с помощью стандартных методов iOS:

- Использование **идентификатора локализации** для элементов раскадровки
- файлы **. strings** , связанные с раскадровкой, и
- **Локализуемые файлы. strings** для текста, используемого в коде.

Раскадровки и ресурсы по умолчанию расположены в **базовом** каталоге, а переводы для конкретного языка и другие ресурсы хранятся в каталогах **. лпрож** .
ОС iOS и Watch будут автоматически использовать выбор языка пользователя для загрузки правильных строк и ресурсов.

Так как у приложения Apple Watch есть два компонента — контрольное приложение и Просмотр локализованных строковых ресурсов требуются в двух местах в зависимости от того, как они используются.

Локализованные текст и ресурсы будут *отличаться* в приложении Watch и в расширении Watch.

## <a name="watch-app"></a>Просмотреть приложение

Приложение Watch содержит раскадровку, описывающую пользовательский интерфейс приложения. Все элементы управления (такие как `Label` и `Image`), поддерживающие локализацию, имеют **идентификатор локализации**.

Каждый зависящий от языка каталог **. лпрож** должен содержать **строковые** файлы с переводами для каждого элемента (с использованием **идентификатора локализации**), а также изображения, на которые ссылается раскадровка.

## <a name="watch-extension"></a>Просмотр расширения

Расширение контрольных значений — это место выполнения кода приложения. Любой текст, отображаемый пользователю в коде, должен быть локализован в расширении, а не в приложении для просмотра.

Расширение также должно содержать зависящие от языка каталоги **лпрож** , но для файлов **. strings** требуются только переводы для текста, используемого в коде.

## <a name="globalizing-the-watch-solution"></a>Глобализация решения контрольных значений

Глобализация — это процесс локализации приложения.
Для просмотра приложений это означает разработку раскадровки с разными длинами текста, обеспечивая правильную настройку каждого макета экрана в зависимости от отображаемого текста. Также необходимо убедиться, что все строки, на которые имеются ссылки в коде расширения, можно преобразовать с помощью метода `LocalizedString`.

### <a name="watch-app"></a>Просмотреть приложение

По умолчанию приложение Watch не настроено для локализации. Необходимо переместить файл раскадровки по умолчанию и создать другие каталоги для переводов:

1. Создайте каталог **base. лпрож** и переместите в него **интерфейс. Storyboard** .

2. Создайте каталоги **\<language >. лпрож** для каждого языка, который вы хотите поддерживать.

3. Каталоги **. лпрож** должны содержать текстовый файл **Interface. strings** (имя файла должно совпадать с именем сторбоард). При необходимости можно разместить все образы, требующие локализации, в этих каталогах.

Проект контрольного приложения выглядит следующим образом после внесения этих изменений (добавлены только файлы на английском и испанском языках):

  ![](localization-images/watchapp-solution.png "The watch app project with English and Spanish language files")

#### <a name="storyboard-text"></a>Текст раскадровки

При редактировании раскадровки выберите каждый элемент и обратите внимание на **идентификатор локализации** , который отображается на панели « **свойства** »:

  [![](localization-images/storyboard-sml.png "The Localization ID that appears in the Properties pad")](localization-images/storyboard.png#lightbox)

В папке **base. лпрож** создайте пары "ключ-значение", как показано ниже, где ключ формируется **идентификатором локализации** и именем свойства в элементе управления, присоединенным точкой (`.`).

```csharp
"AgC-eL-Hgc.title" = "WatchL10nEN"; // interface controller title
"0.text" = "Welcome to WatchL10n"; // Welcome
"1.text" = "Language settings are in Apple Watch App"; // How to change language
"2.title" = "Greetings"; // Greeting
"6.title" = "Detail";
"39.text" = "Second screen";
```

Обратите внимание, что в этом примере **идентификатор локализации** может быть простой числовой строкой (например, "0", "1" и т. д. или более сложная строка (например, "АГК-eL-ХГК"). `Label` элементы управления имеют свойство `Text`, а `Button`s имеют свойство `Title`, которое отражается в способе установки их локализованных значений. обязательно используйте имя свойства в нижнем регистре, как показано в примере выше.

При подготовке раскадровки к просмотру правильные значения будут автоматически извлечены и отображены в соответствии с языком, выбранным пользователем.

#### <a name="storyboard-images"></a>Изображения раскадровки

Пример решения также включает образ **gradient@2x.png** в каждую папку языка. Этот образ может различаться для каждого языка (например, Он может содержать внедренный текст, который требуется перевести, или использовать локализованный иконографи).

Просто **установите свойство изображения изображения в** раскадровке, и правильное изображение будет отображаться в контрольных значениях в соответствии с языком, выбранным пользователем.

![](localization-images/storyboard-image.png "Set the images Image property in the storyboard")

Примечание. так как на всех контрольных значениях Apple отображаются Retina, требуется только версия образа **@2x** . В раскадровке не нужно указывать **@2x** .

### <a name="watch-extension"></a>Просмотр расширения

Для расширения контрольных значений требуется аналогичная структура каталогов для поддержки локализации, однако раскадровка отсутствует. Локализованные строки в расширении — это только те, на C# которые ссылается код.

![](localization-images/watchextension-solution.png "The watch extension directory structure to support localization")

#### <a name="strings-in-code"></a>Строки в коде

Файл **Localizable. strings** имеет немного другую структуру, чем если бы он был связан с раскадровкой. В этом случае можно выбрать любую строку Key. Рекомендуется использовать ключ, отражающий фактический текст, который будет отображаться на языке по умолчанию:

```csharp
"Breakfast time" = "Breakfast time!"; // morning
"Lunch time" = "Lunch time!"; // midday
"Dinner time" = "Dinner time!"; // evening
"Bed time" = "Bed time!"; // night
```

Метод `NSBundle.MainBundle.LocalizedString` используется для разрешения строк в преобразованных аналогах, как показано в приведенном ниже коде.

```csharp
var display = "Breakfast time";
var localizedDisplay =
  NSBundle.MainBundle.LocalizedString (display, comment:"greeting");
displayText.SetText (localizedDisplay);
```

#### <a name="images-in-code"></a>Изображения в коде

Образы, заполняемые кодом, можно задать двумя способами.

1. Можно изменить элемент управления `Image`, указав в качестве его значения строковое имя изображения, которое уже существует в приложении Watch, например

    ```csharp
    displayImage.SetImage("gradient"); // image in Watch App (as shown above)
    ```

2. Вы можете переместить изображение из расширения в контрольное значение с помощью `FromBundle` и приложение автоматически выберет правильный образ для выбора языка пользователя. В примере решения в каждой папке языка **language@2x.png** изображение, которое отображается на `DetailController` с помощью следующего кода:

    ```csharp
    using (var image = UIImage.FromBundle ("language")) {
        displayImage.SetImage (image);
    }
    ```

    Обратите внимание, что не нужно указывать **@2x** при ссылке на имя файла образа.

Второй метод также применим, если вы скачиваете образ с удаленного сервера для подготовки к просмотру. Однако в этом случае следует убедиться, что загружаемый образ правильно локализован в соответствии с предпочтениями пользователя.

## <a name="localization"></a>Локализация

После настройки решения переводчикам потребуется обработать файлы **. strings** и изображения для каждого языка, который вы хотите поддерживать.

Можно создать столько **лпрож** каталогов, сколько требуется (по одному для каждого поддерживаемого языка). Они именуются с помощью кодов языка, таких как **EN**, **ES**, **de**, **ja**, **pt-br**и т. д. (для английского, испанского, немецкого, японского и португальского (Бразилия) соответственно).

В присоединенном примере используются (созданные компьютером) переводы, демонстрирующие локализацию приложения watchOS.

### <a name="watch-app"></a>Просмотреть приложение

Эти значения используются для преобразования пользовательского интерфейса, определенного в раскадровке приложения Watch. Значение *ключа* представляет собой сочетание **идентификатора локализации** каждого элемента управления раскадровки и преобразуемого свойства.

Рекомендуется добавлять комментарии, содержащие исходный текст, в файл, чтобы переводчики знали, что должно быть переводом.

#### <a name="eslprojinterfacestrings"></a>ES. лпрож/Interface. strings

Ниже показаны строки испанского языка для раскадровки (машинного перевода). Рекомендуется добавлять комментарии к каждой строке, поскольку трудно понять, на что ссылается **идентификатор локализации** , в противном случае:

```csharp
"AgC-eL-Hgc.title" = "Spanish"; // app screen heading
"0.text" = "Bienvenido a WatchL10n"; // Welcome to WatchL10n
"1.text" = "Ajustes de idioma están en Apple Watch App"; // Change the language in the Apple Watch App
"2.title" = "Saludos"; // Greetings
"6.title" = "2nd"; // second screen heading
"39.text" = "Segunda pantalla"; // second screen
```

### <a name="watch-extension"></a>Просмотр расширения

Эти значения используются в коде для преобразования сведений перед их отображением пользователю. *Ключ* выбирается разработчиком при написании кода и обычно содержит строку, подводимую для перевода.

#### <a name="eslprojlocalizablestrings-file"></a>файл ES. лпрож/локализуемый. strings

Строки языка Спансиш (машинного перевода):

```csharp
"Breakfast time" = "la hora del desayuno"; // morning
"Lunch time" = "hora de comer"; // midday
"Dinner time" = "hora de la cena"; // evening
"Bed time" = "la hora de dormir"; // night
```

## <a name="testing"></a>Тестирование

Метод изменения языковых настроек отличается между симулятором и физическими устройствами.

### <a name="simulator"></a>Имитатор

В симуляторе выберите язык для тестирования с помощью приложения " **Параметры** iOS" (значок "серые шестеренки" на начальном экране имитатора).

  ![](localization-images/sim-settings-sml.png "The iOS Settings app Localization settings")

### <a name="watch-device"></a>Просмотр устройства

При тестировании с контрольными данными измените язык контрольных значений в приложении **Apple Watch** на связанном устройстве iPhone.

  ![](localization-images/phone-settings-sml.png "Change the watch's language in the Apple Watch app on the paired iPhone")

## <a name="related-links"></a>Связанные ссылки

- [Ватчлокализатион (пример)](https://developer.xamarin.com//samples/monotouch/watchOS/WatchLocalization/)
