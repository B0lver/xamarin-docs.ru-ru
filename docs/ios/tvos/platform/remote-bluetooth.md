---
title: Контроллеры Siri Remote и контроллеры Bluetooth для tvOS в Xamarin
description: В этой статье описывается работа с контроллеры Siri Remote и игровые устройства Bluetooth в tvOS приложений, написанных с помощью Xamarin.
ms.prod: xamarin
ms.assetid: BDB9894A-236B-424B-9032-ACD12A6C5720
ms.technology: xamarin-ios
author: lobrien
ms.author: laobri
ms.date: 03/16/2017
ms.openlocfilehash: 79022f7a454ea423fa3112a4c4ade2bcd471fbb8
ms.sourcegitcommit: 946ce514fd6575aa6b93ff24181e02a60b24b106
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2019
ms.locfileid: "58677954"
---
# <a name="siri-remote-and-bluetooth-controllers-for-tvos-in-xamarin"></a>Контроллеры Siri Remote и контроллеры Bluetooth для tvOS в Xamarin

Пользователей приложения Xamarin.tvOS не взаимодействует с его интерфейсом непосредственно как с помощью iOS где они коснитесь изображения на экране устройства, но косвенно из в комнате с помощью [Siri Remote](#The-Siri-Remote).

Если ваше приложение — это игра, можно при необходимости построить поддержка третьей стороной, внесенные для iOS (MFI) [игровые устройства Bluetooth](#Bluetooth-Game-Controllers) в приложении также.

[![](remote-bluetooth-images/intro01.png "Удаленное Bluetooth и игровой контроллер")](remote-bluetooth-images/intro01.png#lightbox)

В этой статье описывается [Siri Remote](#The-Siri-Remote), [жесты касания поверхности](#Touch-Surface-Gestures) и [удаленного кнопки Siri](#Siri-Remote-Buttons) и показано, как работать с ними с помощью [жестов и Раскадровки](#Gestures-and-Storyboards), [жестов и код](#Gestures-and-Code) и [событие нижнего уровня обработки](#Low-Level-Event-Handling). Наконец, в нем описывается [работа с игровые](#Working-with-Game-Controllers) в приложении Xamarin.tvOS.

<a name="The-Siri-Remote" />

## <a name="the-siri-remote"></a>Удаленный Siri

Основным способом, который пользователи будут взаимодействовать с Apple TV и приложение Xamarin.tvOS – включить Siri Remote. Apple разработан удаленного мост расстояние между пользователем на диване и большом Apple пользовательский интерфейс, отображаемый на экран ТВ места.

Ваша задача как разработчик приложения tvOS состоит создать быстрый, простой в использовании и визуально привлекательные пользовательский интерфейс, который использует Siri Remote сенсорной поверхностью, акселерометр, гироскоп и кнопки.

[![](remote-bluetooth-images/remote01.png "Удаленный Siri")](remote-bluetooth-images/remote01.png#lightbox)

Siri Remote имеет следующие функции и ожидаемого использования в приложениях и tvOS.

|Функция|Использование общих приложений|Игры использования приложения|
|---|---|---|
|**Сенсорной поверхностью**<br />Проведите по экрану, чтобы перейти, нажмите кнопку, чтобы выбрать и удерживайте контекстных меню.|**TAP/проведите по экрану**<br />Навигация по пользовательскому Интерфейсу между элементами, способному получать фокус.<br /><br />**Нажмите кнопку**<br />Активация выбранного элемента (с фокусом).|**TAP/проведите по экрану**<br />Зависит от разработки игр и может использоваться как D-панель, коснувшись краев.<br /><br />**Нажмите кнопку**<br />Выполните функцию основную кнопку.|
|**Menu**<br />Нажмите, чтобы вернуться к предыдущему экрану или меню.|Возвращает к предыдущему экрану и завершает работу для Apple TV начального экрана на экране основного приложения.|Приостановка и возобновление игровой процесс, возврат к предыдущему экрану и завершает работу для Apple TV начального экрана, на экране основного приложения.|
|**Siri и поиск**<br />В странах с Siri нажмите и удерживайте для управление голосовой связью, в других стран, отображает экран поиска.|Н/Д|Н/Д|
|**Воспроизведение/пауза**<br />Воспроизведения, паузы и предоставляет дополнительной функции в приложениях.|Начинает воспроизведение мультимедиа и кнопки приостановки и возобновления воспроизведения.|Выполняет функцию дополнительную кнопку или пропускает ознакомительный видеоролик (если существует).|
|**Корневая папка**<br />Нажмите, чтобы вернуться на начальном экране, дважды щелкните, чтобы отобразить работающие приложения нажмите и удерживайте в спящий режим устройства.|Н/Д|Н/Д|
|**Тома**<br />Элементы управления подключенный том аудио видео оборудования.|Н/Д|Н/Д|

<a name="Touch-Surface-Gestures" />

## <a name="touch-surface-gestures"></a>Сенсорные жесты поверхности

Поверхность Touch Siri Remote — это возможность обнаруживать широкий набор жестов касания одним пальцем, которые можно реагировать в приложении Xamarin.tvOS:

|Проведите по экрану|Нажмите кнопку|Коснитесь|
|---|---|---|
|![](remote-bluetooth-images/Gesture01.png)|![](remote-bluetooth-images/Gesture02.png)|![](remote-bluetooth-images/Gesture03.png)|
|Перемещает выделение (фокус) между элементами пользовательского интерфейса на экране (вверх, вниз влево, вправо). Проведение пальцем по экрану можно выполнять прокрутку больших списках содержимого, быстро с помощью инерции.|Активирует выбранного элемента (с фокусом) или выступает в качестве основную кнопку в игре. Нажав и удерживая можно активировать контекстных меню или вторичного функции.|В незначительной степени коснувшись области Touch по краям действует как направления кнопки на перемещение фокуса вверх, вниз, влево или вправо, в зависимости от области касание D панели. В зависимости от приложения можно использовать для отображения скрытых элементов управления.|

Компания Apple предоставляет следующие рекомендации по работе с помощью жестов касания поверхности:

* **Различение щелчков и касания** -щелкнув является намеренное действие пользователя и хорошо подходит для выбора, активации и основная кнопка игры. Просмотреть, выбрав более тонкий и следует использовать с осторожностью, так как пользователь часто удерживает удаленного Siri в свои руки и случайно могут активировать события касания легко.
* **Не переопределить стандартные жесты** -исходя из предположения, что определенных жестов будет выполнять конкретные действия, у пользователя не должно переопределить значение функции и функции эти жесты в вашем приложении. Единственным исключением является игровое приложение во время активного игровой процесс.
* **Определяют новые жесты только в случае необходимости** — опять-таки исходя из предположения, что определенных жестов будет выполнять определенные действия пользователя. Следует избегать, определение пользовательских жестов для выполнения стандартных действий. И опять же, игры являются наиболее частая исключением где пользовательских жестов можно добавить весело, обеспечивающее эффект присутствия play к игре.
* **При необходимости отвечать на панели D касается** — Lightly при касании в углу края поверхности Touch будет реагировать как D-панели на перемещение фокуса игровой контроллер или направление вверх, вниз, влево или правой кнопкой мыши. При необходимости получить ответ на эти жесты в своих приложений или игр.

<a name="Siri-Remote-Buttons" />

## <a name="siri-remote-buttons"></a>Siri Remote кнопок

В дополнение к жесты на поверхности Touch приложение может отвечать на пользователя щелчке рабочей области Touch или нажать кнопку "Воспроизведение/Пауза". При доступе к Siri удаленного доступа с помощью платформы контроллера игры, можно также определить на нажатие кнопки меню. 

Кроме того, при нажатии кнопки меню могут быть обнаружены с помощью распознавателя жестов стандарту `UIKit` элементов. Если вы перехват на нажатие кнопки меню, которую вы ответственность за закрытие текущего представления и представления контроллера и вернуться к предыдущему.

> [!IMPORTANT]
> Вы должны **всегда** установить функцию кнопки воспроизведения, паузы на удаленном сервере. Наличие нефункциональные кнопки позволяет сделать приложения найдите неработающий для конечного пользователя. Если у вас нет допустимой функцией для данной кнопки, следует назначьте ту же функцию в качестве основной (Touch щелкните область).

<a name="Gestures-and-Storyboards" />

## <a name="gestures-and-storyboards"></a>Жесты и раскадровки

Самый простой способ работы с удаленной Siri в приложении Xamarin.tvOS является добавление распознавателей жестов для представления в конструкторе интерфейса.

Чтобы добавить распознаватель жестов, сделайте следующее:

1. В **обозревателе решений**, дважды щелкните `Main.storyboard` и откройте его для редактирования конструктора интерфейса.
2. Перетащите **коснитесь распознаватель жестов** из **библиотеки** и поместите его в представлении: 

    [![](remote-bluetooth-images/storyboard01.png "Распознаватель жестов касания")](remote-bluetooth-images/storyboard01.png#lightbox)
3. Проверьте **выберите** в **кнопку** раздел **инспекторе атрибутов**: 

    [![](remote-bluetooth-images/storyboard02.png "Проверьте Select")](remote-bluetooth-images/storyboard02.png#lightbox)
4. **Выберите** означает, что жест, будут отвечать на пользователем при нажатии **Touch поверхности** на удаленном Siri. Имеется также возможность реагирования на **меню**, **воспроизведение/пауза**, **вверх**, **вниз**, **слева** и **Справа** кнопки.
5. Затем подключите **действие** из **коснитесь распознаватель жестов** и назовите его `TouchSurfaceClicked`: 

    [![](remote-bluetooth-images/storyboard03.png "Действие из средства распознавания Tap")](remote-bluetooth-images/storyboard03.png#lightbox)
6. Сохраните изменения и вернуться в Visual Studio для Mac.

Изменение контроллера представления (пример `FirstViewController.cs`) и добавьте следующий код для обработки жест активации:

```csharp
using System;
using UIKit;

namespace tvRemote
{
    public partial class FirstViewController : UIViewController
    {
        ...

        #region Custom Actions
        partial void TouchSurfaceClicked (Foundation.NSObject sender) {
            // Handle click here
            ...
        }
        #endregion
    }
}
```

Дополнительные сведения о работе с раскадровками, см. в разделе наших [по Tvos краткое руководство по](~/ios/tvos/get-started/hello-tvos.md). В частности [Создание пользовательского интерфейса](~/ios/tvos/get-started/hello-tvos.md#Creating-the-User-Interface) и [написания кода с помощью переменных экземпляров и действий](~/ios/tvos/get-started/hello-tvos.md#Writing-the-Code) разделы.

<a name="Gestures-and-Code" />

## <a name="gestures-and-code"></a>Жестов и кода

При необходимости можно создать жесты непосредственно в C# код и добавить их к представлениям в пользовательском интерфейсе. Например чтобы добавить ряд распознавателей жестов проведите по экрану, изменить контроллер представления и добавьте следующий код:

```csharp
using System;
using UIKit;

namespace tvRemote
{
    public partial class SecondViewController : UIViewController
    {
        #region Constructors
        public SecondViewController (IntPtr handle) : base (handle)
        {
        }
        #endregion

        #region Override Methods
        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();    

            // Wire-up gestures
            var upGesture = new UISwipeGestureRecognizer (() => {
                RemoteView.ArrowPressed = "Up";
                ButtonLabel.Text = "Swiped Up";
            }) {
                Direction = UISwipeGestureRecognizerDirection.Up
            };
            this.View.AddGestureRecognizer (upGesture);

            var downGesture = new UISwipeGestureRecognizer (() => {
                RemoteView.ArrowPressed = "Down";
                ButtonLabel.Text = "Swiped Down";
            }) {
                Direction = UISwipeGestureRecognizerDirection.Down
            };
            this.View.AddGestureRecognizer (downGesture);

            var leftGesture = new UISwipeGestureRecognizer (() => {
                RemoteView.ArrowPressed = "Left";
                ButtonLabel.Text = "Swiped Left";
            }) {
                Direction = UISwipeGestureRecognizerDirection.Left
            };
            this.View.AddGestureRecognizer (leftGesture);

            var rightGesture = new UISwipeGestureRecognizer (() => {
                RemoteView.ArrowPressed = "Right";
                ButtonLabel.Text = "Swiped Right";
            }) {
                Direction = UISwipeGestureRecognizerDirection.Right
            };
            this.View.AddGestureRecognizer (rightGesture);
        }
        #endregion
    }
}
```

<a name="Low-Level-Event-Handling" />

## <a name="low-level-event-handling"></a>Обработка событий нижнего уровня

Если вы создаете пользовательский тип, на основе `UIKit` в приложении Xamarin.tvOS (например `UIView`), у вас также есть возможность предоставления низкого уровня обработки при нажатии кнопки с помощью `UIPress` события. 

Объект `UIPress` событий представлен для tvOS `UITouch` событий — iOS, за исключением `UIPress` возвращает сведения о кнопке нажимает на удаленном Siri или другие подключенные устройства Bluetooth (например, контроллер игры). `UIPress` события описывают на нажатие кнопки и его состояние (Began, Canceled, измененные или завершено). 

Аналоговые кнопок на устройствах, таких как игровые устройства Bluetooth `UIPress` также возвращает объем принудительно применяется к кнопке. `Type` Свойство `UIPress` событие определяет, какие физические кнопка имеет измененное состояние, а остальные свойства описывают произошедшего изменения.

Следующий код является примером обработки низкоуровневых `UIPress` события для `UIView`:

```csharp
using System;
using Foundation;
using UIKit;

namespace tvRemote
{
    public partial class EventView : UIView
    {
        #region Computed Properties
        public override bool CanBecomeFocused {
            get {
                return true;
            }
        }
        #endregion

        #region 
        public EventView (IntPtr handle) : base (handle)
        {
        }
        #endregion

        #region Override Methods
        public override void PressesBegan (NSSet<UIPress> presses, UIPressesEvent evt)
        {
            base.PressesBegan (presses, evt);

            foreach (UIPress press in presses) {
                // Was the Touch Surface clicked?
                if (press.Type == UIPressType.Select) {
                    BackgroundColor = UIColor.Red;
                }
            }
        }

        public override void PressesCancelled (NSSet<UIPress> presses, UIPressesEvent evt)
        {
            base.PressesCancelled (presses, evt);

            foreach (UIPress press in presses) {
                // Was the Touch Surface clicked?
                if (press.Type == UIPressType.Select) {
                    BackgroundColor = UIColor.Clear;
                }
            }
        }

        public override void PressesChanged (NSSet<UIPress> presses, UIPressesEvent evt)
        {
            base.PressesChanged (presses, evt);
        }

        public override void PressesEnded (NSSet<UIPress> presses, UIPressesEvent evt)
        {
            base.PressesEnded (presses, evt);

            foreach (UIPress press in presses) {
                // Was the Touch Surface clicked?
                if (press.Type == UIPressType.Select) {
                    BackgroundColor = UIColor.Clear;
                }
            }
        }
        #endregion
    }
}
```

Как и в `UITouch` события, если необходимо реализовать любой из `UIPress` переопределения событий, следует реализовать все четыре.

<a name="Bluetooth-Game-Controllers" />

## <a name="bluetooth-game-controllers"></a>Игровые Bluetooth

В дополнение к стандартной удаленным Siri, который поставляется с Apple TV, третьих сторон, внесенные для iOS можно в паре с Apple TV игровые устройства Bluetooth (MFI) и использовать контролировать приложение Xamarin.tvOS.

[![](remote-bluetooth-images/game01.png "Игровые Bluetooth")](remote-bluetooth-images/game01.png#lightbox)

Игровые устройства управления можно использовать для улучшения игровой процесс и атмосферу погружения в игре. Они могут также использоваться для управления стандартный интерфейс Apple TV, так что использование не нужно переключаться между удаленного, так и контроллер.

> [!IMPORTANT]
> Игровые устройства Bluetooth — это необязательная Покупка, конечные пользователи могут сделать, приложение не может заставить пользователя приобрести. Если приложение поддерживает игровые устройства управления он должен также поддерживать удаленное Siri таким образом, игра готовый к применению всеми пользователями Apple TV.

Игра контроллер имеет следующие возможности и ожидаемого использования в приложениях и tvOS:

|Функция|Использование общих приложений|Игры использования приложения|
|---|---|---|
|**D-Pad**|Переходит к элементам пользовательского интерфейса (изменения фокуса).|Зависит от игры.|
|**A**|Активация выбранного элемента (с фокусом).|Выполняет функцию основную кнопку и подтверждает действий диалогового окна.|
|**B**|Возвращает к предыдущему экрану или завершает работу на начальном экране, если на главном экране приложения.|Выполняет функцию дополнительную кнопку или возвращает к предыдущему экрану.|
|**X**|Запуск воспроизведения мультимедиа или воспроизведение раз приостановлен и возобновлен.|Зависит от игры.|
|**Y**|Н/Д|Зависит от игры.|
|**Menu**|Возвращает к предыдущему экрану или завершает работу на начальном экране, если на главном экране приложения.|Приостановка или возобновление игровой процесс, возврат к предыдущему экрану или завершает работу на начальном экране Если на главном экране приложения.|
|**Повышение левой кнопки**|Переход влево.|Зависит от игры.|
|**Слева триггера**|Переход влево.|Зависит от игры.|
|**Кнопка правой плечо, сможет узнать**|Переход вправо.|Зависит от игры.|
|**Правильный триггер**|Переход вправо|Зависит от игры.|
|**Левый джойстик**|Переходит к элементам пользовательского интерфейса (изменения фокуса).|Зависит от игры.|
|**Джойстик вправо**|Н/Д|Зависит от игры.|

Компания Apple предоставляет следующие рекомендации по работе с игровые устройства:

- **Подтверждение подключения контроллера игры** -приложение tvOS могут запускаться и останавливаться в любое время конечным пользователем. Следует всегда проверять наличие контроллера игры при запуске приложения или переходит в спящий режим времени и принимать меры, необходимые.
- **Убедиться, что свое приложение работает на Siri Remote и игровые устройства** -не требуют пользователям переключаться между Siri Remote и игра контроллер, к вашему приложению. Тестирование приложения часто обоих типов контроллеров, то, что все, что легко настраивается и работает должным образом.
- **Укажите способ обратно** -при нажатии кнопки меню всегда возвращается к предыдущему экрану. Если пользователь находится на экране основного приложения, кнопку меню должен вернуть их на экране Apple TV Главная. Во время игровой процесс кнопку меню должно отображать оповещение, предоставляя пользователю возможность приостанавливать или возобновлять работу игровой процесс или вернуться в главное меню.

<a name="Working-with-Game-Controllers" />

## <a name="working-with-game-controllers"></a>Работа с игровые устройства управления

Как уже говорилось выше, в дополнение к удаленным Siri, который поставляется с Apple TV, пользователь может подключить стандартные сторонний, игровые устройства Bluetooth внесены для iOS (MFI) и использовать его контролировать приложение Xamarin.tvOS.

Если приложения необходимые входные данные низкого уровня контроллера, можно использовать корпорации Apple [Framework контроллера игры](https://developer.apple.com/library/prerelease/tvos/documentation/ServicesDiscovery/Conceptual/GameControllerPG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013276) который имеет указанные ниже изменения для tvOS:

- Профиль контроллера Micro игры (`GCMicroGamepad`) был добавлен для удаленного Siri.
- Новый `GCEventViewController` класс может использоваться для перенаправления событий игровой контроллер с помощью приложения. См. в разделе [определение входных данных игры контроллера](#determining-game-controller-input) Дополнительные сведения в приведенном ниже разделе.

<a name="Game-Controller-Support-Requirements" />

### <a name="game-controller-support-requirements"></a>Требования к поддержке игровой контроллер

Apple имеет ряд конкретных требований, которые должны быть выполнены, если приложение Xamarin.tvOS поддерживает игровые устройства:

- **Должен поддерживать удаленное Siri** -всегда должен поддерживать удаленное Siri. Игры не требуется третьей стороной игровой контроллер для воспроизводиться.
- **Должен поддерживать расширенную макет элемента управления** -все tvOS игровые устройства не formfitting, расширенных контроллеров.
- **Игры должно быть Playable с автономным контроллерами** — Если приложение поддерживает контроллеру расширенных игры, он должен быть воспроизведения исключительно с помощью этого контроллера игры.
- **Должен поддерживать кнопки воспроизведения, паузы** -во время игровой процесс, если пользователь нажимает кнопку воспроизведения, паузы, следует отображать оповещение, предоставляя пользователю возможность игровой процесс приостанавливать или возобновлять работу или вернуться в главное меню.

<a name="Enabling-Game-Controller-Support" />

### <a name="enabling-game-controller-support"></a>Включение поддержки игровой контроллер

Чтобы включить поддержку контроллера игры в приложении Xamarin.tvOS, дважды щелкните `Info.plist` файл **обозревателе решений** чтобы открыть его для редактирования:

[![](remote-bluetooth-images/game02.png "В редакторе Info.plist")](remote-bluetooth-images/game02.png#lightbox)

В разделе **контроллера игра** разделе, установите флажок, **включить игровые устройства**, затем проверьте все типы контроллера игры, которые будут поддерживаться приложением.

<a name="Using-the-Siri-Remote-as-a-Game-Controller" />

### <a name="using-the-siri-remote-as-a-game-controller"></a>Использование удаленного Siri в качестве игровой контроллер

Siri Remote, которые входят в состав Apple TV может использоваться как контроллер ограниченной игры. Как и другие контроллеры игры, оно отображается в Framework контроллера игру в качестве `GCController` объект и поддерживает `GCMotion` и `GCMicroGamepad` профилей.

При использовании как контроллер игры, Siri Remote имеет следующие характеристики:

- Области Touch может использоваться как D-панель, предоставляет аналогового входных данных.
- Remote может быть использован с альбомной или книжной ориентацией и приложение решает, если объект профиля следует перевернуть входных данных автоматически.
- Щелчке рабочей области Touch действует аналогично нажатию кнопки **A** на контроллере игры.
- Кнопки воспроизведения, паузы действует как кнопка **X** на контроллере игры.
- Отображать оповещение, предоставляя пользователю возможность приостанавливать или возобновлять работу игровой процесс или вернуться в главное меню кнопки меню.

<a name="Summary" />

### <a name="determining-game-controller-input"></a>Определение входных данных игровой контроллер

В отличие от iOS, где контроллер игры события можно получать в параллельном режиме с помощью события касания, tvOS обрабатывает все низкоуровневые события для доставки высокоуровневые `UIKit` события. Таким образом, если требуется доступ к событиям низкого уровня контроллера игру, необходимо отключить `UIKit`поведение по умолчанию.

В tvOS, если вы хотите напрямую, необходимо использовать для обработки ввода игровой контроллер `GCEventViewController` (или его подкласс) для отображения игры в пользовательском интерфейсе. Каждый раз, когда `GCEventViewController` — *первый респондент*, игра контроллера ввода будет перехватываться и доставки приложения с помощью платформы контроллера игры.

Можно использовать `UserInteractionEnabled` свойство `GCEventViewController` включаемого или выключаемого как обработанных и обработка событий класса.

Сведения о реализации поддержки контроллера игры, см. в разделе Apple [работа с игровые](https://developer.apple.com/library/prerelease/tvos/documentation/General/Conceptual/AppleTV_PG/WorkingwithGameControllers.html) статьи [приложения руководство по программированию для tvOS](https://developer.apple.com/library/prerelease/tvos/documentation/General/Conceptual/AppleTV_PG/index.html) и [контроллера игры Руководство по программированию](https://developer.apple.com/library/prerelease/tvos/documentation/ServicesDiscovery/Conceptual/GameControllerPG/Introduction/Introduction.html).

<a name="Summary" />

## <a name="summary"></a>Сводка

В этой статье подробно рассматривается новый удаленный Siri, который поставляется с Apple TV, жесты касания поверхности и кнопки Siri Remote. Затем он рассматривается работа с жестами и раскадровки, жесты и кода и низкоуровневые события. Наконец Если рассматривается работа с игровые устройства.



## <a name="related-links"></a>Связанные ссылки

- [Примеры tvOS](https://developer.xamarin.com/samples/tvos/all/)
- [tvOS](https://developer.apple.com/tvos/)
- [Человека направляющие интерфейса tvOS](https://developer.apple.com/tvos/human-interface-guidelines/)
- [Приложение руководство по программированию для tvOS](https://developer.apple.com/library/prerelease/tvos/documentation/General/Conceptual/AppleTV_PG/)
