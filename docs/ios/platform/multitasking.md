---
title: "Многозадачность для iPad"
description: "iOS 9 поддерживает два приложения, работающие в то же время, с помощью слайда по или представление с разделением. Оно также поддерживает видео воспроизведение рисунок в изображение."
ms.topic: article
ms.prod: xamarin
ms.assetid: 0F2266D7-21FF-404D-A148-0CFDE76B12AA
ms.technology: xamarin-ios
ms.custom: xamu-video
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/20/2017
ms.openlocfilehash: 0783372cd36d5a4984d09ee055257d525e7becb1
ms.sourcegitcommit: 73bd0c7e5f237f0a1be70a6c1384309bb26609d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2018
---
# <a name="multitasking-for-ipad"></a>Многозадачность для iPad

_iOS 9 поддерживает два приложения, работающие в то же время, с помощью слайда по или представление с разделением. Оно также поддерживает видео воспроизведение рисунок в изображение._

![](multitasking-images/about02-sml.png "Разделение экрана пример") ![ ] (multitasking-images/about03-sml.png "примере рисунка в изображение")

iOS 9 добавляет поддержку многозадачной запуск двух приложений одновременно на iPad определенного оборудования. Многозадачность для iPad поддерживает следующие функции:

- [**Слайд по** ](#Slide-Over) -пользователь может временно запуска второго приложения iOS в слайд out панели (либо на правой или левой части экрана, в зависимости от направления языка), который охватывает примерно 25% в настоящее время выполнения основного приложения. Слайд по доступен только на iPad Pro, iPad воздуха, iPad 2 воздуха, iPad Mini 2, iPad Mini 3 или iPad Mini 4.
- [**Разделенное представление** ](#Split-View) -на оборудовании, поддерживаемых iPad (iPad iPad Mini 4 и iPad Pro только 2 воздуху), пользователь может выбрать второй приложения и запустите side-by-side с текущего выполняемого приложения в режиме экрана разбиения. Пользователь может контролировать процентную долю главный экран, занимающую каждого приложения.
- [**Изображение в изображении** ](#Picture-in-Picture) — для приложений, содержимое воспроизведения видео, видео, которые теперь могут воспроизводиться в окне перемещаемый и изменять в размере, расположенном поверх других приложений, выполняющихся на устройстве iOS. Пользователь имеет полный контроль над размер и положение этого окна. Изображение в изображении доступна только на iPad Pro, iPad воздуха, iPad 2 воздуха, iPad Mini 2, iPad Mini 3 или iPad Mini 4.

Существует несколько вещей, которые необходимо учитывать при [поддержки в вашем приложении многозадачной](#Supporting-Multitasking-in-your-App), в том числе:

- [Размер экрана и ориентации](#Screen-Size-Considerations)
- [Сочетания клавиш оборудования](#Custom-Hardware-Keyboard-Shortcuts)
- [Управление ресурсами](#Resource-Management-Considerations)

Как разработчик приложения вы также можете [отказаться от многозадачной](#Opting-Out-of-Multitasking), в том числе [отключение воспроизведения видео PIP](#Disabling-PIP-Video-Playback).

В этой статье мы рассмотрим шаги, необходимые для убедитесь, что приложения Xamarin.iOS выполняется в многозадачной среде правильно, или как отказаться многозадачной, если это не так хорошо подходит для приложения.

> [!VIDEO https://youtube.com/embed/GctYAozoLr8]

**Многозадачность для iPad, по [университета Xamarin](https://university.xamarin.com)**


<a name="Multitasking-QuickStart" />

## <a name="multitasking-quickstart"></a>Краткое руководство многозадачной

Для поддержки **слайда по** или **разделенное представление** приложения необходимо выполнить следующие действия:

 - Будет создана на основе iOS 9 (или более поздней).
 - Использование раскадровки для его запуска экрана (и не изображения средств).
 - Используйте раскадровки с Autolayout и размер классов для своего пользовательского интерфейса.
 - Поддерживает все 4 операций ввода-вывода устройства ориентации (книжной ориентации, верхней стороной вниз Книжная, Альбомная слева и Альбомная справа).

<a name="Multitasking" />

## <a name="about-multitasking-for-ipad"></a>О многозадачность для iPad

iOS 9 предоставляет новые возможности многозадачной на iPad с появлением _слайда по_, _разделенное представление_ (iPad iPad Mini 4 и iPad Pro только 2 воздуху) и _изображение в изображении_. Перейти в следующих разделах более подробно рассмотрим эти функции.

<a name="Slide-Over" />

### <a name="slide-over"></a>Слайд по

Функция слайда по позволяет пользователю выбрать второй приложения и его отображения в небольших скользящий панели для обеспечения быстрого взаимодействия. Панели слайда по является временным и будет закрыто, пользователь возвращается к работе с основным приложением еще раз.

[![](multitasking-images/about01.png "Панель слайда по")](multitasking-images/about01.png#lightbox)

Самое главное является пользователь решает, какие два приложения будут выполняться side-by-side и что разработчик может не контролирует этот процесс. В результате существует несколько действий, которые необходимо выполнить, чтобы убедиться в правильности работы приложения Xamarin.iOS панели слайда по:

- **Использования Autolayout и размер классов** , так как приложения Xamarin.iOS можно запустить в слайд out боковой панели, можно больше не полагаться на устройство, его размер экрана или его ориентацию в макет пользовательского интерфейса. Чтобы правильно масштабирует его интерфейс приложения, необходимо использовать Autolayout и размер классы. Дополнительные сведения см. в разделе нашей [введение в единой раскадровки](~/ios/user-interface/storyboards/unified-storyboards.md) документации.
- **Ресурсы эффективно использовать** , так как приложения могут теперь использовать данные совместно системы с другого выполняющегося приложения, очень важно, приложения более эффективно использовать ресурсы системы. Когда памяти становится разреженным, система автоматически прекратит приложения, которое занимает больше всего памяти. В разделе Apple [руководство по эффективности энергии для приложений iOS](https://developer.apple.com/library/prerelease/ios/documentation/Performance/Conceptual/EnergyGuide-iOS/index.html#//apple_ref/doc/uid/TP40015243) Дополнительные сведения.

Слайд по доступен только на iPad Pro, iPad воздуха, iPad 2 воздуха, iPad Mini 2, iPad Mini 3 или iPad Mini 4. Дополнительные сведения о подготовке приложения к слайда по см. в разделе Apple [внедрение усовершенствования многозадачной на iPad](https://developer.apple.com/library/prerelease/ios/documentation/WindowsViews/Conceptual/AdoptingMultitaskingOniPad/index.html#//apple_ref/doc/uid/TP40015145) документации.

<a name="Split-View" />

### <a name="split-view"></a>Представление с разделением

На оборудовании, поддерживаемых iPad (iPad iPad Mini 4 и iPad Pro только 2 воздуху) пользователь может выбрать второй приложение и запустите его side-by-side с текущего выполняемого приложения в режиме экрана разбиение. Пользователь может контролировать процентную долю главный экран, который занимает каждое приложение, перетащив на экране разделитель.

[![](multitasking-images/about02.png "Представление с разделением")](multitasking-images/about02.png#lightbox)

Как и слайд по пользователь решает, какие два приложения будут выполняться side-by-side и еще раз, разработчик может не контролирует этот процесс. В результате разделенное представление помещает схожих требований приложения Xamarin.iOS:

- **Использовать Autolayout и размер классы** , так как приложения Xamarin.iOS теперь может выполняться в режиме экрана разбиение на пользователя, указанного размера, можно больше не полагаться на устройство, его размер экрана или его ориентацию в макет пользовательского интерфейса. Чтобы правильно масштабирует его интерфейс приложения, необходимо использовать Autolayout и размер классы. Дополнительные сведения см. в разделе нашей [введение в единой раскадровки](~/ios/user-interface/storyboards/unified-storyboards.md) документации.
- **Ресурсы эффективно использовать** , так как приложения могут теперь использовать данные совместно системы с другого выполняющегося приложения, очень важно, приложения более эффективно использовать ресурсы системы. Когда памяти становится разреженным, система автоматически прекратит приложения, которое занимает больше всего памяти. В разделе Apple [руководство по эффективности энергии для приложений iOS](https://developer.apple.com/library/prerelease/ios/documentation/Performance/Conceptual/EnergyGuide-iOS/index.html#//apple_ref/doc/uid/TP40015243) Дополнительные сведения.

Дополнительные сведения о подготовке приложения в разделенном представлении см. в разделе Apple [внедрение усовершенствования многозадачной на iPad](https://developer.apple.com/library/prerelease/ios/documentation/WindowsViews/Conceptual/AdoptingMultitaskingOniPad/index.html#//apple_ref/doc/uid/TP40015145) документации.

<a name="Picture-in-Picture" />

### <a name="picture-in-picture"></a>Изображение в изображении

Новое изображение в рисунок компонентов (также называется _PIP_) позволяет пользователю видео в окне маленькие, с плавающей запятой, пользователя можно разместить в любом месте экрана выше другие работающие приложения.

[![](multitasking-images/about03.png "Пример изображения в плавающем окне рисунка")](multitasking-images/about03.png#lightbox)

Как и слайд через представление с разделением, пользователь имеет полный контроль над просмотре видео на изображении в режиме изображений. Если основная функция приложения — видео, его потребуется внесения некоторых модификаций правильно работать в режиме PIP-адрес. В противном случае изменения не требуются для поддержки PIP-адрес.

Для отображения PIP видео по запросу пользователя приложения, необходимо использовать либо _AVKit_ или _API-интерфейсы Foundation AV_. Платформа проигрывателя мультимедиа больше поддерживаются в iOS 9 и не поддерживает PIP-адрес.

Изображение в изображении доступна только на iPad Pro, iPad воздуха, iPad 2 воздуха, iPad Mini 2, iPad Mini 3 или iPad Mini 4. Дополнительные сведения см. в разделе нашей [PictureInPicture пример приложения](https://developer.xamarin.com/samples/ios/iOS9/) и Apple [рисунок в быстром запуске рисунок](https://developer.apple.com/library/prerelease/ios/documentation/WindowsViews/Conceptual/AdoptingMultitaskingOniPad/QuickStartForPictureInPicture.html#//apple_ref/doc/uid/TP40015145-CH14) документации.

<a name="Supporting-Multitasking-in-your-App" />

## <a name="supporting-multitasking-in-your-app"></a>Поддержка многозадачной в приложение

Для любого существующего приложения Xamarin.iOS поддержки многозадачной осуществляется прозрачный до тех пор, пока приложение уже соответствует руководства по разработке Apple и рекомендации для iOS 8. Это означает, что приложение следует использовать раскадровки с Autolayout и классами размер макетов его пользовательский интерфейс (см. наш [введение в единой раскадровки](~/ios/user-interface/storyboards/unified-storyboards.md) для получения дополнительной информации).

Для этих приложений изменения почти или совсем не требуются для поддержки многозадачной и ведут себя в пределах его. Если ваше приложение пользовательского интерфейса, был создан с помощью других методов, например непосредственно позиционирование и изменение размеров элементов пользовательского интерфейса в код C#, или если он зависит от размеров конкретного устройства или ориентации, его потребуется значительные изменения для поддержки iOS 9 многозадачной правильно.

Для поддержки iOS 9 многозадачной любое новое приложение, Xamarin.iOS, снова использовать раскадровки с Autolayout и размер классов для всех макетов пользовательский интерфейс приложения и реализовать инструкциям в следующих разделах.

<a name="Screen-Size-Considerations" />

### <a name="screen-size-and-orientation-considerations"></a>Размер экрана и ориентацию вопросы

Прежде чем iOS 9 можно создать приложение на конкретном устройстве экрана размеры и ориентации. Так как приложение можно запустить панели слайд Out или в режиме разделенного представления, можно найти сам под управлением либо класс compact или обычный размер по горизонтали на iPad, независимо от размера экрана или ориентации физического устройства.

[![](multitasking-images/sizeclasses01.png "Размер экрана и ориентацию вопросы")](multitasking-images/sizeclasses01.png#lightbox)

На iPad полноэкранного приложения имеет размер горизонтальной и вертикальной регулярные классы. Все устройства iPhone, но iPhone 6 Plus и iPhone 6s Plus, иметь компактный размер классов в обоих направлениях в любой ориентации. IPhone 6 Plus и iPhone 6s Plus в альбомной ориентации имеют обычного горизонтальный размер класса и Compact вертикальный размер класса (очень похоже на iPad Mini).

На iPad, поддерживающие слайда по и разделенное представление могут быть сохранены со следующими:

| **Ориентация** | **Основного приложения** | **Вторичный приложения** |
|--- |--- |--- |
| **Книжная ориентация** |75% от экрана<br />Compact по горизонтали<br />Регулярные по вертикали|25% от экрана<br />Compact по горизонтали<br />Регулярные по вертикали|
| **Альбомная ориентация** |75% от экрана<br />Регулярные по горизонтали<br />Регулярные по вертикали|25% от экрана<br />Compact по горизонтали<br />Регулярные по вертикали|
| **Альбомная ориентация** |50% от экрана<br />Compact по горизонтали<br />Регулярные по вертикали|50% от экрана<br />Compact по горизонтали<br />Регулярные по вертикали|

В примере [MuliTask](https://developer.xamarin.com/samples/monotouch/ios9/MultiTask/) приложения, если он выполняется на iPad в альбомной ориентации весь экран, он будет представлять список и подробное представление, в то же время:

[![](multitasking-images/sizeclasses03.png "Список и подробное представление, представленных в то же время")](multitasking-images/sizeclasses03.png#lightbox)

Если то же приложение выполняется на слайд через панель, оно выводится как класс Compact горизонтальный размер и отображается только список:

[![](multitasking-images/sizeclasses04.png "Только в списке представлены, когда устройство находится в горизонтальной")](multitasking-images/sizeclasses04.png#lightbox)

Чтобы убедиться, что приложение работает правильно, в таких ситуациях, следует внедрить коллекций признака вместе с размером классов и соответствовать `IUIContentContainer` и `IUITraitEnvironment` интерфейсов. . В разделе Apple [ссылку на класс UITraitCollection](https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UITraitCollection_ClassReference/index.html#//apple_ref/doc/uid/TP40014202) и на нашем [введение в единой раскадровки](~/ios/user-interface/storyboards/unified-storyboards.md) для дополнительных сведений.

Кроме того можно не полагаться на границы экрана устройств для определения видимой области приложения, необходимо вместо этого используйте границ окна приложения. Поскольку границ окна, полностью управляются пользователя, не может программным способом их настройку и запретить пользователю изменять эти границы.

Наконец, приложение должно использовать файл раскадровки для представления его запуска экрана, а не с помощью набора **.png** файлы изображений и поддерживает все четыре интерфейса ориентации (книжной ориентации, верхней стороной вниз Книжная, Альбомная слева и справа альбомная) следует учитывать для запуска панели слайд за или в режиме разделенного представления.

<a name="Custom-Hardware-Keyboard-Shortcuts" />

### <a name="custom-hardware-keyboard-shortcuts"></a>Сочетания клавиш оборудования

В iOS 9, работающем на iPad, Apple имеет расширенная поддержка оборудования клавиатуры. устройств iPad, всегда включенных основные клавиатуры поддержки через Bluetooth и некоторые клавиатуры изготовителей создан клавиатуры, которые включены с проводами клавиш для определенного операций ввода-вывода.

Теперь с iOS 9 приложения можно создать собственные настраиваемые сочетания клавиш. Кроме того, некоторые основные сочетания клавиш доступны, как **C команды** (копия) **команда X** (cut), **V команда** (Вставить) и **команда-Shift-H**  (home), без приложения, в частности письменного ответ на них.

**Вкладка "команда"** появится приложение переключателя, пользователь может быстро переключаться между приложениями с помощью клавиатуры, так же, как Mac OS:

[![](multitasking-images/keyboard01.png "Приложение переключателя")](multitasking-images/keyboard01.png#lightbox)

Если приложение iOS 9 содержит сочетания клавиш, пользователь может удерживать **команда**, **параметр** или **управления** ключи для их отображения во всплывающем окне:

[![](multitasking-images/keyboard02.png "Контекстное меню сочетания клавиш")](multitasking-images/keyboard02.png#lightbox)

#### <a name="defining-custom-keyboard-shortcuts"></a>Определение пользовательских сочетаний клавиш

Если добавить следующий код для представления или представление контроллер в нашем приложении, представление или контроллера отображается, когда, будут доступны настраиваемые сочетания клавиш:

```csharp
#region Custom Keyboard Shortcut
public override bool CanBecomeFirstResponder {
    get { return true; }
}

public override UIKeyCommand[] KeyCommands {
    get {

        var keyCommand = UIKeyCommand.Create (new NSString("n"), UIKeyModifierFlags.Command, new Selector ("NewEntry"), new NSString("New Entry"));
        return new UIKeyCommand[]{ keyCommand };
    }
}

[Export("NewEntry")]
public void NewEntry() {

    // Add a new entry
    ...

}
#endregion
```

Во-первых, мы переопределить `CanBecomeFirstResponder` свойства и возвращаемые `true` , представления или представление контроллер может получать ввод с клавиатуры. 

Затем мы Переопределите `KeyCommands` свойство и создайте новый `UIKeyCommand` для **команда N** нажатие клавиши. При активизации нажатие клавиши, мы называем `NewEntry` метод (, мы предоставляем iOS 9 с помощью `Export` команда) для выполнения запрошенного действия.

Если мы запустим это приложение на iPad с подсоединенной клавиатурой оборудования и пользовательские типы **команда N**, новая запись добавляется в список. При удерживании пользователем **команда** ключа, список сочетаний клавиш будет отображаться:

[![](multitasking-images/keyboard03.png "Контекстное меню сочетания клавиш")](multitasking-images/keyboard03.png#lightbox)

См. в разделе примера [многозадачной работы приложения](http://developer.xamarin.com/samples/monotouch/ios9/MultiTask/) пример внедрения.

<a name="Resource-Management-Considerations" />

### <a name="resource-management-considerations"></a>Вопросы управления ресурса

Даже для приложений, которые уже используют iOS 8 в руководствах по проектированию и рекомендации управление ресурсами эффективным по-прежнему могут возникнуть проблемы. В iOS 9 приложения больше не имеют монопольного использования памяти, ЦП или других системных ресурсов.

В результате необходимо оптимизировать приложения Xamarin.iOS для эффективного использования системных ресурсов или его окном завершения в ситуациях нехватки памяти. Столь же верно для приложений, которые отказаться от многозадачной, после второго приложения может выполняться по-прежнему в слайд через панель или изображения в окне изображения требует дополнительных ресурсов или вызывая частота обновления, чтобы падают ниже 60 кадров в секунду.

Рассмотрим следующие действия пользователя и их последствия.

- **Ввод текста на панели слайда по** -даже если приложение не имеет текстовое входов, системной клавиатуры может появиться через пользовательский Интерфейс. В результате приложения может потребоваться реагировать на отображение уведомлений клавиатуры (например, отображение и скрытие клавиатуры).
- **Выполнение второго приложения в панели слайда по** -новое приложение теперь выполняется на переднем плане и конкурировать с существующим приложением для системных ресурсов, например памяти и ЦП.
- **Воспроизведение видео в окне PIP** — не только в этом окне может охватывать частью интерфейса приложения, но приложение, которое запускается видео по-прежнему работает в фоновом режиме и потребление ресурсов ЦП и памяти.

Чтобы убедиться, что приложения эффективно использует ресурсы, делать следующее:

- **Профилирование приложения с помощью инструментов** -проверьте на наличие утечек памяти заметны ЦП и области, где приложение может блокировать главный поток.
- **Отвечать на методы переходы состояния** — в вашей **AppDelegate.cs** переопределение файла и ответ на состояние изменения методов, таких как приложения, введя или возвращение из фона. Освободите все фигурных ресурсов, таких как изображения, данных или представления и контроллера представления.
- **Тестирование рядом с приложениями служб с интенсивным использованием памяти** — запуск приложения с помощью слайд Out и представление с разделением на оборудовании физических операций ввода-вывода с памяти служб с интенсивными вычислениями приложения, например карты (в режиме просмотра вспомогательных) и проверьте, оба приложения продолжать отвечать на запросы и не приводит к сбою.

В разделе Apple [руководство по эффективности энергии для приложений iOS](https://developer.apple.com/library/prerelease/ios/documentation/Performance/Conceptual/EnergyGuide-iOS/index.html#//apple_ref/doc/uid/TP40015243) Дополнительные сведения об управлении ресурсами.

<a name="Opting-Out-of-Multitasking" />

## <a name="opting-out-of-multitasking"></a>Отказ от многозадачной

Хотя Apple видно, что все приложения iOS 9 поддерживает многозадачной, могут существовать особых причин для приложения не слишком как игры или приложения камеры, требующих во весь экран для правильной работы.

Для приложения Xamarin.iOS отказаться от выполняется либо на слайд Out панели или в режиме разделенного представления изменения проекта **Info.plist** файл и проверьте **требует полного экрана**:

[![](multitasking-images/fullscreen01.png "Отказ от многозадачной")](multitasking-images/fullscreen01.png#lightbox)

> [!IMPORTANT]
> Хотя отказ от многозадачной предотвращает приложение выполняется в слайд Out или представление с разделением, он запрещен другое приложение выполняется в слайд Out или рисунка на изображении видео выводил вместе с приложением.

<a name="Disabling-PIP-Video-Playback" />

### <a name="disabling-pip-video-playback"></a>Отключение PIP воспроизведение видео

В большинстве случаев приложения следует разрешить пользователю воспроизводить видео содержимое, он отображает изображение в плавающем окне изображения. Тем не менее может возникнуть ситуация, где это может быть нежелательно, таких как видео игры вырежьте сцены.

Чтобы отказаться от PIP воспроизведение видео, выполните следующие действия в приложении:

 - Если вы используете `AVPlayerViewController` для отображения видео, задайте `AllowsPictureInPicturePlayback` свойства `false`.
 - Если вы используете `AVPlayerLayer` не создать для отображения видео, `AVPictureInPictureController`.
 - Если вы используете `WKWebView` для отображения видео, задайте `AllowsPictureInPictureMediaPlayback` свойства `false`.

<a name="Summary" />

## <a name="summary"></a>Сводка

В этой статье, описанные шаги, необходимые для приложения Xamarin.iOS запуска и правильно работать в новой возможности многозадачной iOS 9 для устройств iPad. Кроме того он рассматривается Выбор горизонтального многозадачность для приложений, где это не подходит.



## <a name="related-links"></a>Связанные ссылки

- [Образцы iOS 9](https://developer.xamarin.com/samples/ios/iOS9/)
- [Справляется (пример)](https://developer.xamarin.com/samples/monotouch/ios9/MultiTask/)
- [Общие сведения о единой раскадровки](~/ios/user-interface/storyboards/unified-storyboards.md)
- [iOS 9 для разработчиков](https://developer.apple.com/ios/pre-release/)
- [iOS 9.0](https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS9.html)
- [Внедрение усовершенствования многозадачной на iPad](https://developer.apple.com/library/prerelease/ios/documentation/WindowsViews/Conceptual/AdoptingMultitaskingOniPad/index.html#//apple_ref/doc/uid/TP40015145)
- [запись блога](https://blog.xamarin.com/using-auto-layouts-for-ios-9-splitview/)
