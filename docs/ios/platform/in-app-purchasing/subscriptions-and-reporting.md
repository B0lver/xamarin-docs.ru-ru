---
title: Подписки и отчетов
ms.prod: xamarin
ms.assetid: 27EE4234-07F5-D2CD-DC1C-86E27C20141E
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/18/2017
ms.openlocfilehash: 7ba47e8f0ec114845c14269e81bb7f078a5d4936
ms.sourcegitcommit: 945df041e2180cb20af08b83cc703ecd1aedc6b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/04/2018
---
# <a name="subscriptions-and-reporting"></a>Подписки и отчетов

## <a name="about-non-renewing-subscriptions"></a>О не возобновление подписок

Обновление без подписки предназначены для продуктов, которые представляют продажи службы с ограничениями времени, например (одна неделя доступ к приложению навигации) или временными архив данных.   
   
   
   
 Основные различия между-обновление подписок и других типов продукта.

-  Определение продукта в iTunes Connect не включает термин. Код приложения должен иметь возможность определять срок действия от идентификатора продукта. 
-  Их можно приобрести несколько раз (например, к использованию продукта). Приложения необходимы для управления термин срока и обновления и запрет для пользователя на приобретение перекрывающиеся подписок. 
-  Покупки не поддерживаются функцией StoreKit восстановления. Если подписки должен быть доступен на устройствах пользователей, приложение будет проектирования и реализации этой возможности в сочетании с удаленным сервером. Приложения отвечают также резервного вверх состояние подписки для случаев, когда устройство резервной копии затем восстановлена из-резервной копии. 
-  Общие сведения о реализации
-  Обновление без подписки обычно должны быть реализованы с помощью рабочего процесса доставки сервера и управляются, как использовать продукты. 


## <a name="about-free-subscriptions"></a>О бесплатные подписки

Бесплатные подписки позволяют разработчикам размещения свободного содержимого в приложениях киоска новостей (они не может использоваться в приложениях не киоска новостей). После запуска бесплатная подписка будет доступна на устройствах пользователей. Бесплатная подписка неограниченный срок действия; они только завершаются при удалении приложения.

### <a name="implementation-overview"></a>Общие сведения о реализации

Бесплатная подписка гораздо ведут себя как автоматически обновляемый подписок. В приложении должна быть «приобрести» бесплатная подписка продукта в iTunes Connect. При приобретении пользователем приобретении бесплатной подписки должны проверяться как продукт с автоматически обновляемый подписки. Бесплатная подписка транзакции могут быть восстановлены.


## <a name="about-auto-renewable-subscriptions"></a>О подписках, автоматически обновляемый

Автоматически обновляемый подписки используются главным образом в приложениях киоска новостей. Они представляют продукт, который предоставит пользователю доступ для динамического содержимого в определенный период времени, который настроен в iTunes Connect (задать период — 7 дней до 1 год). Подписки автоматически, возобновляются заряжается пользователей идентификатор Apple ID в конце каждого периода подписки, если пользователь соглашается out. Этот тип продукта хорошо работает для подписок магазин или новостей, где пользователь получает доступ к каждой проблемы, опубликованные во время их Подписка действительна.

### <a name="implementation-overview"></a>Общие сведения о реализации

Автоматически обновляемый подписки должны быть реализованы с помощью рабочего процесса Server-Delivered продуктов (см. *проверки поступления и продуктов Server-Delivered* раздел).

#### <a name="shared-secret"></a>Общий секрет

Общий секрет для покупки в приложении необходимо использовать в запросе JSON при проверке автоматически обновляемый подписок на сервере. Общий секрет, созданные или доступ к ней через iTunes Connect.

В iTunes Connect домашней странице выберите **Мои приложения**:   
   
 [![](subscriptions-and-reporting-images/image2.png "Выберите "Мои приложения"")](subscriptions-and-reporting-images/image2.png#lightbox)  
 
Выберите приложение и щелкнуть **покупки из приложений** вкладки:

[![](subscriptions-and-reporting-images/image6.png "Перейдите на вкладку покупках в приложении")](subscriptions-and-reporting-images/image6.png#lightbox)

В нижней части страницы выберите **представление или создать общий секрет**:
   
 [![](subscriptions-and-reporting-images/image40.png "Выберите представление или создать общий секрет")](subscriptions-and-reporting-images/image40.png#lightbox)

 [![](subscriptions-and-reporting-images/image41.png "Создание общего секрета")](subscriptions-and-reporting-images/image41.png#lightbox)   
   
   
   
 Чтобы использовать общий секрет, включите ее в полезных данных JSON, отправляемое серверы Apple при проверке уведомление покупки из приложений для подписки на публикацию автоматически обновляемый следующим образом:

```csharp
{
   "receipt-data" : "(receipt bytes here)",
   "password"     : "(shared secret bytes here)"
}
```

Поле состояния ответа будет равно нулю, если покупки является допустимым, как и другие типы продуктов.

#### <a name="downloading-items-after-the-initial-subscription-term"></a>Загрузка элементов после начальной подписки термин

В ходе доставки подписки продуктов код часто следует проверить последних известных получению на серверах компании Apple. Auto-продления подписки с момента последней проверки, ответ JSON будет содержать дополнительные поля, уведомлять приложение транзакции, которая произошла (которого следует продлить срок действия подписок). Содержит ответ JSON:

```csharp
{
   "status" : 0,
   "receipt" : { (receipt here) },
   "latest_receipt" : "(base-64 encoded receipt here)",
   "latest_receipt_info" : { (latest receipt info here) }
}
```

Если состояние равно нулю, подписка по-прежнему действительна, и другие поля содержат допустимые данные. Если состояние — 21006 подписки истек. В разделе [проверить автоматически обновляемый уведомление о доставке подписки](https://developer.apple.com/library/ios/releasenotes/General/ValidateAppStoreReceipt/Chapters/ValidateRemotely.html) документации для других кодов ошибок.

#### <a name="restoring-auto-renewable-subscriptions"></a>Восстановление автоматически обновляемый подписок

Вы получите несколько транзакций — исходная транзакция покупки, а также отдельную транзакцию для каждого периода времени подписки был обновлен. Необходимо отслеживать даты начала и условия для понимания, что срок действия.   
   
   
   
 Объект SKPaymentTransaction не включает термин подписки — следует использовать другой идентификатор продукта для каждого термина и написать код, который можно экстраполировать периода подписки с даты покупки транзакции.

#### <a name="testing-auto-renewal"></a>Тестирование автоматического обновления

Чтобы упростить тестирование подписки, их длительности сжимаются при тестировании в "песочнице". 1 неделя подписок продлить каждые 3 минуты, каждый час продления подписки 1 год. Подписки будут автоматическое возобновление более 6 раз во время тестирования в изолированной среде.

## <a name="reporting"></a>Отчеты

iTunes Connect ( [itunesconnect.apple.com](http://itunesconnect.apple.com)) предоставляет:   
   
 **Продажи и тенденций** — отображает подробные сведения приложения загрузки, обновления и покупки из приложений.   
   
 **Платежей и финансовые отчеты** — сведения о числе приложений, а также список платежей, которые были внесены и сколько подлежащая возврату доход.

Ниже приведен пример продаж и тенденций отчета:   

 [![](subscriptions-and-reporting-images/image42.png "Пример отчета продаж и тенденции")](subscriptions-and-reporting-images/image42.png#lightbox)   
   
 Имеется также [ **мобильного подключения ITC**приложение iOS (iTunes ссылка)](http://itunes.apple.com/us/app/itunes-connect-mobile/id376771144?mt=8).
снимки экрана iPhone для некоторых статистические данные, доступные, показаны ниже:   
   
 [![](subscriptions-and-reporting-images/image43.png "снимки экрана iPhone некоторые статистические данные, доступные для")](subscriptions-and-reporting-images/image43.png#lightbox)
