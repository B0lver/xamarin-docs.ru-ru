---
title: Привязка библиотек SWIFT для iOS
description: В этом документе описывается, как создавать привязки C# к коду SWIFT, что позволяет использовать собственные библиотеки и CocoaPods в приложении Xamarin. iOS.
ms.prod: xamarin
ms.assetid: 890EFCCA-A2A2-4561-88EA-30DE3041F61D
ms.technology: xamarin-ios
author: alexeystrakh
ms.author: alstrakh
ms.date: 02/11/2020
ms.openlocfilehash: 72ab1d9f10ee308313569528d152d5930a258207
ms.sourcegitcommit: a3f13a216fab4fc20a9adf343895b9d6a54634a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85852968"
---
# <a name="bind-ios-swift-libraries"></a>Привязка библиотек SWIFT для iOS

> [!IMPORTANT]
> Сейчас мы изучаем использование пользовательской привязки на платформе Xamarin. Примите участие в [**опросе**](https://www.surveymonkey.com/r/KKBHNLT) , чтобы проинформировать будущие усилия по разработке.

Платформа iOS, а также ее собственные языки и средства постоянно развиваются, и существует множество сторонних библиотек, разработанных с использованием новейших предложений. Максимизация повторного использования кода и компонентов является одной из основных целей кросс-платформенной разработки. Возможность повторного использования компонентов, созданных с помощью SWIFT, становится все более важной для разработчиков Xamarin, так как их популярность растет в развитии разработчиков. Возможно, вы уже знакомы с процессом привязки стандартных библиотек [цели-C](https://docs.microsoft.com/xamarin/ios/platform/binding-objective-c/walkthrough) . Теперь доступна дополнительная документация, описывающая процесс [привязки к платформе SWIFT](walkthrough.md), поэтому она может использоваться приложением Xamarin таким же образом. Цель этого документа — описать высокоуровневый подход к созданию привязки SWIFT для Xamarin.

## <a name="high-level-approach"></a>Высокоуровневый подход

С помощью Xamarin можно привязать любую собственную библиотеку стороннего производителя для использования приложением Xamarin. SWIFT — это новый язык, и для создания привязки библиотек, созданных на этом языке, требуются некоторые дополнительные действия и средства. Этот подход включает в себя следующие четыре шага:

1. Создание собственной библиотеки
1. Подготовка метаданных Xamarin, которая позволяет средствам Xamarin создавать классы C#
1. Создание библиотеки привязок Xamarin с помощью собственной библиотеки и метаданных
1. Использование библиотеки привязки Xamarin в приложении Xamarin

В следующих разделах описаны эти действия с дополнительными сведениями.

### <a name="build-the-native-library"></a>Создание собственной библиотеки

Первым шагом является готовность собственной платформы SWIFT с созданным заголовком цели-C. Этот файл представляет собой автоматически сформированный заголовок, который предоставляет нужные классы, методы и поля SWIFT, делая их доступными для цели-C и в конечном счете на C# через библиотеку привязок Xamarin. Этот файл находится в пределах платформы по следующему пути: ** \<FrameworkName> . Framework/Headers/ \<FrameworkName> -SWIFT. h**. Если предоставленный интерфейс содержит все необходимые элементы, можно перейти к следующему шагу. В противном случае для предоставления этих элементов требуются дальнейшие действия. Этот подход будет зависеть от того, есть ли у вас доступ к исходному коду платформы Swift:

- Если у вас есть доступ к коду, вы можете снабдить обязательные элементы SWIFT `@objc` атрибутом и применить несколько дополнительных правил, чтобы позволить средствам построения Xcode известно, что эти члены должны быть представлены в мире цели-C и в заголовке.
- Если у вас нет доступа к исходному коду, необходимо создать инфраструктуру прокси-сервера SWIFT, которая создает оболочку для исходной платформы SWIFT и определяет открытый интерфейс, необходимый для приложения с помощью `@objc` атрибута.

### <a name="prepare-the-xamarin-metadata"></a>Подготовка метаданных Xamarin

Вторым шагом является подготовка интерфейсов определения API, которые используются в проекте привязки для создания классов C#. Эти определения можно создать вручную или автоматически с помощью инструмента " [целевое Шарпие](https://docs.microsoft.com/xamarin/cross-platform/macios/binding/objective-sharpie/) " и упомянутого выше файла заголовка "автоматическое создание" ** \<FrameworkName> -SWIFT. h** . После создания метаданных их необходимо проверить и проверить вручную.

### <a name="build-the-xamarinios-binding-library"></a>Создание библиотеки привязки Xamarin. iOS

Третий шаг — создать специальный проект — Библиотека привязки Xamarin. iOS. Он ссылается на платформы и метаданные, подготовленные на предыдущем шаге, а также на любые дополнительные зависимости, с которыми зависит соответствующая платформа. Он также обрабатывает связывание собственных платформ, на которые имеются ссылки, с помощью приложения Xamarin. iOS.

### <a name="consume-the-xamarin-binding-library"></a>Использование библиотеки привязки Xamarin

Четвертый и последний шаг — ссылка на библиотеку привязки в приложении Xamarin. iOS. Достаточно разрешить использование собственной библиотеки в приложениях Xamarin. iOS, предназначенных для iOS 12,2 и более поздних версий. Для приложений, предназначенных для более ранней версии, требуются некоторые дополнительные действия.

- Добавление dylib зависимостей для поддержки среды выполнения. Начиная с iOS 12,2 и SWIFT 5,1, язык стал ABI (двоичный интерфейс приложения) стабильным и совместимым. Вот почему все приложения, предназначенные для более ранней версии iOS, должны включать в себя зависимости SWIFT дилибс, используемые платформой. Используйте [пакет NuGet свифтрунтимесуппорт](https://www.nuget.org/packages/Xamarin.iOS.SwiftRuntimeSupport/) для автоматического включения необходимых зависимостей dylib в полученный пакет приложения.
- Добавьте папку **свифтсуппорт** с подписанным дилибс, который проверяется AppStore во время передачи. Пакет должен быть подписан и распространен на AppStore Connect с помощью средств Xcode, в противном случае он будет автоматически отклонен.

## <a name="walkthrough"></a>Пошаговое руководство

Приведенный выше подход описывает действия высокого уровня, необходимые для создания привязки SWIFT для Xamarin. Существует множество действий более низкого уровня, которые необходимо учитывать при подготовке этих привязок на практике, включая адаптацию к изменениям в собственных средствах и языках. Цель — помочь вам получить более глубокое представление об этой концепции и общих действиях, связанных с этим процессом. Подробное пошаговое руководство см. в документации по [привязке Xamarin SWIFT](walkthrough.md) .

## <a name="related-links"></a>Связанные ссылки

- [Xcode](https://apps.apple.com/us/app/xcode/id497799835)
- [Visual Studio для Mac](https://visualstudio.microsoft.com/downloads)
- [Objective Sharpie](https://docs.microsoft.com/xamarin/cross-platform/macios/binding/objective-sharpie/)
- [Проверка метаданных Шарпие](https://docs.microsoft.com/xamarin/cross-platform/macios/binding/objective-sharpie/platform/verify)
- [Цель привязки — платформа C](https://docs.microsoft.com/xamarin/ios/platform/binding-objective-c/walkthrough)
- [Пакет SDK для Gigya iOS (платформа SWIFT)](https://developers.gigya.com/display/GD/Swift+SDK)
- [Нестабильность SWIFT 5,1 ABI](https://swift.org/blog/swift-5-1-released/)
- [Свифтрунтимесуппорт NuGet](https://www.nuget.org/packages/Xamarin.iOS.SwiftRuntimeSupport/)
- [Автоматизация UITest в Xamarin](https://docs.microsoft.com/appcenter/test-cloud/uitest/)
- [Конфигурация Xamarin. iOS UITest](https://docs.microsoft.com/appcenter/test-cloud/preparing-for-upload/xamarin-ios-uitest)
- [Аппцентер Test Cloud](https://docs.microsoft.com/appcenter/test-cloud/preparing-for-upload/xamarin-ios-uitest)
- [Пример репозитория проекта](https://github.com/xamcat/xamarin-binding-swift-framework)
