---
title: Привязка библиотек SWIFT для iOS
description: В этом документе описывается, как создавать привязки C# к коду SWIFT, что позволяет использовать собственные библиотеки и CocoaPods в приложении Xamarin. iOS.
ms.prod: xamarin
ms.assetid: 890EFCCA-A2A2-4561-88EA-30DE3041F61D
ms.technology: xamarin-ios
author: alexeystrakh
ms.author: alstrakh
ms.date: 02/11/2020
ms.openlocfilehash: f678ec02ca5b9b47f6f78eea77547b038274190f
ms.sourcegitcommit: 00e6a61eb82ad5b0dd323d48d483a74bedd814f2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91435513"
---
# <a name="bind-ios-swift-libraries"></a>Привязка библиотек SWIFT для iOS

> [!IMPORTANT]
> В настоящее время рассматривается возможность использования настраиваемых привязок на платформе Xamarin. Примите участие в [**этом опросе**](https://www.surveymonkey.com/r/KKBHNLT), чтобы помочь определить дальнейшие направления разработки.

Платформа iOS, а также ее собственные языки и средства постоянно развиваются, и существует множество сторонних библиотек, разработанных с использованием новейших предложений. Максимизация повторного использования кода и компонентов является одной из основных целей кросс-платформенной разработки. Возможность повторного использования компонентов, созданных с помощью SWIFT, становится все более важной для разработчиков Xamarin, так как их популярность растет в развитии разработчиков. Возможно, вы уже знакомы с процессом привязки стандартных библиотек [цели-C](../binding-objective-c/walkthrough.md) . Теперь доступна дополнительная документация, описывающая процесс [привязки к платформе SWIFT](walkthrough.md), поэтому она может использоваться приложением Xamarin таким же образом. Цель этого документа — описать высокоуровневый подход к созданию привязки SWIFT для Xamarin.

## <a name="high-level-approach"></a>Обобщенный подход

С помощью Xamarin можно привязать любую собственную библиотеку стороннего производителя для использования приложением Xamarin. SWIFT — это новый язык, и для создания привязки библиотек, созданных на этом языке, требуются некоторые дополнительные действия и средства. Этот подход предусматривает следующие четыре шага:

1. Создание собственной библиотеки
1. Подготовка метаданных Xamarin, которая позволяет средствам Xamarin создавать классы C#
1. Создание библиотеки привязок Xamarin с помощью собственной библиотеки и метаданных
1. Использование библиотеки привязки Xamarin в приложении Xamarin

В следующих разделах эти действия описаны более подробно.

### <a name="build-the-native-library"></a>Создание собственной библиотеки

Первым шагом является готовность собственной платформы SWIFT с созданным заголовком цели-C. Этот файл представляет собой автоматически сформированный заголовок, который предоставляет нужные классы, методы и поля SWIFT, делая их доступными для цели-C и в конечном счете на C# через библиотеку привязок Xamarin. Этот файл находится в пределах платформы по следующему пути: ** \<FrameworkName> . Framework/Headers/ \<FrameworkName> -SWIFT. h**. Если предоставленный интерфейс содержит все необходимые элементы, можно перейти к следующему шагу. В противном случае для предоставления этих элементов требуются дальнейшие действия. Этот подход будет зависеть от того, есть ли у вас доступ к исходному коду платформы Swift:

- Если у вас есть доступ к коду, вы можете снабдить обязательные элементы SWIFT `@objc` атрибутом и применить несколько дополнительных правил, чтобы позволить средствам построения Xcode известно, что эти члены должны быть представлены в мире цели-C и в заголовке.
- Если у вас нет доступа к исходному коду, необходимо создать инфраструктуру прокси-сервера SWIFT, которая создает оболочку для исходной платформы SWIFT и определяет открытый интерфейс, необходимый для приложения с помощью `@objc` атрибута.

### <a name="prepare-the-xamarin-metadata"></a>Подготовка метаданных Xamarin

Вторым шагом является подготовка интерфейсов определения API, которые используются в проекте привязки для создания классов C#. Эти определения можно создать вручную или автоматически с помощью инструмента " [целевое Шарпие](../../../cross-platform/macios/binding/objective-sharpie/index.md) " и упомянутого выше файла заголовка "автоматическое создание" ** \<FrameworkName> -SWIFT. h** . После создания метаданных их необходимо проверить и проверить вручную.

### <a name="build-the-xamarinios-binding-library"></a>Создание библиотеки привязки Xamarin. iOS

Третий шаг — создать специальный проект — Библиотека привязки Xamarin. iOS. Он ссылается на платформы и метаданные, подготовленные на предыдущем шаге, а также на любые дополнительные зависимости, с которыми зависит соответствующая платформа. Он также обрабатывает связывание собственных платформ, на которые имеются ссылки, с помощью приложения Xamarin. iOS.

### <a name="consume-the-xamarin-binding-library"></a>Использование библиотеки привязки Xamarin

Четвертый и последний шаг — ссылка на библиотеку привязки в приложении Xamarin. iOS. Достаточно разрешить использование собственной библиотеки в приложениях Xamarin. iOS, предназначенных для iOS 12,2 и более поздних версий. Для приложений, предназначенных для более ранней версии, требуются некоторые дополнительные действия.

- Добавление dylib зависимостей для поддержки среды выполнения. Начиная с iOS 12,2 и SWIFT 5,1, язык стал ABI (двоичный интерфейс приложения) стабильным и совместимым. Вот почему все приложения, предназначенные для более ранней версии iOS, должны включать в себя зависимости SWIFT дилибс, используемые платформой. Используйте [пакет NuGet свифтрунтимесуппорт](https://www.nuget.org/packages/Xamarin.iOS.SwiftRuntimeSupport/) для автоматического включения необходимых зависимостей dylib в полученный пакет приложения.
- Добавьте папку **свифтсуппорт** с подписанным дилибс, который проверяется AppStore во время передачи. Пакет должен быть подписан и распространен на AppStore Connect с помощью средств Xcode, в противном случае он будет автоматически отклонен.

## <a name="walkthrough"></a>Пошаговое руководство

Приведенный выше подход описывает действия высокого уровня, необходимые для создания привязки SWIFT для Xamarin. При подготовке этих привязок на практике, необходимо предпринять множество ситуативных действий, включая адаптацию к изменениям в собственных инструментах и языках. Этот документ призван помочь вам получить более глубокое представление об этой концепции и общем характере действий, связанных с этим процессом. Подробное пошаговое руководство см. в документации по [привязке Xamarin SWIFT](walkthrough.md) .

## <a name="related-links"></a>Связанные ссылки

- [Xcode](https://apps.apple.com/us/app/xcode/id497799835)
- [Visual Studio для Mac](https://visualstudio.microsoft.com/downloads)
- [Objective Sharpie](../../../cross-platform/macios/binding/objective-sharpie/index.md)
- [Проверка метаданных Шарпие](../../../cross-platform/macios/binding/objective-sharpie/platform/verify.md)
- [Цель привязки — платформа C](../binding-objective-c/walkthrough.md)
- [Пакет SDK для Gigya iOS (платформа SWIFT)](https://developers.gigya.com/display/GD/Swift+SDK)
- [Нестабильность SWIFT 5,1 ABI](https://swift.org/blog/swift-5-1-released/)
- [Свифтрунтимесуппорт NuGet](https://www.nuget.org/packages/Xamarin.iOS.SwiftRuntimeSupport/)
- [Автоматизация UITest в Xamarin](/appcenter/test-cloud/uitest/)
- [Конфигурация Xamarin. iOS UITest](/appcenter/test-cloud/preparing-for-upload/xamarin-ios-uitest)
- [Аппцентер Test Cloud](/appcenter/test-cloud/preparing-for-upload/xamarin-ios-uitest)
- [Репозиторий примеров проектов](https://github.com/xamcat/xamarin-binding-swift-framework)