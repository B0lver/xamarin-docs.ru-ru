---
title: Широкая цветовая палитра в Xamarin.iOS
description: В этом документе рассматриваются широкая цветовая палитра и как он может использоваться в приложении Xamarin.iOS и Xamarin.Mac. Он также содержит обзор многих важных цветовые понятий цветовых пространств, каналы и базами данных-источниками.
ms.prod: xamarin
ms.assetid: 576E978A-F182-489A-83E4-D8CDC6890B24
ms.technology: xamarin-ios
author: lobrien
ms.author: laobri
ms.date: 03/17/2017
ms.openlocfilehash: f139bcceda12752e43a3a8330fa0a0e038e539f9
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61423591"
---
# <a name="wide-color-in-xamarinios"></a>Широкая цветовая палитра в Xamarin.iOS

_В этой статье рассматриваются широкая цветовая палитра и как он может использоваться в приложении Xamarin.iOS и Xamarin.Mac._

iOS 10 и macOS Sierra улучшает поддержку форматы пикселей расширенный диапазон и широким пробелы во всей системе, включая платформы, такие как двухмерной графики, образ основных компонентов, исходного состояния системы и AVFoundation. Поддержка устройств с дисплеями широкая цветовая палитра дальнейшей менее жесткими, предоставляя это поведение во всем стеке всей графики.

## <a name="about-wide-color"></a>О широкая цветовая палитра

Как уже говорилось, iOS 10 и macOS Sierra улучшает поддержку форматы пикселей расширенный диапазон и широким пробелы во всей системе, включая платформы, такие как двухмерной графики, образ основных компонентов, исходного состояния системы и AVFoundation. Поддержка устройств с дисплеями широкая цветовая палитра дальнейшей менее жесткими, предоставляя это поведение во всем стеке всей графики.

В 90 компания Apple создала ColorSync для обработки на компьютере Mac. цвет маркера Они также помогли найти International Color Консорциуме для создания и повысить уровень набор стандартов для обработки цвет на компьютерное оборудование. Работа Apple с ICC был включен в ColorSync и оно было создано в основных понятиях OS X (теперь называется macOS).

Apple был передовых технологий оборудования, такого как Retina отображения, новый отображения P3 и отображения P3 цветового пространства (выпущенной в iMac в 2015 г.) для отображения и отображает TrueTone в преимуществах iPad, iPhone 7 и iPhone 7, а также.

Широкая цветовая палитра в macOS Sierra и iOS 10 Apple, изменяется механизм обработки цвета, чтобы воспользоваться всеми преимуществами этих технологий отображения устройств iOS и macOS.

## <a name="core-color-concepts"></a>Основные понятия цвет

Просмотрите основные понятия цвет должно распространяться перед созданием более глубокое рассмотрение цвет в macOS и iOS:

### <a name="color-space"></a>Цветовое пространство

Цветовое пространство — это среда, в котором можно представить и по сравнению с цвета. Это может быть от одной до четырех мерного пространства определяется интенсивностью его компонентов цвета. 

[![](wide-color-images/color00.png "Цветовое пространство")](wide-color-images/color00.png#lightbox)

### <a name="color-channels"></a>Цветовые каналы

Компонентов цвета можно также обращаться как к цветовых каналов. Некоторые знакомых представления будет RGB пробелы, пробелы серого цвета, CMYK пробелы или устройства независимых пробелы. 

[![](wide-color-images/color02.png "Компонентов цвета можно также обращаться как к цветовых каналов")](wide-color-images/color02.png#lightbox)

### <a name="color-primaries"></a>Основные цвета

Основные цвета предоставляют системы координат, которая используется для сравнения и вычисления цветов. Основные цвета обычно делятся на самом сильная версии данного цвета, которая может быть создана в цветовой канал.

[![](wide-color-images/color01.png "Системы координат, которая используется для сравнения и вычисления цветов предоставляют основные цвета")](wide-color-images/color01.png#lightbox)

В случае цветовое пространство RGB, представленный выше, где находятся основные цвета `1.0` являются закрепленными координаты (такие как `[1.0, 0.0, 0.0]` красный).

### <a name="color-gamut"></a>Цветовая палитра

Цветовая палитра ссылается на все цвета, которые могут быть определены как сочетание отдельных цветовые каналы в цветовом пространстве предоставленного.

[![](wide-color-images/color03.png "Пример цветовой гаммы цвет")](wide-color-images/color03.png#lightbox)

## <a name="what-is-wide-color"></a>Что такое широкая цветовая палитра

Прежде чем переходить к теме широкая цветовая палитра, обсуждение должно было о текущем отраслевой стандарт для цвета, стандартная цветовое пространство RGB (sRGB). Он является наиболее широко используемых цветовое пространство в вычислениях сегодня и пространстве цветов по умолчанию для iOS и macOS.

SRGB цветовое пространство имеет следующие свойства:

- Он основан на стандарте BT.709 ITU-R.
- Он имеет приблизительное гаммы 2.2.
- Он представляет типичный освещении (D65).

Поскольку sRGB широко используется в отрасли, разработчик может сделать некоторые предположения, является цветом, указанным будут точно представлены на любом устройстве, на котором он отображается на. Тем не менее это может не всегда быть так. Кроме того существует несколько цветов, которые не помещаются в sRGB цветовое пространство и поэтому, не могут быть представлены в нем.

Например многие Текстильные изделия разработаны с потоков с помощью многих чернил и используются падает за пределами sRGB. Также многие продукты, которые обнаруживает человека в их повседневной жизни создаются с использованием ярких яркие цветов, которые выходят за пределы sRGB цветового пространства. Некоторые из наиболее привлекательных примеров цветов, которые не могут быть представлены в sRGB моментов по своей природе sunsets, Осенние листья, экзотических Цветы и тропических waters.

Пользователей, которые записи цифровых изображений в формате RAW может иметь изображений на устройствах, которые содержат все данные этого цвета, несмотря на то, что он не может быть неправильно отражено в sRGB цветовое пространство и поэтому невозможно правильно отобразить на экране.

### <a name="the-display-p3-color-space"></a>Display P3 цветового пространства

В 2015 г. Apple выпустила новые продукты (iMac и iPad Pro 9,7"), которые предоставляют новые Display P3 цветовое пространство для обработки ошибок, созданных sRGB цветового пространства.

[![](wide-color-images/color04.png "Новый Display P3 цветового пространства")](wide-color-images/color04.png#lightbox)

Цветовое пространство Display P3 имеет следующие свойства:

- Поддерживает широкую цветовую пробел для современных аппаратных платформ.
- На основе DCI SMPTE-P3 стандарта. DCI P3 была разработана для цифровых проекторы, но был изменен с Apple для поддержки мониторов.
- Он имеет приблизительное гаммы 2.2.
- Он представляет типичный освещении (D65).

В соответствии с Apple пользователи переходят свои рабочие процессы в их мобильных платформ. Разрешение проблемы презентации цвет, представленный sRGB в профессиональных мобильных устройств (iPad специалистов), требуется больше, чем просто включая расширенный Цветной дисплей. Одно из решений было обновление калибровки фабрики, поэтому на обеспечение фабрики, что от устройства к устройству, Цветной дисплей точных и согласованных откалиброван каждого отдельного устройства.

Другим решением является включение управления полных, системные цвета, построенный Apple в iOS 10 и macOS Sierra. 

### <a name="the-extended-range-srgb-color-space"></a>Extended Range sRGB цветового пространства

Новый цвет всей системы управления iOS 10 должен учитывать все существующие приложения iOS, которые создаются и настроено для работы sRGB. Он был разработан, чтобы убедиться, что его не повлиять на производительность цвет представление или приложение из эти существующие приложения, либо.

Чтобы решить эту проблему, Apple включила Extended Range sRGB цветового пространства в iOS 10 (и macOS Sierra).

Extended Range sRGB цветовое пространство имеет следующие свойства:

- Имеет все же sRGB базами данных-источниками.
- Он имеет приблизительное гаммы 2.2.
- Он представляет типичный освещении (D65).
- Он поддерживает отрицательные значения и значения больше единицы (1).

Обеспечить возможность значения меньше нуля и больше единицы, Extended Range sRGB, цветовое пространство позволяет не только для существующих приложений присутствует цвета в sRGB без снижение производительности или искажения, но он позволяет цветовое пространство для представления любой цвет внутри видимой спектра. Все это выполняется, сохраняя при этом же узловые точки как sRGB цветового пространства.

### <a name="extended-range-srgb-in-action"></a>Расширенные Range sRGB в действии

Чтобы увидеть, как значения вне 0 и 1 работают в Extended Range sRGB цветовое пространство, рассмотрим следующий пример из насыщенность красного в цветовом пространстве Display P3:

[![](wide-color-images/color05.png "Принципы работы значения вне нуль и единицу в Extended Range sRGB цветового пространства")](wide-color-images/color05.png#lightbox)

В Display P3, этот цвет будет представлено как `[1.0, 0.0, 0.0]` и Extended Range sRGB, было бы `[1.358, -0.074, -0.012]`. Так как значения sRGB полны автономных внутри Display P3 и Display P3 значения размещения «за пределами» диапазонов sRGB.

Для физического оборудования, которое допускает значения пикселей для перехода с extreme положительного extreme отрицательные значения она может отображать любой цвет, доступных в видимом спектре и эти значения могут быть представлены в Extended Range sRGB цветового пространства.

### <a name="device-pixel-formats"></a>Форматы пикселей устройства 

Стандартизировать sRGB, цветового пространства был главным образом с использованием формата пикселей 8-разрядных, так как 8 бит на канал цвета по большей части достаточно для описания цвета sRGB. Это не идеально, но достаточно хорошо, и он дает хороший компромисс между использования памяти и процессора для отображения изображений.

Поскольку Display P3 может представлять координаты цвета за пределами пространстве цветов sRGB, требуется 16 бит на канал цвета для правильного отображения цветов с Extended Range sRGB цветового пространства.

## <a name="system-wide-wide-color-support"></a>Широкая цветовая палитра уровня системы поддержки

Для полной поддержки широкая цветовая палитра и обширном внутри iOS 10 и Mac OS Sierra, Apple расширила следующие платформы, чтобы воспользоваться всеми преимуществами цветового пространства Extended Range sRGB и Display P3:

- UIKit (только для iOS)
- SceneKit
- Core Graphics
- ImageIO
- Образ основных компонентов
- WebKit
- SpriteKit
- Core Animation
- AppKit (для macOS)

Кроме того отображает дисплей Retina, поддержка была расширена для Extended Range sRGB цветового пространства и Display P3.

Широкая цветовая палитра поддерживается и может использоваться в следующих типов содержимого приложения:

- Статическое изображение ресурсы, включенные в пакет приложений.
- Документ и сети на основе графических ресурсов.
- Дополнительных носителей, например Live фотографии или изображения в формате RAW.
- Трехмерные изображения текстур шейдера графики.

## <a name="solving-the-color-problem"></a>Решение проблемы цвет

Содержимое, отображаемое в приложении могут поступать из широкого диапазона источников большим количеством цветов. Кроме того это содержимое может отображаться на широкий спектр устройств, каждый из которых собственный диапазон возможностей отображения цвета.

Приложение iOS 10 ликвидирует разницу между эти две проблемы, с помощью новых встроенных, системные цвета управление системы. Эта система позволяет гарантировать, что изображение выглядит так же, на любом устройстве iOS, независимо от того, какие цветового пространства изображение было закодировано в.

Управление цветом начинается с каждого изображения, связанного цветовом пространстве (или цветовой профиль). Эта информация используется в _процесс сопоставления цвет_ где цветов в исходный образ, сопоставляются с цветов в устройстве вывода. Поскольку каждый пиксел в образе должны быть сопоставлены цвет, его можно много времени и привести к перегрузке на ЦП устройства.

Из-за природы _процесс сопоставления цвет_, это преобразование может быть потенциально «потерь», если для устройства вывода меньшего размера спектром, чем исходное изображение.

К счастью, результаты вычислений, которые необходимо выполнить в _процесс сопоставления цвет_ могут легко быть аппаратным ускорением (либо на ЦП или GPU) и Apple гарантирует, что он работает автоматически, создав поддержки в базовых систем, таких как Quartz 2D ColorSync и базовой анимации. Содержимое, правильно с тегами Чтобы воспользоваться преимуществами этих функций необходим без написания кода.

Управление цветом поддерживается на каждой платформе следующим образом:

- **macOS** -macOS был цветокоррекции с момента создания.
- **iOS** -iOS занимался поддержкой управления автоматической цветовой начиная с iOS 9.3 (и более поздние версии).

### <a name="designing-for-wide-gamut"></a>Разработка для обширном

Apple имеет следующие предложения по проектированию и с помощью расширенных цвета, обширном графического содержимого в приложениях iOS и macOS:

- Использовать только содержимое обширном там, где в убедитесь находить в приложении, они не должны автоматически использоваться везде.
- Используйте только содержимое обширном где яркие цвета будет повысить удобство работы пользователей.
- В нет необходимости изменять все содержимое для P3 для существующих приложений.

Цепочка инструментов Apple делает поддержка содержимого образа обширном постепенное согласиться, поэтому поддержка широкая цветовая палитра в приложении не отдельных ситуации.

### <a name="upgrading-existing-content-to-wide-color"></a>Обновление существующего содержимого до широкая цветовая палитра

Apple имеет следующие рекомендации по обновлению существующего содержимого образа до широкая цветовая палитра.

- Не просто «назначение» P3 профиля к содержимому в образе, изменении приложения. Это будет просто сопоставить существующий цвет содержимого в новый пул цвет приведет к непредвиденным результатам, например растягивания цвета и не помещаются в новое пространство, таким образом изменение изображения.
- Содержимое изображения необходимо «преобразовать» в профиль Display P3, используя образ изменения приложения.

### <a name="file-formats-and-color-profiles"></a>Форматы файлов и профили цветов

Apple имеет следующие рекомендации для форматов файлов и профили цветов, используемых в содержимое образа широкая цветовая палитра приложения:

- Используйте «Display P3» цветовой профиль для RGB рабочие пространства.
- Используйте 16 бит на канал цветовой режим.
- Использовать iMac Late 2015 (или более поздней версии) для точного предварительного просмотра содержимого образа.
- Экспортируйте графические активы в виде 16-разрядных PNG-файлы с встроенным профилем ICC «Display P3».

> [!IMPORTANT]
> С помощью **сохранить для веб-** или **Экспорт активы** реализованные в наиболее популярных образ изменения программного обеспечения _не_ работают широкий цветных изображений, так как эти функции не были Теперь еще поддерживает спецификации формата необходимый файл.

### <a name="supporting-wide-color-with-asset-catalogs"></a>Поддержка широкая цветовая палитра с каталоги активов

В iOS 10 и macOS Sierra Apple был расширен каталоги активов используются для включения и классификации содержимого статическое изображение в пакет приложения для поддержки широкая цветовая палитра.

С помощью каталоги активов обеспечивает следующие преимущества для приложения:

- Они обеспечивают наилучший вариант развертывания для средств статическое изображение.
- Они поддерживают автоматической цветовой коррекции.
- Они поддерживают автоматическое пикселей формат оптимизации.
- Они поддерживают приложения срезов и Thinning приложения, который гарантирует, что только содержимое, которое является соответствующие get доставлены на устройство пользователя.

Широкая цветовая палитра поддержки Apple внес следующие улучшения в каталоги активов:

- Они поддерживают 16-разрядное (для каждого цветового канала) исходного содержимого.
- Они поддерживают каталогизации содержимое, отображаемое цветовой гаммы. Содержимое можно пометить как sRGB или охваты Display P3.

Разработчик имеет три варианта для поддержки широкая цветовая палитра содержимое в своих приложениях:

1. **Ничего не делать** -так, как содержимое широкая цветовая палитра следует использовать только в ситуациях, когда приложению необходимо отобразить яркие цвета (где они будут повысить удобство работы пользователей), как следует оставить содержимое за пределами этого требования-является. Она будет продолжать отрисовываться неправильно во всех ситуациях оборудования.
2. **Обновление существующего содержимого до Display P3** -это требует, чтобы разработчик заменить существующее содержимое образа в их каталог активов новый обновленный файл в формате P3 и пометить его как таковой в редакторе ресурсов. Во время сборки класс, производный от образа sRGB будут созданы из этих ресурсов.
3. **Предоставляют оптимизированные средства содержимого** -в этом случае разработчик будет предоставить 8-разрядное sRGB и Display P3 концепции 16-разрядное каждого изображения в каталоге ресурсов (должным образом с тегом в редакторе ресурсов).

### <a name="asset-catalog-deployment"></a>Ресурс каталога развертывания

Когда разработчик отправляет приложению Store приложения с каталоги активов, включить содержимое образа широкая цветовая палитра будет произойти следующее:

- Когда приложение развертывается для конечного пользователя, приложение Фрагментирование обеспечит доставлялось только соответствующий вариант содержимого на устройстве пользователя.
- На устройстве, не поддерживают широкая цветовая палитра существует плата не взимается полезных данных для включения содержимого широкая цветовая палитра, как никогда не отправляется на устройство.
- `NSImage` в macOS Sierra (и более поздней версии) автоматически выберет лучший содержимого представление для отображения оборудования.
- Содержимое, отображаемое, автоматически обновляются при или оборудования устройства отображения, изменения характеристики.

### <a name="asset-catalog-storage"></a>Хранилище каталога активов

Хранилище каталога активов имеет следующие свойства и ограничения в отношении приложения:

- Во время сборки Apple пытается оптимизировать хранение образа содержимого через преобразование изображений высокого качества.
- 16-бит используются на канал цвета для содержимого широкая цветовая палитра.
- Сжатие содержимого зависимые изображений используется снизить конечного результата размеры содержимого. Для дальнейшей оптимизации размеров содержимого были добавлены новые сжатия «с потерей данных».

## <a name="colors-in-user-interfaces"></a>Цвета в пользовательском интерфейсе

При работе с цветами в пользовательском интерфейсе пикселей на экране большинство сплошным цветом. Кроме того большая часть этих пикселей не поступают из ресурсов изображений, но рисуются непосредственно приложением (или операционной системы от имени приложения).

Цвет обширном может представлять некоторые сложности, при работе на уровне пользовательского интерфейса:

- **Взаимодействие цвета** — при работе с этими цвет проектировщиков и разработчиков, обычно _предполагается, что_ sRGB, участвующих в цветовом пространстве. Таким образом, цвет может передать как `rgb(128, 45, 56)` или `#FF0456`. В структуре обширном эти представления не предоставляли достаточно информации для точного представления указанного цвета, работающий цветового пространства также должен быть включен. Apple предлагает использовать `P3(128, 45, 56)` и `P3#FF0456` вместо этого. 
- **Выбор цвета** — большая часть популярного образа редактирования и разработки программного обеспечения страдал те же ограничения, что sRGB цветового пространства при использовании их встроенных палитр. Конструктор следует убедиться, что они находятся в пространстве цветов «Display P3» в средстве выбора цвета при работе с оформлением, широкая цветовая палитра.
- **Кодирование цвета** — оба `NSColor` (macOS) и `UIColor` (iOS и tvOS) имеют новые удобные методы для создания цвета P3 напрямую, и оба были расширены для поддержки цвета в Extended Range sRGB цветового пространства также.
- **Сохранение цветов** -следует соблюдать осторожность, когда хранение обширном цвета в документе приложения. Там, где 8-бит на канал цвета, работал правильно, для пространстве цветов sRGB 16 бит на канал цвета можно использовать для широкого цветов. Разработчику необходимо также следить за экземпляры принятой цветового пространства (поскольку все, что традиционно было только sRGB).

## <a name="colors-on-the-web"></a>Цвета в Интернете

Следует соблюдать осторожность при работе с широкая цветовая палитра веб-страниц и на устройствах, поддерживающих широкий Цветной дисплей. Если все содержимое изображения, которое было добавлено на веб-сайте соответствующие теги, iOS и macOS будет автоматически цвета соответствия и отобразить их правильно.

Медиа-запросами также доступны для решения ресурсы между устройствами, поддерживающими P3 и sRGB:

```xml
<picture>
    <source srcset="monkey-p3.jpg" media="(color-gamut: p3)">
    <source srcset="monkey-rpg.jpg">
</picture>
```

Apple также имеет предложение WebKit, который позволит CSS в других цветовых пространств помимо пространство принятой sRGB.

## <a name="rendering-off-screen-images-in-app"></a>Подготовка к просмотру изображения вне экрана в приложении

В зависимости от типа создаваемого приложения, он может предоставить пользователю для включения содержимого образа, они были собраны из Интернета или создать образ содержимое непосредственно внутри приложения (например, векторного рисунка приложения, например).

В обоих случаях приложение может отображать необходимые изображения вне экрана в широкая цветовая палитра, используя расширенные функции, добавленные для iOS и macOS.

### <a name="drawing-wide-color-in-ios"></a>Широкая цветовая палитра рисование в iOS

Прежде чем обсуждать как правильно нарисовать изображение широкая цветовая палитра в iOS 10, взгляните на следующий общий код рисования iOS:

```csharp
public UIImage DrawWideColorImage ()
{
    var size = new CGSize (250, 250);
    UIGraphics.BeginImageContext (size);

    ...
    
    UIGraphics.EndImageContext ();
    return image = UIGraphics.GetImageFromCurrentImageContext ();
}
```

Существуют проблемы с стандартный код, который будет необходимо решить _перед_ может использоваться для рисования изображения широкая цветовая палитра. `UIGraphics.BeginImageContext (size)` Метод, используемый для запуска iOS Рисование изображения имеет следующие ограничения:

- Не удается создать образ контексты с более чем 8 битами на канал цвета.
- Он не может представлять цветов в Extended Range sRGB цветового пространства.
- Он имеет возможность предоставить интерфейс создания контекстов в цветовом пространстве не sRGB из-за низкого уровня C подпрограммы, вызываемой в фоновом режиме.

Чтобы обрабатывать эти ограничения и нарисовать широкая цветовая палитра изображение в iOS 10, вместо этого используйте следующий код:

```csharp
public UIImage DrawWideColorImage ()
{
    var size = new CGSize (250, 250);
    var render = new UIGraphicsImageRenderer (size);

    var image = render.CreateImage ((UIGraphicsImageRendererContext context) => {
        var bounds = context.Format.Bounds;
        CGRect slice;
        CGRect remainder;
        bounds.Divide (bounds.Width / 2, CGRectEdge.MinXEdge, out slice, out remainder);

        var redP3 = UIColor.FromDisplayP3 (1.0F, 0.0F, 0.0F, 1.0F);
        redP3.SetColor ();
        context.FillRect (slice);

        var redRGB = UIColor.Red;
        redRGB.SetColor ();
        context.FillRect (remainder);
    });

    // Return results
    return image;
}
```

Новый `UIGraphicsImageRenderer` класс создает новый контекст образа, который может обрабатывать Extended Range sRGB цветовое пространство, и он обладает следующими функциями:

- Это полностью управляемый по умолчанию цвет.
- Он поддерживает Extended Range sRGB цветового пространства по умолчанию.
- Интеллектуально решает, если он должен отрисовываться соответствии с sRGB и Extended Range sRGB цветовое пространство на основе возможностей устройства iOS под управлением приложения.
- Он полностью и автоматически управляет контекстом изображений (`CGContext`) время существования, так что разработчик не нужно беспокоиться о вызове начинаются и заканчиваются контекстные команды.
- Она стала совместима с `UIGraphics.GetCurrentContext()` метод.

`CreateImage` Метод `UIGraphicsImageRenderer` класса вызывается, чтобы создать образ широкая цветовая палитра и передается с контекстом изображения для рисования в завершающий обработчик. Вся рисунка выполняется внутри этого обработчика завершения следующим образом:

- `UIColor.FromDisplayP3` Метод создает новый других красным цветом в обширном Display P3 цветового пространства и используется для рисования в первой половине прямоугольника. 
- Вторая половина прямоугольника рисуется в обычном sRGB, полностью насыщенными красный цвет для сравнения.

### <a name="drawing-wide-color-in-macos"></a>Широкая цветовая палитра рисование в macOS

`NSImage` Класс была расширена в macOS Sierra для поддержки Рисование изображения широкая цветовая палитра. Пример:

```csharp
var size = CGSize(250,250);
var wideColorImage = new NSImage(size, false, (drawRect) =>{
    var rects = drawRect.Divide(drawRect.Size.Width/2,CGRect.MinXEdge);
    
    var color = new NSColor(1.0, 0.0, 0.0, 1.0).Set();
    var path = new NSBezierPath(rects.Slice).Fill();
    
    color = new NSColor(1.0, 0.0, 0.0, 1.0).Set();
    path = new NSBezierPath(rects.Remainder).Fill();
    
    // Return modified
    return true;
});
```

## <a name="rendering-on-screen-images-in-app"></a>Подготовка к просмотру на экране изображений в приложении

Для подготовки к просмотру широкая цветовая палитра изображения на экране, этот процесс работает аналогично рисованию изображения вне экрана широкая цветовая палитра для macOS и iOS, представленной выше.

### <a name="rendering-on-screen-in-ios"></a>Подготовка к просмотру на экране в iOS

Если приложению необходимо отобразить изображение в расширенный цвет на экране в iOS, переопределяют `Draw` метод `UIView` рассматриваемый как обычно. Пример:

```csharp
using System;
using UIKit;
using CoreGraphics;

namespace MonkeyTalk
{
    public class MonkeyView : UIView
    {
        public MonkeyView ()
        {
        }

        public override void Draw (CGRect rect)
        {
            base.Draw (rect);

            // Draw the image to screen
            ...
        }
    }
}
``` 

Как и с iOS 10 `UIGraphicsImageRenderer` класс, показанный выше, интеллектуально решает, если он должен обрабатывать в sRGB и Extended Range sRGB цветовое пространство на основе возможностей устройства iOS, о том, когда выполняется приложение `Draw` вызывается метод. Кроме того `UIImageView` цветом, управляемых с момента iOS 9.3.

Если приложение необходимо знать, как рендеринг выполняется на `UIView` или `UIViewController`, можно проверить новый `DisplayGamut` свойство `UITraitCollection` класса. Это значение будет `UIDisplayGamut` перечисления из следующих:

- P3
- SRGB
- Не указан

Если приложение хочет управления цветового пространства, используемого для рисования изображения, можно использовать новый `ContentsFormat` свойство `CALayer` для указания нужного цветового пространства. Это значение может быть `CAContentsFormat` перечисления из следующих:

- Gray8Uint
- Rgba16Float
- Rgba8Uint

### <a name="rendering-on-screen-in-macos"></a>Подготовка к просмотру на экране в macOS

Если приложению необходимо отобразить изображение в расширенный цвет на экране в macOS, переопределяют `DrawRect` метод `NSView` рассматриваемый как обычно. Пример:

```csharp
using System;
using AppKit;
using CoreGraphics;
using CoreAnimation;

namespace MonkeyTalkMac
{
    public class MonkeyView : NSView
    {
        public MonkeyView ()
        {
        }

        public override void DrawRect (CGRect dirtyRect)
        {
            base.DrawRect (dirtyRect);

            // Draw graphics into the view
            ...
        }
    }
}
```

Опять же, он интеллектуально решает, если он должен обрабатывать в sRGB и Extended Range sRGB цветовое пространство, в зависимости от возможностей оборудования Mac, на котором выполняется приложение, о том, когда `DrawRect` вызывается метод.

Если приложение хочет управления цветового пространства, используемого для рисования изображения, можно использовать новый `DepthLimit` свойство `NSWindow` класса, чтобы указать нужный цветового пространства. Это значение может быть `NSWindowDepth` перечисления из следующих:

- OneHundredTwentyEightBitRgb
- SixtyfourBitRgb
- TwentyfourBitRgb

## <a name="summary"></a>Сводка

В этой статье подробно рассматривается широкая цветовая палитра и способы, что он может реализовывать и использовать в приложении Xamarin.iOS и Xamarin.Mac.



## <a name="related-links"></a>Связанные ссылки

- [Примеры iOS 10](https://developer.xamarin.com/samples/ios/iOS10/)
