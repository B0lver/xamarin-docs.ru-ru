---
title: Основные сведения о понятиях SiriKit
description: В этом документе описаны основные понятия, необходимые для работы с SiriKit в приложении Xamarin. iOS. Например, здесь обсуждаются способы и расширения пользовательского интерфейса, разрешения SiriKit, разработка отличного опыта и многое другое.
ms.prod: xamarin
ms.assetid: 99EC5C1E-484F-4371-8555-58C9F60DE37F
ms.technology: xamarin-ios
author: conceptdev
ms.author: crdun
ms.date: 05/02/2017
ms.openlocfilehash: 3b99e4485bfb621b32fa001a49d75038b2072775
ms.sourcegitcommit: 57f815bf0024b1afe9754c0e28054fc0a53ce302
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2019
ms.locfileid: "70769466"
---
# <a name="understanding-sirikit-concepts"></a>Основные сведения о понятиях SiriKit

_В этой статье рассматриваются основные понятия, которые необходимо выполнить для работы с SiriKit в приложении Xamarin. iOS._

Новое в iOS 10, SiriKit позволяет приложению Xamarin. iOS предоставлять службы, доступные пользователю с помощью Siri и приложения Maps на устройстве iOS. Эта функциональная возможность предоставляется в одном или нескольких расширениях приложений с помощью новых **целей** и целей **пользовательского интерфейса** .

SiriKit позволяет приложению iOS предоставлять службы, доступные пользователю, с помощью Siri и приложения Maps на устройстве iOS, используя расширения приложений и новые платформы **пользовательского интерфейса** для **целей** и целей.

Siri работает с понятием **доменов**, группами известных действий для связанных задач. Каждое взаимодействие приложения с Siri должно находиться в одном из известных доменов служб следующим образом:

- Вызов аудио или видео.
- Заменяйте его.
- Управление тренировки.
- Отправка.
- Поиск фотографий.
- Отправка или получение платежей.

Когда пользователь выполняет запрос Siri, включающий одну из служб расширения приложения, SiriKit отправляет расширение объект **намерения** , описывающий запрос пользователя вместе с любыми вспомогательными данными. Затем расширение приложения создает соответствующий объект **ответа** для заданной **цели**, чтобы получить сведения о том, как расширение может справиться с запросом.

## <a name="the-intents-and-intents-ui-extensions"></a>Расширения пользовательского интерфейса для целей и целей

Как Siri, так и приложение Maps взаимодействуют со службами приложения через два разных типа расширений приложений:

- **Расширение целей** — предоставляет Siri и сопоставляется с содержимым приложения и выполняет задачи, необходимые для выполнения любых поддерживаемых целей.
- **Расширение пользовательского интерфейса для целей** . предоставляет НАСТРАИВАЕМЫЙ пользовательский интерфейс, который будет отображаться для содержимого приложения внутри либо Siri, либо карт.

Приложение должно предоставить расширение целей для поддержки SiriKit, и оно несет ответственность за предоставление сведений, которые Siri и Maps могут предоставить пользователю и для обработки целей.

Создание расширения пользовательского интерфейса для целей не является обязательным, так как Siri обычно обрабатывает все взаимодействие с пользователем и имеет стандартный встроенный интерфейс пользователя для представления информации в каждом из поддерживаемых доменов. Предоставляя расширение пользовательского интерфейса для целей, приложение может использовать платформу с **намерением пользовательского интерфейса** для представления многофункционального пользовательского интерфейса с фирменной символикой приложения и дополнительной информацией.

## <a name="siri-and-the-maps-app-role"></a>Siri и роль приложения Maps

Речевые запросы пользователя обрабатываются и Семантическо анализируются с помощью Siri, который преобразует эти запросы в действия, которые могут быть обработаны с помощью выполняемых расширений намерения.

Maps использует расширения намерения приложения для отображения сведений в интерфейсе Map в ответ на действия пользователя. Например, для запроса ближайших ресторанов или получения отзывов о ресторане приложения.

Как Siri, так и карты управляют всеми взаимодействиями пользователя и отображают результаты с помощью стандартного системного интерфейса. Роль расширений приложений в основном предоставляет данные, которые отображаются. При необходимости приложение может предоставить расширение пользовательского интерфейса для целей и предоставить пользовательский интерфейс для расширения системного интерфейса по умолчанию.

## <a name="interacting-with-siri-via-sirikit"></a>Взаимодействие с Siri через SiriKit

В этом разделе будет представлен обзор того, как SiriKit позволяет пользователю взаимодействовать с приложением с помощью Siri. Для этого примера мы будем использовать фиктивное приложение Монкэйчат:

[![](understanding-sirikit-images/monkeychat01.png "Значок Монкэйчат")](understanding-sirikit-images/monkeychat01.png#lightbox)

Монкэйчат сохраняет собственную контактную книгу друзей пользователей, каждый из которых связан с именем экрана (например, Бобо), и позволяет пользователю отправить текстовые обсуждения друг другу по имени экрана.

Существует множество способов, с помощью которых пользователь может инициировать взаимодействие с приложением, так как разные пользователи могут делать один и тот же запрос во многих разных формах.

Например, если пользователь хочет отправить сообщение своим дружественным Бобо, у него может быть следующий диалог с Siri:

_Нажат Эй, Siri, отправить сообщение Монкэйчат._<br />
_Siri Кому?_<br />
_Нажат Бобо._<br />
_Siri Что вы хотите сказать Бобо?_<br />
_Нажат Отправьте больше немедленных поправок._<br />

Другой пользователь может сделать тот же запрос с другим диалогом:

_Нажат Отправка сообщения в Бобо по Монкэйчат._<br />
_Siri Что вы хотите сказать Бобо?_<br />
_Нажат Отправьте больше немедленных поправок._<br />

Другой пользователь может сделать еще более короткий запрос:

_Нажат Монкэйчат Бобо отправляйте больше._<br />
_Siri Ладно, отправляя сообщение, вы отправите больше возможностей в Бобо на Монкэйчат._<br />

Или даже сделать тот же запрос на другом языке:

_Нажат Монкэйчат Бобо с'ил ваус плаîт и де бананес._<br />
_Siri OUI, енвои Message с'ил ваус плаîт делегата Plus de бананес продажам Бобо Sur Монкэйчат._<br />

Но другой пользователь может быть очень подробным в своем диалоге:

_Нажат Привет, Siri, можно использовать и запускать приложение Монкэйчат для отправки текста с сообщением. Отправьте больше неблагоприятных увеличений._<br />
_Siri Кому?_<br />
_Нажат Лучший список PAL Бобо._<br />

Кроме того, существует множество способов, с помощью которых Siri может отвечать на запрос, в зависимости от того, как был сделан запрос:

- **Нажимая кнопку "домой"** — Siri предоставит больше визуальных ответов с ограниченными текстовомми отзывами.
- **По «Эй, Siri»** — Siri больше текстовом и предоставляет меньше визуальных ответов.

Siri также настраивается в соответствии с потребностями специальных возможностей пользователя и будет взаимодействовать и реагировать в соответствии с этими потребностями.

Независимо от того, как был сделан запрос или Siri отвечает на запрос, Siri обрабатывает диалог с пользователем, а приложение (через его расширения) предоставляет функциональные возможности.

Когда пользователь выполняет запрос текстовом Siri, выполняются следующие действия, которые выполняет Siri:

[![](understanding-sirikit-images/monkeychat02.png "Действия, которые будут выполнены Siri")](understanding-sirikit-images/monkeychat02.png#lightbox)

1. Во первых, Siri принимает звук **речи** пользователя и преобразует его в текст.
2. Затем текст преобразуется в **намерение**, структурированное представление запроса пользователя.
3. В зависимости от цели Siri будет предпринимать **действия** по выполнению запроса пользователя.
4. Наконец, Siri будет предоставлять пользователю **ответы** (визуальные и текстовом) в зависимости от выполняемого действия.

Существует три основных способа, с помощью которых приложение может принять участие в беседе пользователя с Siri:

[![](understanding-sirikit-images/monkeychat03.png "Три основных способа, которым приложение может принять участие в беседе пользователей с Siri")](understanding-sirikit-images/monkeychat03.png#lightbox)

1. **Словарь** — это то, как приложение сообщает Siri о том, что им нужно взаимодействовать.
2. **Логика приложения** — это действия и ответы, которые приложение будет принимать на основе определенных целей.
3. **Пользовательский интерфейс** — это необязательный настраиваемый пользовательский интерфейс, в котором приложение может предоставлять свои ответы.

### <a name="example"></a>Пример

Учитывая приведенные выше сведения, изучите, как следующая беседа будет взаимодействовать с приложением Монкэйчат:

_Нажат Эй, Siri, отправьте сообщение в Бобо на Монкэйчат._<br />
_Siri Что вы хотите сказать Бобо?_<br />
_Нажат Отправьте больше немедленных поправок._<br />

Первая роль, которую приложение принимает в диалоге, заключается в том, чтобы помочь Siri понять речь пользователя:

[![](understanding-sirikit-images/monkeychat04.png "Помощь Siri в понимании речи пользователей")](understanding-sirikit-images/monkeychat04.png#lightbox)

В базе данных Siri отсутствует имя "Бобо", но приложение выполняет эти сведения и совместно с ними Siri через свой словарь. Приложение также помогает Siri распознать, что Бобо является получателем, так как он указал его Siri в качестве *контакта*.

Siri знает, что больше требуется для отправки сообщения, чем просто получатель, поэтому он быстро проверяет расширение приложения, чтобы узнать, требуется ли для сообщения содержимое. Так как Монкэйчат, Siri будет отвечать на пользователя с помощью вопроса: *«Что вы хотите сказать Бобо?»*

В приведенном выше примере пользователь ответил: *«отправьте больше «* неменяющих», что Siri будет объединено в структурированную **Цель**.

[![](understanding-sirikit-images/monkeychat05.png "Siri будет объединять ответ пользователя в структурированную намерение")](understanding-sirikit-images/monkeychat05.png#lightbox)

Структурированное намерение будет содержать следующие сведения:

- **Поддомен** Сообщения
- **Намерение:** SendMessage
- **Факсимиль** бобо
- **Содержимое** Отправьте больше немедленных.

Каждый домен имеет набор известных *действий* , которые могут быть выполнены в них и в зависимости от домена и действия. в целях, отправляемых в приложение, может быть включено от нуля до многих параметров.

Затем цель отправляется в расширение приложения для обработки. В результате обработки намерения приложение создаст **интентреспонсе** , который будет объединен с намерением и включать параметры, описывающие, что делало приложение с намерением.

Каждый Интентреспонсе также включает **код ответа** , который сообщает Siri, может ли приложение выполнить запрос. Некоторые домены имеют очень специфические коды ответа об ошибках, которые также можно отправить.

Наконец, интентреспонсе будет включать `NSUserActivity` (как и те, которые используются для поддержки). `NSUserActivity` Будет использоваться для запуска приложения, если в ответе необходимо оставить среду Siri и ввести приложение для его завершения.

Siri автоматически создаст подходящий `NSUserActivity` для запуска приложения и выдаст сообщение о том, что пользователь вышел из среды Siri. Однако при необходимости приложение может предоставить собственное `NSUserActivity` значение с настраиваемыми сведениями.

После того, как приложение обработало намерение и возвращало ответ в Siri, он выводит результаты пользователю (как с помощью команд, так и с визуальным представлением):

[![](understanding-sirikit-images/monkeychat06.png "Результаты, представленные пользователю как в виде глагола, так и визуально")](understanding-sirikit-images/monkeychat06.png#lightbox)

Siri имеет несколько встроенных пользовательских интерфейсов ответа для каждого из доменов, доступных для приложения. Однако, поскольку Монкэйчат предоставил необязательное расширение пользовательского интерфейса, оно используется для представления результатов диалога пользователю в приведенном выше примере.

## <a name="the-intent-lifecycle"></a>Жизненный цикл

Существует три основные задачи, которые необходимо выполнить для расширения приложения при работе с ними.

[![](understanding-sirikit-images/monkeychat07.png "Жизненный цикл")](understanding-sirikit-images/monkeychat07.png#lightbox)

1. Приложение должно **разрешать** каждый параметр события. В результате приложение будет вызывать метод Resolve несколько раз (один раз для каждого параметра) и иногда несколько раз для одного параметра, пока приложение и пользователь не согласны с тем, что запрашивается.
2. Приложение должно **подтвердить** , что оно может решить запрошенное намерение, и сообщить Siri о ожидаемом результате.
3. Наконец, приложение должно **справиться** с намерением и выполнить шаги для достижения запрошенного результата.

### <a name="the-resolve-stage"></a>Этап разрешения

Этап разрешения помогает Siri понять значения, предоставленные пользователем, и гарантирует, что пользователь на самом деле делает то, что произойдет при обработке намерениями приложения.

Этот этап также предоставляет приложению возможность влиять на поведение Siri во время диалога с пользователем. Для этого приложение предоставит **ответ на разрешение**. Существует ряд предопределенных ответов на различные типы данных, распознаваемых Siri.

Наиболее распространенный ответ на разрешение от приложения будет **успешным**, что означает, что приложение сопоставлено с конкретным фрагментом данных из параметра (например, с именем пользователя) и со сведениями, о которых он знает.

Иногда приложению необходимо подтвердить, что данный запрос соответствует правильному фрагменту информации, о котором он знает. В таких случаях он отправляет ответ **конфирматионрекуиред** , чтобы задать пользователю да или не задавать вопрос для пользователя, например *"отправить сообщение в Бобо?".*

Возможны и другие случаи, когда приложение потребует от пользователя выбора из краткого списка вариантов. В этом случае приложение предоставит ответ об устранении **неоднозначности** со списком из двух или десяти вариантов выбора пользователя:

```csharp
Who do you want to message?

* Bobo the Great
* Bobo Jr.
* Little Bobo
```

Siri будет обрабатывать пользователя, выполняя выбор, либо по команде, либо путем взаимодействия с пользовательским интерфейсом Siri, и результат будет отправлен обратно в приложение.

В других случаях может отсутствовать достаточная информация для разрешения параметра приложением, или может быть слишком много совпадений для разрешения проблемы с помощью устранения неоднозначности (например, 80 пользователей с Бобо в имени). В этом случае приложение отправит ответ **нидсморедетаилс** , и Siri предложит пользователю указать более конкретные сведения.

Если пользователь не предоставил значение, необходимое для обработки намерения, он может отправить ответ **нидсвалуе** , чтобы Siri запрашивать у пользователя значение.

Если приложение не поддерживает значение, указанное пользователем для конкретного параметра, оно может отправить ответ **унсуппортедвисреасон** , чтобы указать причину, по которой значение не поддерживалось. Siri запросит у пользователя совершенно новое значение и предоставило ему причину его необходимости.

Наконец, используйте ответ **нотрекуиред** , чтобы сообщить Siri о том, что приложению не требуется значение для данного параметра. Если пользователь предоставляет один из них, он будет просто игнорироваться Siri.

### <a name="the-confirm-stage"></a>Этап подтверждения

Этап Confirm имеет две цели:

- Чтобы сообщить Siri ожидаемый результат обработки намерения, чтобы Siri мог сообщить пользователю, что происходит.
- Предоставляет возможность проверить все обязательные состояния, которые может потребоваться приложению для выполнения запроса, представленного пользователем, например наличие в банке достаточного количества денег для выполнения запрошенного платежа.

Приложение предоставит **ответ с намерением** от шага подтверждения, который должен быть заполнен как часть информации, доступной для приложения, чтобы Siri мог эффективно взаимодействовать с пользователем.

В зависимости от типа домена и действия Siri может запросить у пользователя подтверждение, например перед отправкой платежа или пересчета.

### <a name="the-handle-stage"></a>Этап маркера

Этап handle является наиболее важной частью работы с намерением, так как это точка, в которой приложение выполняет запрос пользователя, выполняя задачу, которой он был выдан.

Точно так же, как и на этапе Confirm, приложение должно предоставить как можно больше сведений о результате, чтобы Siri мог связать его с пользователем. Иногда эти сведения отображаются визуально или в другое время Siri просто говорят пользователю.

Могут возникнуть ситуации, когда приложению может потребоваться дополнительное время для обработки данного запроса, например задержки сетевого вызова, или если пользователю требуется выполнить запрос (например, завершение и доставка заказа или запись автомобиля в расположение пользователя). Когда Siri ожидает ответа от приложения, он будет отображать пользовательский интерфейс ожидания для пользователя, сообщающий ему, что приложение обрабатывает запрос.

В идеале приложение должно предоставлять ответ Siri в течение двух-трех секунд. Если приложение знает, что данный ответ займет больше времени, ему необходимо отправить код ответа на **выполнение** в Siri. Siri сообщит пользователю, что приложение обрабатывает запрос в фоновом режиме, и продолжит это, даже если они покидают среду Siri.

## <a name="adding-sirikit-to-the-app"></a>Добавление SiriKit в приложение

С SiriKit в iOS 10 компания Apple создала две новые точки расширения:

- **Расширение целей** — предоставляет Siri с содержимым приложения и выполняет задачи, необходимые для выполнения любых поддерживаемых целей.
- **Расширение пользовательского интерфейса для целей** . предоставляет НАСТРАИВАЕМЫЙ пользовательский интерфейс, который будет отображаться для содержимого приложений в Siri.

Кроме того, существует API-интерфейс для предоставления слов и фраз, Siri для распознавания в виде:

- **Словарь приложения** — слова и фразы, общие для каждого пользователя приложения.
- **Словарь пользователя** — слова и фразы, уникальные для данного пользователя приложения.

## <a name="the-intents-extension"></a>Расширение целей

Расширение целей отвечает за обработку основных взаимодействий между приложением и Siri следующим образом:

[![](understanding-sirikit-images/intents01.png "Расширение целей")](understanding-sirikit-images/intents01.png#lightbox)

Расширение намерения может поддерживать один или несколько целей, но разработчику нужно решить, как они должны реализовывать SiriKit в приложении. Разработчик также может добавить отдельное расширение намерения для каждой намеренности, требующей обработки.  С другой стороны, Apple запрашивает у разработчика ограничение числа намеренных расширений, чтобы Siri не открывало несколько процессов для приложения, что требует больше памяти и времени для обработки.

Разработчик также должен знать, что в фоновом режиме, когда Siri активен, расширение намерения будет выполняться. Это позволяет Siri активно передавать диалог с пользователем, продолжая взаимодействовать с расширением для обработки информации о запросе.

## <a name="privacy-and-security-considerations"></a>Вопросы конфиденциальности и безопасности

Компания Apple предписала отличные меры для обеспечения безопасности частной информации пользователя при работе с Siri и, таким образом, существует несколько действий, требующих входа пользователя на устройстве iOS. Например, при запросе выдачи или совершении платежа.

Кроме того, существует определенное поведение, которое приложение может захотеть ограничить для пользователя, вошедшего в систему на устройстве. В таких ситуациях приложение может запрашивать ограничение, **пока заблокировано** поведение. Это делается с помощью параметра в `Info.plist` файле.

Локальная инфраструктура проверки подлинности доступна для расширения намерения, поэтому приложение может попросить пользователя получить дополнительные сведения о проверке подлинности, даже если устройство уже разблокировано.

Наконец, Apple Pay доступен для расширения намерения, чтобы приложение могла выполнить транзакцию с помощью Apple Pay и встроенный Apple Payный лист появится над интерфейсом Siri.

Кроме того, Apple хочет убедиться, что пользователи знают, когда они отправляют информацию в стороннее приложение, и, как таковые, пользователь **должен** указать конкретное имя приложения (как указано в отображаемом имени пакета приложения) при выполнении запроса.

Компания Apple разработала Siri для выполнения естественного, жидкостного общения с пользователем, и из-за этого имя пакета приложения можно использовать во многих частях речи, где бы они ни находились в запросе пользователя.

Одна из наиболее распространенных вещей, которую выполняет пользователь, — «вербифи» имя приложения, иными словами, получение имени приложения и его использование в качестве глагола в запросе. Например, *«Монкэйчат Бобо».*

## <a name="the-intents-ui-extension"></a>Расширение пользовательского интерфейса для целей

Расширение пользовательского интерфейса для целей предоставляет возможность перенести пользовательский интерфейс приложения и фирменную символику в Siriный интерфейс и заставить пользователей подключаться к приложению. Благодаря этому расширению приложение может перенести торговую марку, а также визуальную и другую информацию в запись.

[![](understanding-sirikit-images/intents02.png "Примеры выходных данных расширения пользовательского интерфейса")](understanding-sirikit-images/intents02.png#lightbox)

Расширение пользовательского интерфейса для целей всегда возвращает значение, `UIViewController` а приложение может добавить все, что оно нравится, в контроллере представления, например отображение дополнительной информации, которая выходит за пределы первоначального ответа. В пользовательском интерфейсе целей также может быть обновлено состояние длительного события, например, сколько времени займет обмен автомобилями, чтобы достичь своего расположения.

Расширение пользовательского интерфейса для целей всегда будет отображаться вместе с другим содержимым Siri, таким как значок приложения и имя в верхней части пользовательского интерфейса, или, в конце концов, кнопки (например, "Отправить" или "Отмена") могут отображаться внизу.

Существует несколько экземпляров, в которых приложение может заменить сведения, отображаемые Siri, по умолчанию, такие как обмен сообщениями или карты, когда приложение может заменить интерфейс по умолчанию на одно, настроенное для приложения.

> [!IMPORTANT]
> Хотя можно добавить интерактивные элементы `UIButtons` `UIViewController`, например или `UITextFields` в расширение пользовательского интерфейса, они строго запрещены в качестве намеренного пользовательского интерфейса в неинтерактивном режиме, и пользователь не сможет взаимодействовать с ними.

Приложение полностью необязательно для предоставления намеренного расширения пользовательского интерфейса, так как Siri содержит набор элементов пользовательского интерфейса по умолчанию для каждого типа намерения. Кроме того, интерфейсы интерфейса пользователя доступны только для определенных целей, которые были бы полезны для пользователя.

## <a name="adding-sirikit-vocabulary"></a>Добавление словаря SiriKit

Последняя часть реализации SiriKit лежит внутри приложения, предоставляя необходимый словарь. Многие приложения имеют уникальные способы описания информации для пользователя и уникальные способы, которыми пользователь предоставит информацию приложению.

По этой причине для Siri требуется помощь приложения, чтобы понять слова и фразы, уникальные для приложения. Некоторые из этих фраз будут частью приложения, так что каждый пользователь будет знать и понять их. Но другие будут уникальными для конкретного пользователя приложения.

### <a name="app-specific-vocabulary"></a>Словарь для конкретного приложения

Словарь для конкретного приложения определяет конкретные слова и фразы, которые будут известны всем пользователям приложения, таким как типы транспортных средств или имена тренировок. Поскольку они являются частью приложения, они определяются в `AppIntentVocabulary.plist` файле как часть основного пакета приложений. Кроме того, эти слова и фразы должны быть локализованы.

Файл словаря `AppIntentVocabulary.plist` состоит из нескольких частей:

- **Пример использования приложения** . они предоставляют набор типичных вариантов использования запросов, которые пользователь может внести в приложение. Например: *«Начните тренировку с помощью Монкэйфит».*
- **Параметры** . они предоставляют набор нестандартных типов параметров, относящихся к приложению. Например, имена тренировок для приложения Монкэйфит. Они состоят из следующих элементов:
  - **Фраза** . позволяет приложению определять уникальные термины для приложения. Например: тип тренировки "Бананарифик" для приложения Монкэйфит.
  - **Произношение** — подсказка произношения Siri как простое Фонетическое написание для заданной фразы. Например, "BA Нана RI ходом".
  - **Пример** . приводится пример использования заданной фразы в приложении. Например, *"запустить бананарифик в монкэйфит"* .

Дополнительные сведения см. в [справочнике по формату файлов словаря приложения](https://developer.apple.com/library/prerelease/content/documentation/Intents/Conceptual/SiriIntegrationGuide/CustomVocabularyKeys.html#//apple_ref/doc/uid/TP40016875-CH10-SW1)Apple.

### <a name="user-specific-vocabulary"></a>Пользовательский словарь

Пользовательский словарь будет предоставлять слова или фразы, уникальные для отдельных пользователей приложения. Они будут предоставлены во время выполнения из основного приложения (а не из расширений приложения) в виде упорядоченного набора терминов, упорядоченных по наиболее значимому приоритету для пользователей, с наиболее важными условиями в начале списка.

Рассмотрим пример приложения Монкэйчат, представленного выше. Монкэйчат сохраняет список всех контактов пользователя, который будет отправляться в Siri через пользовательский словарь. Кроме того, в нем хранится список из 10 последних контактов, которые пользователь получил в сообщении, и он имеет набор избранных контактов для каждого пользователя. В этом примере Избранные контакты должны находиться в начале словаря конкретного пользователя, за которым следуют последние контакты, а остальные контакты пользователя.

Пользовательские словари поддерживают следующие типы информации:

- Имена контактов.
- Имена тренировок.
- Названия фотоальбомов.
- Ключевые слова Photo.

Если приложение использует адресную книгу iOS, приложение не будет предпринимать никаких действий, так как эта информация уже доступна для Siri. Приложению необходимо предоставить имена контактов только в том случае, если приложение имеет собственную уникальную базу данных контактов.

При проектировании словаря необходимо предоставить только те значения, которые пользователи узнают и волнует. Избегайте предоставления таких сведений, как номера телефонов или адреса электронной почты.

Приложению также необходимо быстро обновлять Siri при изменении словаря, относящегося к пользователю. Пользователи привыкли запрашивать информацию от Siri, которая была добавлена на устройство iOS. Например, если пользователь добавляет в приложение новый контакт, отправьте эту информацию в Siri, как только пользователь сохранит ее.

Что более важно, приложение _должно_ немедленно удалить информацию из словаря Siri, так как пользователь может стать обеспокоен, если он удалил часть информации, но Siri по-прежнему распознал часы или дни позже.

> [!IMPORTANT]
> Приложение должно удалить все пользовательские словари из Siri, если пользователь выбрал сброс или выход из приложения.

## <a name="sirikit-permissions"></a>Разрешения SiriKit

Окончательный элемент SiriKit выравнивается по разрешениям. Точно так же, как и с другими функциями iOS (например, Фото, Камера или контакты), пользователям необходимо предоставить явное разрешение на обмен данными с приложением Siri.

Приложение может предоставить строку, определяющую, какие сведения будут предоставлены Siri, и определить причину, по которой пользователь должен предоставить этот доступ.

Компания Apple предлагает приложению запрашивать разрешение у пользователя на использование Siri при первом открытии приложения пользователем после обновления до iOS 10. Это значит, что пользователи узнают об интеграции Siri и могут заранее утверждать использование до того, как они поступит в первый запрос.

## <a name="sirikit-and-maps"></a>SiriKit и карты

SiriKit является неотъемлемой частью iOS и использует платформу большего размера, добавленную в iOS 10. Платформа целей разработана для совместного использования общих и общих действий и целей с другими частями системы.

Платформа целей выходит за пределы Siri интеграции и предоставляет другие функции, такие как интеграция контактов, когда приложение может стать телефонией или приложением для обмена сообщениями по умолчанию для конкретных контактов. Также обеспечивает глубокую интеграцию с Каллкит для предоставления пользователям оптимального интерфейса VOIP.

Приложение Maps в iOS 10 добавило такие функции, как предоставление общего доступа, при котором пользователь может регистрироваться непосредственно внутри пользовательского интерфейса Maps. SiriKit предоставляет общую точку расширения с картами, поэтому доступ к совместно используемым (и другим) смыслам можно совместно использовать между Siri и Maps.

Это означает, что если приложение использует расширения SiriKit, оно также будет иметь интеграцию с картами бесплатно.

## <a name="designing-a-great-siri-experience"></a>Разработка отличного Siriного интерфейса

Создание отличного пользовательского интерфейса при интеграции приложения в Siri отличается от разработки отличного пользовательского интерфейса приложения. В отличие от обычных ситуаций, когда пользователь взаимодействует с приложением непосредственно на экране, при использовании Siri существует много случаев, когда визуальный интерфейс невидим. Например, когда пользователь начал диалог с *«Эй Siri»* .

### <a name="how-siri-helps-the-developer"></a>Как Siri помогает разработчику

При проектировании взаимодействия приложения с Siri приложение будет создавать *интерфейс диалога*, то есть контекст является производным от диалога, который Siri от имени пользователя.

При отсутствии визуальной ссылки пользователь должен отследить сведения, представленные в их заголовке. В связи с этим Siri предоставляет минимальную информацию, необходимую для достижения задачи, которую пользователь хочет выполнить.

В форме диалогового интерфейса есть вопросы и ответы от пользователя и Siri во время диалога. Поэтому важно подумать о том, как Siri запрашивает вопросы и отвечает при проектировании этого интерфейса.

Возьмем следующий пример, когда пользователь создает сообщение, Siri может ответить на вопрос *"готово к отправке?"* . Пользователь может ответить различными способами, такими как *"Отправить"* , *"Отмена"* или даже что-либо, полностью несвязанное с этим вопросом. Независимо от того, как беседа воспроизводится, Siri обрабатывает его для приложения и отправляет ему соответствующую информацию по мере доступности.

Существует несколько различных способов, с помощью которых пользователь может инициировать диалог с Siri:

- Выбрав устройство, нажмите кнопку Главная. В этом случае Siri будет представлять больше визуальных интерфейсов и меньше текстовом ответов.
- Выполнив слово *«Эй Siri»* и запустив произвольный диалог. В этом случае Siri будет меньше визуального и более текстовом.
- Использование специальных возможностей, например, средств для слуха с поддержкой Bluetooth, когда пользовательский интерфейс будет адаптирован для пользователя с особыми потребностями.
- Использование автомобиля, когда пользователю необходимо следить за тем, чтобы он не был в курсе минимального внимания.

### <a name="how-the-developer-helps-siri"></a>Как разработчик помогает Siri

При интеграции приложения с Siri разработчику необходимо часто тестировать эту интеграцию и убедиться, что они делают множество различных запросов, запрашивая один и тот же фрагмент информации или задачи по мере возможности.

Поскольку ни один из двух людей не считает одинаковым, очень важно, чтобы разработчик применял как можно больше различных тест-инженеров, чтобы помочь оптимизировать интеграцию Siri. Пользователи могут запрашивать информацию или выполнять запросы в тех случаях, когда разработчику не нужно, а такая Точная настройка может помочь обеспечить высокую удобство работы с приложением с помощью Siri.

Тестирование в различных ситуациях и средах. Инициируйте диалоги с Siri всеми способами, чтобы обеспечить непрерывность и естественные беседы. Тестирование в расположениях, где пользователь больше всего будет использовать приложение, как в ГИМ.

Убедитесь, что приложение предоставляет всю информацию, которую Siri требуется для правильного представления запроса и результата пользователю. Это особенно справедливо при использовании Siri в произвольной ситуации.

### <a name="siri-design-guidelines"></a>Рекомендации по проектированию Siri

Всегда помните, что Siri имеет диалог с пользователем от имени приложения. Разработчик хочет, чтобы этот диалог был как можно более гибким и естественным.

Как и при любой важной беседе, разработчику необходимо обеспечить следующее:

- , Что приложение подготовлено для диалога.
- Приложение прослушивает именно то, что пытается выполнить пользователь.
- Приложение запрашивает соответствующие вопросы в нужное время.
- Приложение отвечает на запрос с информацией, которую пользователь ищет.

#### <a name="preparing-for-the-conversation"></a>Подготовка к беседе

В первую очередь следует помнить, что пользователи приложения не будут точно так же, как разработчик. Они могут поступать из разных фоновых рисунков, говорить о разных языках или иметь особые потребности при работе с приложением.

Кроме того, поскольку разработчик разрабатывал и создал приложение, у него есть глубокие знания о приложении и его внутренних функциях, а также о том, какие функции у обычного пользователя не будет. Поэтому разработчик может запросить запрос Siri иначе, чем у обычного пользователя.

Именно поэтому важно иметь как можно больше людей, взаимодействующих с приложением через Siri. Пользователи могут делать запросы к приложению через Siri, которые разработчик никогда не считал, или в том смысле, когда разработчик не рассматривал.

#### <a name="ensure-the-app-is-a-good-listener"></a>Убедитесь, что приложение является хорошим прослушивателем

Разработчику необходимо убедиться, что приложение является хорошим прослушивателем и получает особенности диалога, отвечающего ожиданиям пользователя. Но также возможно, что они не предоставили все сведения, необходимые приложению для достижения запрошенной задачи.

Существует несколько способов, с помощью которых приложение может справиться с такой ситуацией:

- **Выберите хорошее значение по умолчанию для отсутствующего значения** . Например, приложение для получения общего доступа может по умолчанию использовать текущее расположение пользователя, если не указал, откуда они хотят извлечь.
- Выполнив **обоснованное предположение** , используя конкретные сведения, собранные приложением для пользователя, приложение может принять и обучиться выгадать недостающие сведения, например заполнить отсутствующий номер мобильного телефона из контактной информации пользователя. Однако следует соблюдать осторожность, чтобы избежать нежелательных непредвиденных сюрпризов, таких как выбор наиболее дорогостоящего варианта и т. д.
- **Запрашивать дополнительные сведения** — приложение может подать пользователю Siri запрос на отсутствующее значение. Тем не менее, ключ здесь заключается в том, чтобы беседы были простыми и в точке. Пользователи быстро становятся неразочарованными, если им нужно ответить на несколько вопросов для достижения их запроса.
- **Аккуратно обрабатывайте** неверные сведения. пользователь может предоставить значение, которое приложение не ожидало или не может обработать в данном контексте. Убедитесь, что приложение применяет эту ситуацию к пользователю таким образом, чтобы она четко и понятна.

Если приложение представлено с одним и тем же значением, предпочтительным способом его решения является Siri запросить у пользователя подтверждение. Например, *«вы значите, что вы Бобо отлично?»* , на которые они могут ответить простым ответом «да» или «нет».

Если существует ситуация, когда несколько возможных вариантов могут быть верными для одного значения, то предпочтительным методом обработки является неоднозначность. В этом случае Siri может предложить пользователю выбрать до десяти возможных вариантов. Например:

```csharp
Who do you want to send the message to?

* Bobo the Great!
* Bobo Jr.
* Little Bobo
```

Если по-прежнему возникает вопрос, попросите пользователя ввести совершенно новый, более конкретный ответ на заданное значение.

#### <a name="request-final-confirmation"></a>Окончательное подтверждение запроса

Прежде чем приложение фактически выполнит задачу для выполнения запроса пользователя, Siri проверит расширение приложения, чтобы убедиться, что все готово. Например, имеет ли пользователь достаточно денег в своей учетной записи для выполнения запрошенного платежа?

Кроме того, приложение должно обеспечить предоставление всей информации для Siri, чтобы она могла предоставить его пользователю и убедиться, что задача будет соответствовать ожиданиям.

После того как пользователь подтвердил запрос и приложение выполнило его, приложение должно снова убедиться, что оно предоставил все результаты обратно в Siri, чтобы он мог связать его с пользователем.

#### <a name="responding-to-the-request"></a>Ответ на запрос

Siri имеет несколько встроенных пользовательских интерфейсов для каждого из доменов и действий, о которых он знает. Тем не менее, если это уместно, приложение может предоставить пользовательское расширение пользовательского интерфейса, чтобы расширить возможности взаимодействия с пользователем, предоставляя фирменную символику и пользовательский интерфейс приложения или больше информации, чем присутствовало в запросе.

С другой стороны, ограничения следует использовать при проектировании пользовательских интерфейсов для Siri. Как правило, пользователь хочет, чтобы конкретная задача была максимально быстрой, и ее не нужно перегружать с ненужными сведениями.

Следует также убедиться, что пользовательский интерфейс выглядит и правильно реагирует на все различные устройства iOS и ориентации, которые может иметь пользователь или использовать устройство.

При необходимости используйте API SiriKit, чтобы скрыть все избыточные сведения, уже имеющиеся в пользовательском интерфейсе Siri по умолчанию. Тем не менее убедитесь, что приложение по-прежнему предоставляет сведения для Siri, чтобы он мог представлять его в произвольных ситуациях.

Могут возникнуть ситуации, когда Siri запустит приложение для выполнения запроса пользователя, например представления фотографий, запрошенных пользователем. В таких ситуациях пользователь не удивительно. Отобразить ожидаемые сведения без промежуточных шагов или дальнейшего взаимодействия. Никогда не отображать сведения или выполнять задачи, которые пользователь не ожидает.

### <a name="polishing-the-design"></a>Польское проектирование

Существует несколько действий, которые компания Apple предлагает для польского проектирования интерфейсов для общения. Во-первых, необходимо предоставить четкие, лаконичные словари и примеры вариантов использования для Siri.

Одним из способов обнаружения приложения пользователем является Инициация диалога с Siri и запрос *"что можно сделать?"* Siri покажет несколько различных вещей, которые он может сделать, включая приложение разработчика и пример, Hero варианты использования, предоставленные с помощью `plist` файла.

Как написать хороший пример вариантов использования:

- Убедитесь, что в примерах содержится имя приложения.
- Не изменяйте пример короткого и-точечного.
- Предоставьте несколько примеров для каждого из целей, поддерживаемых приложением.
- Определите приоритеты для целей и примеров в них на основе наиболее распространенных вариантов использования приложения.
- Убедитесь, что приложение содержит локализованные примеры.
- Убедитесь, что каждый из указанных примеров работает правильно в приложении.
- Старайтесь не использовать Siri в примерах, поэтому не включайте текст, например *"Эй, Siri..."*
- Старайтесь не использовать все ненужные плеасантриес, такие как *","* или *"Спасибо"* .

Исследуйте соответствующее время, чтобы изучить и поэкспериментировать, как приложение может сформировать диалог, Siri с пользователем от его имени. Не забудьте поговорить с обычными пользователями в процессе, так как их взаимодействие с и ожиданиями приложения может измениться со временем.

Всегда забудьте протестировать приложение в различных ситуациях и в различных методах для вызова диалога с Siri. Тестирование в реальных местах. пользователь может использовать приложение вне офиса и рабочего стола.

Будьте в том, чтобы беседы с Siriами (от имени приложения) были гибкими, естественными и «неправильными».

## <a name="summary"></a>Сводка

В этой статье были рассмотрены основные понятия, необходимые для использования SiriKit и показано, что она может взаимодействовать с приложениями Xamarin. iOS для предоставления служб, доступных пользователю с помощью Siri и приложения Maps на устройстве iOS.

## <a name="related-links"></a>Связанные ссылки

- [Пример Елизачат](https://docs.microsoft.com/samples/xamarin/ios-samples/ios10-elizachat)
- [SiriKit по программированию](https://developer.apple.com/library/prerelease/content/documentation/Intents/Conceptual/SiriIntegrationGuide/index.html)
- [Ссылка на платформу целей](https://developer.apple.com/reference/intents)
- [Справочник по структуре пользовательского интерфейса для целей](https://developer.apple.com/reference/intentsui)
