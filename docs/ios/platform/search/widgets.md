---
title: Поиск и Главная усовершенствования экрана мини-приложение в iOS 10
description: В этом документе описаны усовершенствования, внесенные в мини-приложения в iOS 10, включая обновления для поиска и начальном экране мини-приложения Apple.
ms.prod: xamarin
ms.assetid: D66FD9E1-9E23-4BB6-825C-ED19B8F72A81
ms.technology: xamarin-ios
author: lobrien
ms.author: laobri
ms.date: 03/17/2017
ms.openlocfilehash: f693b480fff141c177ed135ced60afd65abd77de
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61082183"
---
# <a name="search-and-home-screen-widget-enhancements-in-ios-10"></a>Поиск и Главная усовершенствования экрана мини-приложение в iOS 10

_В этой статье рассматриваются усовершенствования, внесенные в систему мини-приложение в iOS 10 Apple._

Apple представила ряд дополнительных возможностей для системы мини-приложение, чтобы гарантировать, что мини-приложений отлично выглядят на любым фоном, который существует на новых устройствах iOS 10 экрана блокировки. Кроме того, теперь содержат мини-приложения [NCWidgetDisplayMode](https://developer.apple.com/reference/notificationcenter/ncwidgetdisplaymode) свойство, которое позволяет разработчику для описания того, какой объем содержимого доступен и пользователь может разворачивать и сворачивать содержимое.

Мини-приложения (также известный как сегодня расширения) являются особым типом из iOS расширения, отображение небольшой объем полезной информации и предоставления функциональных возможностей конкретного приложения за отведенное время. Например, приложение News имеет мини-приложения, показывающая заголовки верхнего и приложение «календарь» предоставляет два различных мини-приложения: один для отображения современных события и один для отображения предстоящих событий.

Мини-приложения являются широкие и могут содержать элементы пользовательского интерфейса, такие как текст, изображения, кнопки, и т.д. Кроме того разработчик возможна дальнейшая настройка макета их мини-приложений.

[![](widgets-images/widgets01.png "Пример мини-приложения")](widgets-images/widgets01.png#lightbox)

Существует два основных места, которые пользователь может просматривать и взаимодействовать с мини-приложений приложения:

- **На экране поиска** -пользователи могут добавлять мини-приложения, они считают наиболее полезными для их экран поиска. На экране поиска осуществляется, проводя пальцем вправо на экранах домашней и блокировки.
- **Начального экрана** -из начального экрана, пользователь может использовать 3D Touch для открытия списка быстрых действий, применяя давления для значка приложения. Мини-приложений приложения будет отображаться над краткий список действий. См. в нашем [введение в 3D Touch](~/ios/platform/3d-touch.md) Дополнительные сведения см.

## <a name="widgets-developer-suggestions"></a>Предложения разработчиков мини-приложения

В идеале разработчик попробуйте и должны создавать средства визуализации, которые пользователь желает добавить к экранам их поиска. С этой целью Apple имеет следующие рекомендации:

- **Создавать самые, Glanceable качества** -пользователя требуется мини-приложения, которые предоставляют краткое, glanceable сведения о состоянии обновлений или дают возможность быстро выполнять простые задачи. Таким образом, предоставляя подходящий объем информации и интерактивность неотъемлемой. По возможности, позволяющие ему для выполнения данной задачи одним касанием. Кроме того поскольку мини-приложения не поддерживают панорамирования и прокрутки, это придется принимать во внимание при разработке мини-приложения.
- **Быстро показать содержимое** -мини-приложения предназначены для glanceable, поэтому пользователь никогда не придется ожидание содержимого для загрузки после отображения мини-приложения. Мини-приложения следует кэшировать их содержимое локально, поэтому они могут показать недавно просмотренного содержимого, пока новое содержимое загружается в фоновом режиме.
- **Укажите соответствующие поля и поля** -мини-приложения никогда не следует выглядят в матричном, поэтому следует избегать расширение содержимого к краям представления графического элемента. Всегда должно быть несколько пикселей предсказанную между границей и содержимым. Apple также предлагает использовать значка приложения, в верхней части мини-приложения, например, руководство выравнивания. Если мини-приложение представляет макет сетки, убедитесь в наличии правильной заполнение между элементами в сетке и попробуйте ограничить количество элементов до четырех max.
- **Использование макетов адаптируемых** -графического элемента ширины будет отличаться в зависимости от устройства, он работает под управлением и ориентации устройства. Высота мини-приложения также можно изменять на основе, если он отображается в состоянии с помощью расширенных (не поддерживаются все мини-приложения) или Collapsed (по умолчанию). Свернуть мини-приложение имеет высоту строк таблицы примерно два с половиной стандартных операций ввода-вывода. Разработчик может запросить размер мини-приложение расширен, но в идеале должно быть меньше, чем высота экрана. В состоянии Collapsed мини-приложения должны показывать только нужные автономного информацию. Если развернуто, мини-приложения должны показывать дополнительную информацию, которая расширяет возможности основного содержимого, представленная в виде свернутого. Мини-приложений, перечисленных в списке быстрое действие будет только в состоянии Collapsed.
- **Не Настройка фона графического элемента** -мини-приложения отображаются на фоне света, размытая, предоставляемые системой. Это позволяет обеспечить согласованность между мини-приложений и повышения читаемости их содержимого. Избегайте использование изображения в качестве фона мини-приложения, так как он может пересекаться с фоновыми рисунками блокировки и начального экрана пользователя.
- **Использовать системный шрифт в черный или темно-серый** — при отображении текста в мини-приложение, лучше всего работает системный шрифт. Шрифт должен находиться в черный или темно-серый цвет выделиться на фоне мини-приложение света, размытой.
- **Включения приложений доступ при соответствующих** -графического элемента должен всегда работает отдельно от приложения, тем не менее, если требуется более мощные функциональные возможности, мини-приложения должна быть возможность запускать приложение, чтобы просмотреть или изменить конкретные сведения. Просто никогда не включать кнопка «открыть приложение» позволяет пользователю коснитесь само содержимое и никогда не открыть стороннего приложения.
- **Выберите четкий, кратким именем мини-приложения** -значка приложения и имя графического элемента всегда отображаются над содержимым графического элемента. Apple предлагает, использовать имя приложения для его основной мини-приложения и имя краткими, любые другие, которые он предоставляет. При предоставлении пользовательский заголовок мини-приложения, они должно начинаться с именем приложения (например, карты рядом, рестораны Maps т. д.).
- **Сообщить, когда проверка подлинности добавляет значение** — Если дополнительные функции или сведения доступна, только когда пользователь проходит проверку подлинности и вход, присутствия для пользователя. Например поездке, приложение для управления доступом может быть «Вход в поездке книги».
- **Выберите быстрый мини-приложение действие списка** — Если приложение содержит несколько мини-приложение, разработчику следует выбрать один для представления, когда пользователь откроет краткий список действий, применяя давления для значка приложения с помощью 3D Touch.

Дополнительные сведения о работе с мини-приложений см. в разделе наших [введение расширения](~/ios/platform/extensions.md), [введение в 3D Touch](~/ios/platform/3d-touch.md) документации и Apple [приложения расширения руководство по программированию](https://developer.apple.com/library/prerelease/content/documentation/General/Conceptual/ExtensibilityPG/index.html).

## <a name="working-with-vibrancy"></a>Работа с естественность

Естественность гарантирует, что текст мини-приложение остается читаемым, при включении в свет графического элемента, размытая фона (предоставляемые системой). До iOS 10, разработчик может использовать [NotificationCenterVibrancyEffect](https://developer.apple.com/reference/uikit/uivibrancyeffect/1613917-notificationcentervibrancyeffect) для естественность графического элемента. Пример:

```csharp
// DEPRECATED: Get Widget Vibrancy Effect
var vibrancy = UIVibrancyEffect.CreateForNotificationCenter ();
```

Это был устаревшим в iOS 10 и должна быть заменена либо [WidgetPrimaryVibrancyEffect](https://developer.apple.com/reference/uikit/uivibrancyeffect/1771278-widgetprimaryvibrancyeffect) или [WidgetSecondaryVibrancyEffect](https://developer.apple.com/reference/uikit/uivibrancyeffect/1771277-widgetsecondaryvibrancyeffect). Пример:

```csharp
// Get Primary Widget Vibrancy Effect
var vibrancy = UIVibrancyEffect.CreatePrimaryVibrancyEffectForNotificationCenter ();

// Get Secondary Widget Vibrancy Effect
var vibrancy2 = UIVibrancyEffect.CreateSecondaryVibrancyEffectForNotificationCenter ();
```

## <a name="working-with-collapsed-and-expanded-widgets"></a>Работа с свернутым и развернутым мини-приложения

Новое в iOS 10, мини-приложения содержат [NCWidgetDisplayMode](https://developer.apple.com/reference/notificationcenter/ncwidgetdisplaymode) свойство, которое позволяет разработчику для описания того, какой объем содержимого доступен и пользователь может разворачивать и сворачивать содержимое.

Когда изначально отображается мини-приложение, он находится в состоянии Collapsed. Свернуть мини-приложение имеет высоту строк таблицы примерно два с половиной стандартных операций ввода-вывода. Разработчик может запросить размер мини-приложение расширен, но в идеале должно быть меньше, чем высота экрана. 

В состоянии Collapsed мини-приложения должны показывать только нужные автономного информацию. Если развернуто, мини-приложения должны показывать дополнительную информацию, которая расширяет возможности основного содержимого, представленная в виде свернутого. Например прогноз погоды показывает текущие погодные условия при сворачивании и добавляет каждый час, прогноз в развернутом состоянии.

Мини-приложений, перечисленных в списке быстрое действие будет только в состоянии Collapsed. Если приложение содержит несколько мини-приложения, разработчик должен выбрать тот метод для представления, когда пользователь откроет краткий список действий, применяя давления для значка приложения с помощью 3D Touch.

Ниже приведен простой сегодня расширения (мини-приложения), обрабатывающий Collapsed и расширенного состояния:

```csharp
using System;
using NotificationCenter;
using Foundation;
using UIKit;
using CoreGraphics;

namespace MonkeyAbout
{
    public partial class TodayViewController : UIViewController, INCWidgetProviding
    {
        protected TodayViewController (IntPtr handle) : base (handle)
        {
            // Note: this .ctor should not contain any initialization logic.
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            // Tell widget it can be expanded
            ExtensionContext.SetWidgetLargestAvailableDisplayMode (NCWidgetDisplayMode.Expanded);

            // Get the maximum size
            var maxSize = ExtensionContext.GetWidgetMaximumSize (NCWidgetDisplayMode.Expanded);
        }

        [Export ("widgetPerformUpdateWithCompletionHandler:")]
        public void WidgetPerformUpdate (Action<NCUpdateResult> completionHandler)
        {
            // Take action based on the display mode
            switch (ExtensionContext.GetWidgetActiveDisplayMode()) {
            case NCWidgetDisplayMode.Compact:
                Content.Text = "Let's Monkey About!";
                break;
            case NCWidgetDisplayMode.Expanded:
                Content.Text = "Gorilla!!!!";
                break;
            }

            // Report results
            // If an error is encoutered, use NCUpdateResultFailed
            // If there's no update required, use NCUpdateResultNoData
            // If there's an update, use NCUpdateResultNewData
            completionHandler (NCUpdateResult.NewData);
        }

        [Export ("widgetActiveDisplayModeDidChange:withMaximumSize:")]
        public void WidgetActiveDisplayModeDidChange (NCWidgetDisplayMode activeDisplayMode, CGSize maxSize)
        {
            // Take action based on the display mode
            switch (activeDisplayMode) {
            case NCWidgetDisplayMode.Compact:
                PreferredContentSize = maxSize;
                Content.Text = "Let's Monkey About!";
                break;
            case NCWidgetDisplayMode.Expanded:
                PreferredContentSize = new CGSize (0, 200);
                Content.Text = "Gorilla!!!!";
                break;
            }
        }

    }
}
```

Взгляните на конкретный режим отображения мини-приложения код подробно. Чтобы сообщить системе, что это мини-приложение поддерживает состояние разреженный, он использует:

```csharp
// Tell widget it can be expanded
ExtensionContext.SetWidgetLargestAvailableDisplayMode (NCWidgetDisplayMode.Expanded);
```

Чтобы получить текущий режим отображения мини-приложение, он использует:

```csharp
ExtensionContext.GetWidgetActiveDisplayMode()
```

Чтобы получить максимальный размер для состояния, свернуто или развернуто, он использует:

```csharp
// Get the maximum size
var maxSize = ExtensionContext.GetWidgetMaximumSize (NCWidgetDisplayMode.Expanded);
```

И, чтобы обрабатывать изменения состояния (режим отображения), он использует:

```csharp
[Export ("widgetActiveDisplayModeDidChange:withMaximumSize:")]
public void WidgetActiveDisplayModeDidChange (NCWidgetDisplayMode activeDisplayMode, CGSize maxSize)
{
    // Take action based on the display mode
    switch (activeDisplayMode) {
    case NCWidgetDisplayMode.Compact:
        PreferredContentSize = maxSize;
        Content.Text = "Let's Monkey About!";
        break;
    case NCWidgetDisplayMode.Expanded:
        PreferredContentSize = new CGSize (0, 200);
        Content.Text = "Gorilla!!!!";
        break;
    }
}
```

Кроме настройки запрошенный размер для каждого состояния (свернуто или развернуто), он также обновляет содержимого, отображаемого для соответствия новому размеру.

## <a name="summary"></a>Сводка

В этой статье описаны усовершенствования, внесенные в систему мини-приложение в iOS 10 Apple, а также показано, как реализовать их в Xamarin.iOS.



## <a name="related-links"></a>Связанные ссылки

- [Примеры iOS 10](https://developer.xamarin.com/samples/ios/iOS10/)
- [Введение в расширения](~/ios/platform/extensions.md)
- [Введение в 3D Touch](~/ios/platform/3d-touch.md)
- [Руководство по программированию расширения приложения](https://developer.apple.com/library/prerelease/content/documentation/General/Conceptual/ExtensibilityPG/index.html)
