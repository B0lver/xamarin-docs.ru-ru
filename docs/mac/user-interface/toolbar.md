---
title: Панели инструментов в Xamarin. Mac
description: В этой статье описывается работа с панелями инструментов в приложении Xamarin. Mac. В нем рассматривается создание и обслуживание панелей инструментов в Xcode и Interface Builder, предоставление их коду и работа с ними программными средствами.
ms.prod: xamarin
ms.assetid: C8D228CE-C860-47E1-85FD-69864BF91F20
ms.technology: xamarin-mac
author: davidortinau
ms.author: daortin
ms.date: 03/14/2017
ms.openlocfilehash: 5cf86adf07043a60c6fe445265e14591692e365b
ms.sourcegitcommit: 2fbe4932a319af4ebc829f65eb1fb1816ba305d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73008354"
---
# <a name="toolbars-in-xamarinmac"></a>Панели инструментов в Xamarin. Mac

_В этой статье описывается работа с панелями инструментов в приложении Xamarin. Mac. В нем рассматривается создание и обслуживание панелей инструментов в Xcode и Interface Builder, предоставление их коду и работа с ними программными средствами._

Разработчики Xamarin. Mac, работающие с Visual Studio для Mac, имеют доступ к тем же элементам управления пользовательского интерфейса, которые доступны macOS разработчикам, работающим с Xcode, включая элемент управления ToolBar. Так как Xamarin. Mac интегрируется напрямую с Xcode, можно использовать Interface Builder Xcode для создания и обслуживания элементов панели инструментов. Эти элементы панели инструментов также можно создать в C#.

Панели инструментов в macOS добавляются в верхнюю часть окна и предоставляют простой доступ к командам, связанным с его функциональностью. Панели инструментов могут быть скрыты, показаны или настроены пользователями приложения, и они могут представлять элементы панели инструментов различными способами.

В этой статье рассматриваются основы работы с панелями инструментов и элементами панели инструментов в приложении Xamarin. Mac. 

Прежде чем продолжить, ознакомьтесь со статьей [Hello, Mac](~/mac/get-started/hello-mac.md) ( [Введение в Xcode и Interface Builder](~/mac/get-started/hello-mac.md#introduction-to-xcode-and-interface-builder) , а также разделы, посвященные разрешениям и [действиям](~/mac/get-started/hello-mac.md#outlets-and-actions) , в том числе основные понятия и методы, которые будут использоваться в этом руководстве).

Также ознакомьтесь с [ C# представлением классы и методы для цели-C](~/mac/internals/how-it-works.md) в документе [внутренних элементов Xamarin. Mac](~/mac/internals/how-it-works.md) . В нем объясняются атрибуты `Register` и `Export`, используемые C# для подключения классов к классам цели-C.

## <a name="introduction-to-toolbars"></a>Общие сведения о панелях инструментов

Любое окно в приложении macOS может содержать панель инструментов:

![Пример окна с панелью инструментов](toolbar-images/info01.png "Пример окна с панелью инструментов")

Панели инструментов предоставляют пользователям приложения простой способ быстрого доступа к важным или часто используемым функциям. Например, приложение для редактирования документов может предоставлять элементы панели инструментов для настройки цвета текста, изменения шрифта или печати текущего документа.

Элементы панели инструментов могут отображаться тремя способами:

1. **Значок и текст** 

     ![Панель инструментов со значками и текстом](toolbar-images/info02.png "Панель инструментов со значками и текстом")

2. **Только значок** 

     ![Панель инструментов только с значками](toolbar-images/info03.png "Панель инструментов только с значками")

3. **Только текст** 

     ![Только Текстовая панель инструментов](toolbar-images/info04.png "Только Текстовая панель инструментов")

Переключитесь между этими режимами, щелкнув панель инструментов правой кнопкой мыши и выбрав режим экрана в контекстном меню:

![Контекстное меню для панели инструментов](toolbar-images/info05.png "Контекстное меню для панели инструментов")

Используйте одно и то же меню, чтобы отобразить панель инструментов в меньшем размере:

![Панель инструментов с мелкими значками](toolbar-images/info06.png "Панель инструментов с мелкими значками")

В меню также можно настроить панель инструментов:

![Диалоговое окно, используемое для настройки панели инструментов](toolbar-images/info07.png "Диалоговое окно, используемое для настройки панели инструментов")

При настройке панели инструментов в Interface Builder Xcode разработчик может предоставить дополнительные элементы панели инструментов, которые не являются частью конфигурации по умолчанию. Пользователи приложения могут настраивать панель инструментов, добавлять и удалять эти предварительно определенные элементы по мере необходимости. Конечно, панель инструментов можно восстановить до конфигурации по умолчанию.

Панель инструментов автоматически подключается к меню **вид** , что позволяет пользователям скрывать его, отображать и настраивать.

![Элементы, связанные с панелью инструментов, в меню «Вид»](toolbar-images/info08.png "Элементы, связанные с панелью инструментов, в меню «Вид»")

Дополнительные сведения см. в документации по [функциональным возможностям меню](~/mac/user-interface/menu.md) .

Кроме того, если панель инструментов правильно настроена в Interface Builder, приложение будет автоматически сохранять настройки панелей инструментов во многих запусках приложения.

В следующих разделах этого руководства описывается создание и обслуживание панелей инструментов с помощью Interface Builder Xcode и способов работы с ними в коде.

## <a name="setting-a-custom-main-window-controller"></a>Настройка пользовательского основного контроллера окна

Чтобы предоставить элементам пользовательского интерфейса C# доступ к коду с помощью команд и действий, приложение Xamarin. Mac должно использовать пользовательский контроллер окна:

1. Откройте раскадровку приложения в Interface Builder Xcode.
2. Выберите контроллер окна в области конструктора.
3. Перейдите в **инспектор удостоверений** и введите "виндовконтроллер" в качестве **имени класса**: 

    [![Задание имени пользовательского класса для контроллера окна](toolbar-images/windowcontroller01.png "Задание имени пользовательского класса для контроллера окна")](toolbar-images/windowcontroller01-large.png#lightbox) 

4. Сохраните изменения и вернитесь в Visual Studio для Mac для синхронизации.
5. Файл **WindowController.CS** будет добавлен в проект **панель решения** в Visual Studio для Mac: 

    ![Выбор WindowController.cs в Панель решения](toolbar-images/windowcontroller02.png "Выбор WindowController.cs в Панель решения")

6. Повторно откройте раскадровку в Interface Builder Xcode.
7. Файл **виндовконтроллер. h** будет доступен для использования: 

    [![Файл Виндовконтроллер. h](toolbar-images/windowcontroller03.png "Файл Виндовконтроллер. h")](toolbar-images/windowcontroller03-large.png#lightbox)

## <a name="creating-and-maintaining-toolbars-in-xcode"></a>Создание и обслуживание панелей инструментов в Xcode

Панели инструментов создаются и обслуживаются с помощью Interface Builder Xcode. Чтобы добавить в приложение Панель инструментов, измените основную раскадровку приложения (в данном случае **Main. Storyboard**), дважды щелкнув ее в **панель решения**:

![Открытие Main. Storyboard в Панель решения](toolbar-images/edit01.png "Открытие Main. Storyboard в Панель решения")

В **инспекторе библиотеки**в **поле поиска** введите "Tool", чтобы упростить просмотр всех доступных элементов панели инструментов:

![Инспектор библиотек, отфильтрованный для отображения элементов панели инструментов](toolbar-images/edit02.png "Инспектор библиотек, отфильтрованный для отображения элементов панели инструментов")

Перетащите панель инструментов на окно в **редакторе интерфейса**. Выбрав Панель инструментов, настройте ее поведение, задав свойства в **инспекторе атрибутов**.

![Инспектор атрибутов для панели инструментов](toolbar-images/edit04.png "Инспектор атрибутов для панели инструментов")

Доступны следующие свойства.

1. **Показать** — определяет, отображаются ли на панели инструментов значки, текстовые или и то, и другое.
2. **Отображается при запуске** . Если выбран этот параметр, панель инструментов отображается по умолчанию.
3. **Настраиваемый** — Если выбран этот параметр, пользователи могут изменять и настраивать панель инструментов.
4. **Разделитель** — Если выбрано, тонкая горизонтальная линия отделяет панель инструментов от содержимого окна.
5. **Размер** — задает размер панели инструментов.
6. **Автосохранение** — Если выбрано, приложение будет сохранять изменения конфигурации панели инструментов пользователя во всех запусках приложений.

Выберите параметр **автосохранения** и оставьте все остальные свойства в параметрах по умолчанию. 

После открытия панели инструментов в **иерархии интерфейса**откройте диалоговое окно настройки, выбрав элемент панели инструментов:

![Настройка панели инструментов](toolbar-images/edit05.png "Настройка панели инструментов")

Это диалоговое окно используется для задания свойств элементов, которые уже являются частью панели инструментов, для разработки панели инструментов по умолчанию для приложения, а также для предоставления дополнительных элементов панели инструментов, которые пользователь должен выбрать при настройке панели инструментов. Чтобы добавить элементы на панель инструментов, перетащите их из **инспектора библиотеки**:

![Инспектор библиотек](toolbar-images/edit06.png "Инспектор библиотек")

Можно добавить следующие элементы панели инструментов:

- **Элемент панели инструментов "изображение** " — элемент панели инструментов с пользовательским изображением в виде значка.
- **Гибкий элемент панели инструментов** — гибкое пространство, используемое для выравнивания последующих элементов панели инструментов. Например, один или несколько элементов панели инструментов, за которыми следует элемент панели инструментов гибкого пространства и другой элемент панели инструментов, закрепите последний элемент в правой части панели инструментов.
- **Элемент панели инструментов "пробел** " — фиксированное пространство между элементами на панели инструментов
- **Разделительная панель инструментов** — видимый разделитель между двумя или несколькими элементами панели инструментов для группирования
- **Настройка элемента панели инструментов** . позволяет пользователям настраивать панель инструментов
- **Печать элемента панели инструментов** — разрешает пользователям печатать открытый документ
- **Показать цвета элемент панели инструментов** — отображает стандартное средство выбора цвета системы: 

     ![Средство выбора цвета системы](toolbar-images/edit07.png "Средство выбора цвета системы")

- **Показать элемент панели инструментов шрифта** — отображается диалоговое окно стандартного системного шрифта: 

     ![Селектор шрифта](toolbar-images/edit08.png "Селектор шрифта")

> [!IMPORTANT]
> Как будет показано далее, многие стандартные элементы управления пользовательского интерфейса Cocoa, такие как поля поиска, сегментированные элементы управления и горизонтальные ползунки, также могут быть добавлены на панель инструментов.

### <a name="adding-an-item-to-a-toolbar"></a>Добавление элемента на панель инструментов

Чтобы добавить элемент на панель инструментов, выберите панель инструментов в **иерархии интерфейсов** и щелкните один из элементов, в результате чего появится диалоговое окно настройки. Затем перетащите новый элемент из **инспектора библиотек** в область **Разрешенные элементы панели инструментов** :

![Разрешенные элементы панели инструментов в диалоговом окне настройки панели инструментов](toolbar-images/add01.png "Разрешенные элементы панели инструментов в диалоговом окне настройки панели инструментов")

Чтобы убедиться, что новый элемент является частью панели инструментов по умолчанию, перетащите его в область **элементов панели инструментов по умолчанию** : 

![Изменение порядка элементов на панели инструментов путем перетаскивания](toolbar-images/add02.png "Изменение порядка элементов на панели инструментов путем перетаскивания")

Чтобы изменить порядок элементов на панели инструментов по умолчанию, перетащите их влево или вправо.

Затем с помощью **инспектора атрибутов** задайте для элемента свойства по умолчанию.

![Настройка элемента панели инструментов с помощью инспектора атрибутов](toolbar-images/add03.png "Настройка элемента панели инструментов с помощью инспектора атрибутов")

Доступны следующие свойства.

- **Имя образа** — изображение, используемое в качестве значка для элемента
- **Метка** — текст, отображаемый для элемента на панели инструментов
- **Метка палитры** — текст, отображаемый для элемента в области **Разрешенные элементы панели инструментов**
- **Tag** — необязательный уникальный идентификатор, который помогает опознать элемент в коде.
- **Идентификатор** — определяет тип элемента панели инструментов. Пользовательское значение можно использовать для выбора элемента панели инструментов в коде.
- **Выбираемый** — Если флажок установлен, элемент будет действовать как кнопка включения/выключения.

> [!IMPORTANT]
> Добавьте элемент в область **Разрешенные элементы панели инструментов** , но не на панель инструментов по умолчанию, чтобы предоставить пользователям параметры настройки. 

### <a name="adding-other-ui-controls-to-a-toolbar"></a>Добавление других элементов управления пользовательского интерфейса на панель инструментов

На панель инструментов также можно добавить несколько элементов пользовательского интерфейса Cocoa, таких как поля поиска и сегментированные элементы управления.

Чтобы попробовать это, откройте панель инструментов в **иерархии интерфейс** и выберите элемент на панели инструментов, чтобы открыть диалоговое окно настройки. Перетащите **поле поиска** из **инспектора библиотек** в область **Разрешенные элементы панели инструментов** :

![Использование диалогового окна настройки панели инструментов](toolbar-images/add05.png "Использование диалогового окна настройки панели инструментов")

Здесь используйте Interface Builder, чтобы настроить поле поиска и предоставить его коду через действие или выход.

## <a name="built-in-toolbar-item-support"></a>Поддержка встроенных элементов панели инструментов

Несколько элементов пользовательского интерфейса Cocoa по умолчанию взаимодействуют со стандартными элементами панели инструментов. Например, перетащите **текстовое представление** в окно приложения и разместите его, чтобы заполнить область содержимого:

[![Добавление текстового представления в приложение](toolbar-images/edit09.png "Добавление текстового представления в приложение")](toolbar-images/edit09-large.png#lightbox)

Сохраните документ, вернитесь в Visual Studio для Mac для синхронизации с Xcode, запустите приложение, введите текст, выберите его и щелкните элемент Панель инструментов **цвета** . Обратите внимание, что текстовое представление автоматически работает с палитрой выбора цвета:

![Встроенные функции панели инструментов с помощью текстового представления и палитры цветов](toolbar-images/edit10.png "Встроенные функции панели инструментов с помощью текстового представления и палитры цветов")

## <a name="using-images-with-toolbar-items"></a>Использование изображений с элементами панели инструментов

С помощью **элемента панели инструментов изображения**любое растровое изображение, добавленное в папку **Resources** (и полученное действие сборки **ресурса пакета**), может отображаться на панели инструментов в виде значка:

1. В Visual Studio для Mac в **панель решения**щелкните правой кнопкой мыши папку **Resources** и выберите **добавить**  > **Добавить файлы**.
2. В диалоговом окне **Добавление файлов** перейдите к нужным изображениям, выберите их и нажмите кнопку **Открыть** : 

    [![Выбор изображений для добавления](toolbar-images/edit11.png "Выбор изображений для добавления")](toolbar-images/edit11-large.png#lightbox)

3. Выберите **Копировать**, установите флажок **использовать то же действие для всех выбранных файлов**и нажмите кнопку **ОК**.

    ![Выбор действия копирования для добавленных изображений](toolbar-images/edit12.png "Выбор действия копирования для добавленных изображений")

4. В **панель решения**дважды щелкните файл **MainWindow. XIB** , чтобы открыть его в Xcode.

5. Выберите панель инструментов в **иерархии интерфейс** и щелкните один из элементов, чтобы открыть диалоговое окно настройки.

6. Перетащите **элемент панели инструментов с изображением** из **инспектора библиотек** в область панели инструментов **Разрешенные элементы** панели инструментов: 

    ![Элемент панели инструментов для изображения, добавленный в область разрешенных элементов панели инструментов](toolbar-images/edit14.png "Элемент панели инструментов для изображения, добавленный в область разрешенных элементов панели инструментов")

7. В **инспекторе атрибутов**выберите изображение, только что добавленное в Visual Studio для Mac: 

    ![Настройка пользовательского изображения для элемента панели инструментов](toolbar-images/edit15.png "Настройка пользовательского изображения для элемента панели инструментов")

8. Задайте для **метки** значение "Корзина", а для **метки палитры** — "очистить документ": 

    ![Задание метки элемента панели инструментов и метки палитры](toolbar-images/edit16.png "Задание метки элемента панели инструментов и метки палитры")

9. Перетащите **элемент панели инструментов разделитель** из **инспектора библиотек** в область панели инструментов **Разрешенные элементы** панели инструментов: 

    [![Элемент панели инструментов-разделителя, добавленный в область разрешенных элементов панели инструментов](toolbar-images/edit17.png "Элемент панели инструментов-разделителя, добавленный в область разрешенных элементов панели инструментов")](toolbar-images/edit17-large.png#lightbox)

10. Перетащите элемент-разделитель и элемент "Корзина" в область **элементов панели инструментов по умолчанию** и установите порядок элементов на панели инструментов слева направо, как показано ниже (цвета, шрифты, разделитель, корзина, гибкое пространство, печать): 

    ![Элементы панели инструментов по умолчанию](toolbar-images/edit18.png "Элементы панели инструментов по умолчанию")

11. Сохраните изменения и вернитесь в Visual Studio для Mac для синхронизации с Xcode.

Запустите приложение, чтобы убедиться, что по умолчанию отображается новая панель инструментов:

![Панель инструментов с настроенными элементами по умолчанию](toolbar-images/edit19.png "Панель инструментов с настроенными элементами по умолчанию")

## <a name="exposing-toolbar-items-with-outlets-and-actions"></a>Предоставление доступа к элементам панели инструментов с помощью розеток и действий

Чтобы получить доступ к панели инструментов или элементу панели инструментов в коде, он должен быть присоединен к розетке или действию:

1. В **панель решения**дважды щелкните **Main. Storyboard** , чтобы открыть его в Xcode.
2. Убедитесь, что пользовательский класс "Виндовконтроллер" был назначен контроллеру основного окна в **инспекторе удостоверений**:

    [![Использование инспектора удостоверений для задания пользовательского класса для контроллера окна](toolbar-images/edit20a.png "Использование инспектора удостоверений для задания пользовательского класса для контроллера окна")](toolbar-images/edit20a-large.png#lightbox)

3. Затем выберите элемент панели инструментов в **иерархии интерфейса**: 

    ![Выбор элемента панели инструментов в иерархии интерфейса](toolbar-images/edit20.png "Выбор элемента панели инструментов в иерархии интерфейса")  

4. Откройте **представление помощника**, выберите файл **виндовконтроллер. h** и перетащите элемент Панель инструментов в файл **виндовконтроллер. h** .
5. Задайте для параметра Тип **соединения** значение **действие**, введите "Трашдокумент" в качестве **имени**и нажмите кнопку **подключить** : 

    [![Настройка действия для элемента панели инструментов](toolbar-images/edit23.png "Настройка действия для элемента панели инструментов")](toolbar-images/edit23-large.png#lightbox)

6. **Откройте представление текста** как выход с именем "документедитор" в файле **ViewController. h** : 

    [![Настройка розетки для представления текста](toolbar-images/edit24.png "Настройка розетки для представления текста")](toolbar-images/edit24-large.png#lightbox)

7. Сохраните изменения и вернитесь в Visual Studio для Mac для синхронизации с Xcode.

В Visual Studio для Mac измените файл **ViewController.CS** и добавьте следующий код:

```csharp
public void EraseDocument() {
    documentEditor.Value = "";
}
```

Затем измените файл **WindowController.CS** и добавьте следующий код в нижнюю часть класса `WindowController`:

```csharp
[Export ("trashDocument:")]
void TrashDocument (NSObject sender) {

    var controller = ContentViewController as ViewController;
    controller.EraseDocument ();
}
```

При запуске приложения элемент « **мусорная** панель» будет активен:

![Панель инструментов с активным элементом корзины](toolbar-images/edit25.png "Панель инструментов с активным элементом корзины")

Обратите внимание, что теперь элемент Панель инструментов **корзины** можно использовать для удаления текста.

## <a name="disabling-toolbar-items"></a>Отключение элементов панели инструментов

Чтобы отключить элемент на панели инструментов, создайте пользовательский класс `NSToolbarItem` и переопределите метод `Validate`. Затем в Interface Builder назначьте настраиваемый тип элементу, который необходимо включить или отключить.

Чтобы создать пользовательский класс `NSToolbarItem`, щелкните правой кнопкой мыши проект и выберите **добавить**  > **новый файл...** . Выберите **общие**  > **пустой класс**, введите "Активатаблеитем" в качестве **имени**и нажмите кнопку " **создать** ": 

![Добавление пустого класса в Visual Studio для Mac](toolbar-images/custom01.png "Добавление пустого класса в Visual Studio для Mac")

Затем измените файл **ActivatableItem.CS** для чтения следующим образом:

```csharp
using System;

using Foundation;
using AppKit;

namespace MacToolbar
{
    [Register("ActivatableItem")]
    public class ActivatableItem : NSToolbarItem
    {
        public bool Active { get; set;} = true;

        public ActivatableItem ()
        {
        }

        public ActivatableItem (IntPtr handle) : base (handle)
        {
        }

        public ActivatableItem (NSObjectFlag  t) : base (t)
        {
        }

        public ActivatableItem (string title) : base (title)
        {
        }

        public override void Validate ()
        {
            base.Validate ();
            Enabled = Active;
        }
    }
}
```

Дважды щелкните **Main. Storyboard** , чтобы открыть его в Xcode. Выберите созданный ранее элемент панели инструментов **корзины** и измените его класс на "активатаблеитем" в **инспекторе удостоверений**:

![Задание пользовательского класса для элемента панели инструментов](toolbar-images/custom02.png "Задание пользовательского класса для элемента панели инструментов")

Создайте выход с именем `trashItem` для элемента панели инструментов **корзины** . Сохраните изменения и вернитесь в Visual Studio для Mac для синхронизации с Xcode. Наконец, откройте **MainWindow.CS** и обновите метод `AwakeFromNib` для чтения следующим образом:

```csharp
public override void AwakeFromNib ()
{
    base.AwakeFromNib ();

    // Disable trash
    trashItem.Active = false;
}
```

Запустите приложение и обратите внимание, что элемент **корзины** теперь отключен на панели инструментов:

![Панель инструментов с неактивным элементом корзины](toolbar-images/custom03.png "Панель инструментов с неактивным элементом корзины")

## <a name="summary"></a>Сводка

В этой статье подробно рассматривается работа с панелями инструментов и элементами панели инструментов в приложении Xamarin. Mac. В нем описано, как создавать и обслуживать панели инструментов в Interface Builder Xcode, как некоторые элементы управления пользовательского интерфейса автоматически работают с элементами панели инструментов, как C# работать с панелями инструментов в коде и как включать и отключать элементы панели инструментов.

## <a name="related-links"></a>Связанные ссылки

- [Мактулбар (пример)](https://docs.microsoft.com/samples/xamarin/mac-samples/mactoolbar)
- [Привет, Mac](~/mac/get-started/hello-mac.md)
- [Рекомендации по работе с персоналом для панелей инструментов](https://developer.apple.com/macos/human-interface-guidelines/windows-and-views/toolbars/)
- [Общие сведения о панелях инструментов](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Toolbars/Toolbars.html)
