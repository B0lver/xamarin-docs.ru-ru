---
title: Xamarin.Mac опережает время компиляции
description: В этом документе описывается опережает время компиляции в Xamarin.Mac. Сравнивает AOT компиляции JIT-компиляция, объясняется, как включить AOT и смотрит на гибридного AOT.
ms.prod: xamarin
ms.assetid: 38B8A017-5A58-429C-A6E9-9860A1DCEF63
ms.technology: xamarin-mac
author: bradumbaugh
ms.author: brumbaug
ms.date: 11/10/2017
ms.openlocfilehash: ec8474293fbb7372529e0f850e2d16db7ebf17be
ms.sourcegitcommit: ea1dc12a3c2d7322f234997daacbfdb6ad542507
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2018
ms.locfileid: "34792243"
---
# <a name="xamarinmac-ahead-of-time-compilation"></a>Xamarin.Mac опережает время компиляции

## <a name="overview"></a>Обзор

Вперед (AOT) времени компиляции методика мощные оптимизации по повышению производительности при запуске. Тем не менее оно также влияет на время построения, размера приложения и выполнение программы в эффективных средств. Чтобы понять компромиссы, который устанавливает, мы собираемся немного углубленное компиляции и выполнения приложения.

Код, написанный на управляемом языке, например C# и F #, компилируется для промежуточного представления, вызывается IL. Это IL, хранятся в сборках библиотеки и программы, довольно компактные и зависимых от архитектуры процессора. IL, однако является только промежуточном набор инструкций и в некоторой точке, IL нужно перевести в конкретного процессора машинный код.

Существуют две точки, в которых можно сделать эту процедуру:

- **По требованию (JIT)** — во время запуска и выполнения приложения IL-код компилируется в памяти в машинный код.
- **Упреждающее времени (AOT)** — во время сборки IL-код компилируется и записываются обратно в собственные библиотеки и хранятся в ваш пакет приложения.

Каждый вариант имеет ряд преимуществами и недостатками:

- **JIT**
  - **Время запуска** — JIT-компиляции, которые должны выполняться при запуске. Для большинства приложений это составляет примерно 100 мс, но для крупных приложений это время может быть значительно больше.
  - **Выполнение** — как JIT-кода могут быть оптимизированы для конкретного процессора, можно создать несколько повысить код. В большинстве приложений это на несколько процентов быстрее максимум.
- **AOT**
  - **Время запуска** — загрузка dylib-файлы предварительно скомпилированных значительно быстрее, чем сборок JIT-компилятора.
  - **Место на диске** — эти dylib-файлы тем не менее может занять значительное место на диске. В зависимости от того, какие сборки являются AOTed, можно дважды или более размер часть кода приложения.
  - **Время построения** — компиляции AOT значительно медленнее, что JIT и приведет к снижению сборок, использующих его. Замедление может варьироваться от секунд до 1 минуты или более, в зависимости от размера и количества скомпилированных сборках.
  - **Запутывания** — как IL, что значительно упрощает реконструирования чем машинный код, не обязательно требуется его можно извлечь для замаскировать код, зависящий. Для этого необходимо «Гибридный», параметр описаны ниже.

## <a name="enabling-aot"></a>Включение AOT

Область построения Mac в дальнейшем будут добавлены параметры AOT. До тех пор Включение AOT требует передачи аргумента командной строки через поле «Дополнительные mmp аргументы» в Mac построения. Это свойство может принимать следующие значения.


      --aot[=VALUE]          Specify assemblies that should be AOT compiled
                               - none - No AOT (default)
                               - all - Every assembly in MonoBundle
                               - core - Xamarin.Mac, System, mscorlib
                               - sdk - Xamarin.Mac.dll and BCL assemblies
                               - |hybrid after option enables hybrid AOT which
                               allows IL stripping but is slower (only valid
                               for 'all')
                                - Individual files can be included for AOT via +
                               FileName.dll and excluded via -FileName.dll

                               Examples:
                                 --aot:all,-MyAssembly.dll
                                 --aot:core,+MyOtherAssembly.dll,-mscorlib.dll



## <a name="hybrid-aot"></a>Гибридные AOT

Во время выполнения приложения среда выполнения macOS из собственных библиотек, созданные в процессе компиляции AOT загружены по умолчанию с помощью машинного кода. Однако, существуют некоторые участки кода, например trampolines, где JIT-компиляция может привести к значительно более оптимизированного результатам. Для этого необходимо IL управляемые сборки доступны. На iOS приложениям запрещено при использовании JIT-компиляции; Эти части кода, скомпилированы также AOT.

Используя смешанный вариант указывает компилятору на необходимость обоих компиляции новый раздел (например, iOS), но также к предполагается, что IL-код не будет доступен во время выполнения. Затем следует удалять этот IL блога сборки. Как указано выше, среда выполнения принудительно использовать менее оптимизированный подпрограммы в одних местах.

## <a name="further-considerations"></a>Дополнительные вопросы

Отрицательные последствия AOT масштабирование с размером и число обработанных сборок. Полный [требуемой версии .NET framework](~/mac/platform/target-framework.md) пример содержит значительно больше библиотеке базовых классов (BCL) чем современный, и таким образом AOT будет гораздо дольше и создания больших пакетов. Это еще более запутанной, полный целевой платформы несовместимость с компоновку, которой исключается неиспользуемый код. Перенесите приложение компоновка современных и включить для получения наилучших результатов.

Дополнительным преимуществом AOT поставляется с улучшенное взаимодействие с собственного отладки и профилирования toolchains. Так как большая база кода компилируется заранее, будет иметь имена функций и символов, которые будут более удобными для чтения в отчеты о сбоях в машинном коде, профилирования и отладки. Созданный JIT-компилятора функции не имеют этих имен и часто отображается как неименованные шестнадцатеричных смещения, которые очень трудно устранить.
