---
title: xib-файлы в Xamarin.Mac
description: В этой статье рассматривается работа с xib-файлы, созданные в конструктора Interface Builder для создания и поддержки пользовательских интерфейсов для приложения Xamarin.Mac.
ms.prod: xamarin
ms.assetid: 6AF3D216-448D-4B2D-9026-74E4FFF5923A
ms.technology: xamarin-mac
author: lobrien
ms.author: laobri
ms.date: 03/14/2017
ms.openlocfilehash: 45eeee745b133646aef0f775bc879fa6a5d867c7
ms.sourcegitcommit: e268fd44422d0bbc7c944a678e2cc633a0493122
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50109436"
---
# <a name="xib-files-in-xamarinmac"></a>xib-файлы в Xamarin.Mac

_В этой статье рассматривается работа с xib-файлы, созданные в конструктора Interface Builder для создания и поддержки пользовательских интерфейсов для приложения Xamarin.Mac._

> [!NOTE]
> С раскадровками — предпочтительный способ создания пользовательского интерфейса для приложения Xamarin.Mac. Эта документация была оставлена в месте по историческим причинам и для работы с более старых проектов Xamarin.Mac. Дополнительные сведения см. в разделе наших [введение в раскадровки](~/mac/platform/storyboards/index.md) документации.

## <a name="overview"></a>Обзор

При работе с C# и .NET в приложении Xamarin.Mac, имеют доступ к тем же элементы пользовательского интерфейса и средства, работающий в *Objective-C* и *Xcode* does. Поскольку Xamarin.Mac напрямую интегрируется с Xcode, можно использовать конструктор _Interface Builder_ для создания и поддержания интерфейсов пользователя (или при необходимости создать их непосредственно в коде C#).

Файл .xib используется macOS для определения элементов интерфейса пользователя приложения (например, меню, Windows, представления, метки, текстовые поля), создаются и поддерживаются графически в Interface Builder в Xcode.

[![Пример запущенного приложения](xib-images/intro01.png "пример запущенного приложения")](xib-images/intro01-large.png#lightbox)

В этой статье мы обсудим, что узнаете основы работы с xib-файлов в приложении Xamarin.Mac. Настоятельно рекомендуется работать через [Привет, Mac](~/mac/get-started/hello-mac.md) во-первых, статьи, в которой он рассматривает основные понятия и методы, которые мы будем использовать в этой статье.

Может потребоваться взгляните на [предоставление C# классы / методы Objective-c](~/mac/internals/how-it-works.md) раздел [структуре Xamarin.Mac](~/mac/internals/how-it-works.md) документа, он объясняет `Register` и `Export` атрибуты используется для привязывания классов C# к объектам Objective-C и пользовательского интерфейса элементов.


## <a name="introduction-to-xcode-and-interface-builder"></a>Общие сведения об Xcode и конструкторе интерфейсов Interface Builder

Как часть Xcode Apple создала инструмент, который называется конструктором Interface Builder, позволяет визуально создавать пользовательский интерфейс в конструкторе. Xamarin.Mac свободно интегрируется с помощью конструктора Interface Builder, что позволяет создавать пользовательский Интерфейс с помощью тех же средств, которые выполняют пользователи Objective-C.


### <a name="components-of-xcode"></a>Компоненты Xcode

При открытии файла .xib в Xcode из Visual Studio для Mac, он откроется с **навигатор проекта** с левой стороны экрана **иерархия интерфейса** и **редактор интерфейса** в середине и **свойства и служебные программы** справа раздел:

[![Компоненты пользовательского интерфейса Xcode](xib-images/xcode03.png "компоненты пользовательского интерфейса Xcode")](xib-images/xcode03-large.png#lightbox)

Давайте взглянем какие каждую из этих разделов Xcode не, а также как их будет использовать для создания интерфейса приложения Xamarin.Mac.


#### <a name="project-navigation"></a>Навигация по проекту

При открытии файла .xib для редактирования в Xcode, Visual Studio для Mac создает файл проекта Xcode в фоновом режиме для передачи изменений между собой и Xcode. Позже при переключении обратно в Visual Studio для Mac с Xcode, любые изменения, внесенные в этот проект, синхронизируются с проектом Xamarin.Mac в Visual Studio для Mac.

**Навигация по проекту** раздел позволяет перемещаться между всех файлов, составляющих данный _оболочки совместимости_ проекта Xcode. Как правило, можно, только интересует .xib файлы в этом списке, такие как **MainMenu.xib** и **MainWindow.xib**.


#### <a name="interface-hierarchy"></a>Иерархия интерфейса

**Иерархия интерфейса** раздел позволяет легко получить доступ к нескольким ключевым группам пользовательского интерфейса таким образом его **заполнители** и main **окно**. В этом разделе также можно получить доступ к отдельным элементам (представлениям), которые делают пользовательского интерфейса и учесть способ их вложенности путем перетаскивания в пределах иерархии.


#### <a name="interface-editor"></a>Редактор интерфейса

**Редактор интерфейса** раздел содержит области, на котором вы графически макета в пользовательском интерфейсе. Перетащите элементы из **библиотеки** раздел **свойства и служебные программы** раздела, чтобы создать проект. Как добавить элементы пользовательского интерфейса (представления) в область конструктора, они будут добавлены к **иерархия интерфейса** раздела в порядке их появления в **редактор интерфейса**.


#### <a name="properties--utilities"></a>Свойства и служебные программы

**Свойства и служебные программы** раздел состоит из двух основных частей, мы будем работать с, **свойства** (также называемые инспекторами) и **библиотеки**:

![Инспектор свойств](xib-images/xcode04.png "инспектор свойств")

Изначально этот раздел практически пуст, однако при выборе элемента в **редактор интерфейса** или **иерархия интерфейса**, **свойства** раздел будет заполнен сведения о выбранном элементе и свойства, которые можно настраивать.

В разделе **Свойства** находится восемь разных *вкладок инспекторов*, как показано на следующем рисунке:

[![Обзор всех инспекторов](xib-images/xcode05.png "Обзор всех инспекторов")](xib-images/xcode05-large.png#lightbox)

Слева направо располагаются следующие вкладки:

-   **Инспектор файлов.** Инспектор файлов отображает сведения о файле, такие как имя файла и расположение редактируемого XIB-файла.
-   **Экспресс-справка.** На вкладке "Экспресс-справка" содержится контекстная справка по компоненту или функции, выбранной в Xcode.
-   **Инспектор удостоверений.** Инспектор удостоверений предоставляет сведения о выбранном элементе управления или представлении.
-   **Инспектор атрибутов** — инспектор атрибутов позволяет настраивать различные атрибуты выбранного элемента управления или представления.
-   **Инспектор размеров** — инспектор размеров позволяет управлять размером и размеров выбранного элемента управления или представления.
-   **Инспектор подключений** — инспектор подключений показывает подключения розеток и действие выбранных элементов управления. Мы рассмотрим переменных экземпляров и действий в секунду.
-   **Инспектор привязок** — инспектор привязок позволяет настраивать элементы управления, таким образом, чтобы их значения автоматически привязывались к моделям данных.
-   **Инспектор эффектов представления** — инспектор эффектов представления позволяет указывать эффекты на элементах управления, такие как анимация.

В **библиотеки** можно найти элементы управления и объектов, размещаемых в конструкторе для графического построения пользовательского интерфейса:

![Пример в инспекторе библиотеки](xib-images/xcode06.png "примером в инспекторе библиотеки")

Теперь, когда вы знакомы с интегрированной среды разработки Xcode и конструкторе Interface Builder, давайте взглянем на использование его для создания пользовательского интерфейса.


## <a name="creating-and-maintaining-windows-in-xcode"></a>Создание и обслуживание windows в Xcode

Является предпочтительным для создания пользовательского интерфейса приложения Xamarin.Mac с помощью Storyboard (см. в разделе наших [введение в раскадровки](~/mac/platform/storyboards/index.md) Дополнительные сведения) и, таким образом, любой новый проект запущен в будет Xamarin.Mac по умолчанию используется раскадровки.

Переключиться на использование .xib на основе пользовательского интерфейса, выполните следующие действия.

1. Откройте Visual Studio для Mac и создайте новый проект Xamarin.Mac.
2. В **панели решения**, правой кнопкой мыши проект и выберите **добавить** > **новый файл...**
3. Выберите **Mac** > **Windows контроллера**:

    ![Добавление нового контроллера окно](xib-images/setup00.png "добавлении нового контроллера окна")
4. Введите `MainWindow` имя и нажмите кнопку **New** кнопки:

    ![Добавление нового главного окна](xib-images/setup01.png "Добавление нового главного окна")
5. Щелкните правой кнопкой мыши проект еще раз и выберите **добавить** > **новый файл...**
6. Выберите **Mac** > **главного меню**:

    ![Добавление нового меню Main](xib-images/setup02.png "Добавление нового меню Main")
7. Оставьте имя по `MainMenu` и нажмите кнопку **New** кнопки.
8. В **панели решения** выберите **Main.storyboard** файл, щелкните правой кнопкой мыши и выберите **удалить**:

    ![Выбрав основной раскадровки](xib-images/setup03.png "выбрав основной раскадровки")
9. В диалоговом окне выберите Удалить, щелкните **удалить** кнопки:

    ![Подтверждение удаления](xib-images/setup04.png "подтверждения удаления")
10. В **панели решения**, дважды щелкните **Info.plist** файл, чтобы открыть его для редактирования.
11. Выберите `MainMenu` из **главный интерфейс** раскрывающегося списка:

    [![В главном меню](xib-images/setup05.png "в главном меню")](xib-images/setup05-large.png#lightbox)
12. В **панели решения**, дважды щелкните **MainMenu.xib** файл, чтобы открыть его для редактирования в Interface Builder в Xcode.
13. В **инспектор библиотеки**, тип `object` в поле поиска перетащите новый **объекта** в область конструктора:

    [![Редактирование в главном меню](xib-images/setup06.png "редактирования в главном меню")](xib-images/setup06-large.png#lightbox)
14. В **инспектор удостоверений**, введите `AppDelegate` для **класс**:

    [![Выбрав делегата приложения](xib-images/setup07.png "выбрав делегата приложения")](xib-images/setup07-large.png#lightbox)
15. Выберите **владелец файла** из **иерархия интерфейса**, переключитесь в **инспектор подключения** и перетащите линию от делегата к `AppDelegate` **Объект** только что добавили в проект:

    [![Подключение делегата приложения](xib-images/setup08.png "подключения делегата приложения")](xib-images/setup08-large.png#lightbox)
16. Сохраните изменения и вернуться в Visual Studio для Mac.

Все эти изменения в месте, изменить **AppDelegate.cs** файл и это должно выглядеть следующим образом:

```csharp
using AppKit;
using Foundation;

namespace MacXib
{
    [Register ("AppDelegate")]
    public class AppDelegate : NSApplicationDelegate
    {
        public MainWindowController mainWindowController { get; set; }

        public AppDelegate ()
        {
        }

        public override void DidFinishLaunching (NSNotification notification)
        {
            // Insert code here to initialize your application
            mainWindowController = new MainWindowController ();
            mainWindowController.Window.MakeKeyAndOrderFront (this);
        }

        public override void WillTerminate (NSNotification notification)
        {
            // Insert code here to tear down your application
        }
    }
}
```

Теперь главного окна приложения определяется в **.xib** файл, включенный в проект автоматически при добавлении контроллер окна. Редактирование своего проекта windows, в **панели решения**, дважды щелкните **MainWindow.xib** файла:

![Выбрав файл MainWindow.xib](xib-images/edit01.png "выбора файла MainWindow.xib")

Он откроется окно конструктора Interface Builder в Xcode:

[![Редактирование MainWindow.xib](xib-images/edit02.png "редактирование MainWindow.xib")](xib-images/edit02-large.png#lightbox)


### <a name="standard-window-workflow"></a>Стандартное окно рабочего процесса

Для любого периода, обратитесь в приложении Xamarin.Mac процесс по существу одинакова:

1. Для новых окон, которые не используются по умолчанию, автоматически добавляется в проект добавьте в проект нового окна определения.
2. Дважды щелкните файл .xib, чтобы открыть окно конструктора для редактирования в Interface Builder в Xcode.
3. Задайте свойства требуется окно **инспекторе атрибутов** и **инспектор размеров**.
4. Перетащите в элементах управления, необходимые для создания собственного интерфейса и настроить их в **инспекторе атрибутов**.
5. Используйте **инспектор размеров** обрабатывать изменения размера для элементов пользовательского интерфейса.
6. Предоставить элементы пользовательского интерфейса окна на C# код с помощью переменных экземпляров и действий.
7. Сохраните изменения и вернитесь в Visual Studio для Mac синхронизировать с Xcode.


### <a name="designing-a-window-layout"></a>Проектирование макета окна

Процесс по разметке пользовательский интерфейс в построителе интерфейса существенно не то же самое для каждого элемента, можно добавить.

1. Найдите нужный элемент управления в **инспектор библиотеки** и перетащите его в **редактор интерфейса** и разместите его.
2. Задайте свойства требуется окно **инспекторе атрибутов**.
3. Используйте **инспектор размеров** обрабатывать изменения размера для элементов пользовательского интерфейса.
4. При использовании пользовательского класса, задайте его в **инспектор удостоверений**.
5. Предоставить элементы пользовательского интерфейса на C# код с помощью переменных экземпляров и действий.
6. Сохраните изменения и вернитесь в Visual Studio для Mac синхронизировать с Xcode.

Пример.

1. В Xcode перетащите **нажимную кнопку**  из **раздела "Библиотека"**:

    [![Выбор элемента из библиотеки](xib-images/xcode07.png "выбора кнопки из библиотеки")](xib-images/xcode07-large.png#lightbox)
2. Перетащите кнопку на **окно** в **редактор интерфейса**:

    [![Добавление кнопки в окне](xib-images/xcode08.png "Добавление кнопки в окне")](xib-images/xcode08-large.png#lightbox)
3. Щелкните свойство **Название** в **инспекторе атрибутов** и измените название кнопки на `Click Me`:

    ![Установив атрибуты кнопку](xib-images/xcode09.png "установив атрибуты кнопки")
4. Перетащите **метку** из **раздела "Библиотека"**:

    [![Выбор метки в библиотеке](xib-images/xcode10.png "Выбор метки в библиотеке")](xib-images/xcode10-large.png#lightbox)
5. Поместите метку в область **Окно** рядом с кнопкой в **редакторе интерфейса**:

    [![Добавление метки в окне](xib-images/xcode11.png "добавление метки в окне")](xib-images/xcode11-large.png#lightbox)
6. Захватите правый маркер метки и перетаскивайте его до границы окна:

    [![Изменение размера метки](xib-images/xcode12.png "изменение размера метки")](xib-images/xcode12-large.png#lightbox)
7. С меткой, по-прежнему выбран в **редактор интерфейса**, переключитесь в **инспектор размеров**:

    ![Выбрав инспектор размеров](xib-images/xcode13.png "выбрав инспектор размеров")
8. В **автоматическое изменение размера поля** щелкните **Dim скобка Red** справа и **Dim горизонтальная стрелка Red** в центре:

    ![Изменение свойств автоматическое изменение размера](xib-images/xcode14.png "редактирование свойств автоматическое изменение размера")
9. Это гарантирует, что метка будет растягиваться увеличивается и уменьшается при изменении размера окна в работающем приложении. **Скобки Red** и верхней и левой части **автоматическое изменение размера поля** поле указать метку "зависнуть" заданных X и Y расположения.
10. Сохранить изменения в пользовательском интерфейсе

Как изменение размера и перемещении элементов управления, вы должны обратить внимание, что Interface Builder дает полезные подсказки на основе [рекомендации по человеческим интерфейсом OS X](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/). Эти рекомендации помогут создавать высококачественные приложения будет похож на интерфейс для пользователей Mac.

Если заглянуть в **иерархия интерфейса** разделе, обратите внимание на то, как показано компоновку и иерархию элементов, составляющих наш пользовательский интерфейс:

![Выбор элемента в иерархии интерфейсов](xib-images/xcode15.png "Выбор элемента в иерархии интерфейса")

Отсюда можно выбрать элементы для редактирования или перетаскивать для изменения порядка элементов пользовательского интерфейса, при необходимости. Например если элемент пользовательского интерфейса перекрыт другим элементом, можно перетащить его в конец списка, чтобы сделать ее верхним элементом в окне.

Дополнительные сведения о работе с Windows в приложении Xamarin.Mac, см. в разделе наших [Windows](~/mac/user-interface/window.md) документации.


## <a name="exposing-ui-elements-to-c-code"></a>Предоставление доступа к элементам пользовательского интерфейса для C# кода

После завершения или списочном внешний вид пользовательского интерфейса в конструктор Interface Builder, вам потребуется предоставить элементы пользовательского интерфейса, таким образом, чтобы они может быть организован C# кода. Чтобы сделать это, вы будете использовать действия и источники.


### <a name="setting-a-custom-main-window-controller"></a>Установка контроллера пользовательских главное окно

Чтобы иметь возможность создать переменные экземпляров и действия, чтобы предоставить элементы пользовательского интерфейса в код C#, приложения Xamarin.Mac необходимо использовать настраиваемый контроллер окна.

Выполните следующие действия:

1. Откройте приложения раскадровку Interface Builder в Xcode.
2. Выберите `NSWindowController` в области конструктора.
3. Переключиться в режим **инспектор удостоверений** Просмотр и ввод `WindowController` как **имя класса**:

    [![Изменение имени класса](xib-images/windowcontroller01.png "редактирования имя класса")](xib-images/windowcontroller01-large.png#lightbox)
4. Сохранить изменения и вернуться в Visual Studio для Mac для синхронизации.
5. Объект **WindowController.cs** файл будет добавлен в проект в **панели решения** в Visual Studio для Mac:

    ![Имя нового класса в Visual Studio для Mac](xib-images/windowcontroller02.png "имя нового класса в Visual Studio для Mac")
6. Снова откройте в раскадровку Interface Builder в Xcode.
7. **WindowController.h** файл будет доступен для использования:

    [![Соответствующие h-файл в Xcode](xib-images/windowcontroller03.png "соответствующим h-файл в Xcode")](xib-images/windowcontroller03-large.png#lightbox)


### <a name="outlets-and-actions"></a>Переменные экземпляров и действия

Так что такое переменных экземпляров и действий В традиционном программировании пользовательского интерфейса .NET добавляемый элемент управления в пользовательском интерфейсе автоматически предоставляется как свойство. В Mac это работает по-другому — простое добавление элемента управления в представление не делает его доступным для кода. Необходимо явно предоставить элемент пользовательского интерфейса в код. В порядке это сделать, Apple дает нам два варианта:

-  **Переменные экземпляров.** Они аналогичны свойствам. Если связать элемент управления привязывается к переменной экземпляра, она предоставляется в коде через свойство, поэтому вы можете выполнять действия, как присоединять обработчики событий, вызывать методы для его и т. д.
-  **Действия.** Они аналогичны командам в WPF. Например когда действие выполняется в элементе управления, например, нажатие кнопки, элемент управления автоматически вызовет метод в коде. Действия — мощное и удобное средство, так как вы можете подключать множество элементов управления к одному действию.

В Xcode, переменные экземпляров и действия добавляются непосредственно в коде с помощью *перетаскивание элемента управления*. В частности, это означает, что для создания розетки или действие, выбрать какой элемент управления, вы бы хотели добавить розетки или действие, удерживая нажатой **управления** кнопку на клавиатуре, перетащить этот элемент управления непосредственно в код.

Для разработчиков Xamarin.Mac это означает, что при перетаскивании в файлы заглушки Objective-C, которые соответствуют C# файла, где требуется создать переменную экземпляра или действия. Visual Studio для Mac создан файл с именем **MainWindow.h** как часть проекта оболочки Xcode, сгенерированного для использования конструктора Interface Builder:

[![Пример h-файл в Xcode](xib-images/xcode16.png "примером h-файл в Xcode")](xib-images/xcode16-large.png#lightbox)

Этот файл-заглушку .h отражает **MainWindow.designer.cs** , автоматически добавляется в проект Xamarin.Mac при создании нового `NSWindow` создается. Этот файл будет использоваться для синхронизации изменений, внесенных конструктором Interface Builder и является, где мы создадим переменные экземпляров и действия, чтобы элементы пользовательского интерфейса передаются C# кода.


#### <a name="adding-an-outlet"></a>Добавление переменной экземпляра

Базовое представление того, что такое переменных экземпляров и действий, давайте взглянем на создание выхода для предоставления элемента пользовательского интерфейса для вашего C# кода.

Выполните следующие действия:

1. В Xcode в правом верхнем углу экрана нажмите кнопку с изображением **двойного круга**, чтобы открыть **вспомогательный редактор**:

    [![Выбрав редакторе помощника](xib-images/outlet01.png "выбрав вспомогательного редактора")](xib-images/outlet01-large.png#lightbox)
2. Xcode переключится в комбинированный режим, где в одной стороне находится **редактор интерфейса**, а в другой — **редактор кода**.
3. Обратите внимание, что Xcode автоматически выбран **MainWindowController.m** файл **редактор кода**, что неверно. Если вы помните из нашего обсуждения переменных экземпляров и действий Каковы выше, необходимо иметь **MainWindow.h** выбранного.
4. В верхней части **редактор кода** щелкните **автоматическую ссылку** и выберите **MainWindow.h** файла:

    [![Выбор правильного h-файл](xib-images/outlet02.png "выбрав правильный h-файл")](xib-images/outlet02-large.png#lightbox)
5. Теперь в Xcode должен быть выбран правильный файл:

    [![Выбран правильный файл](xib-images/outlet03.png "выбран правильный файл")](xib-images/outlet03-large.png#lightbox)
6. **Последнее действие было очень важным!** Если у вас выбран правильный файл, вы не сможете создать переменные экземпляров и действий, или они будут предоставлены в неправильный класс на C#!
7. В **редактор интерфейса**, удерживая нажатой **управления** клавишу на клавиатуре, щелкните и перетащите метку, мы создали выше, в редактор кода сразу же под `@interface MainWindow : NSWindow { }` кода:

    [![Перетаскивание для создания нового выхода](xib-images/outlet04.png "перетаскивание для создания новой переменной экземпляра")](xib-images/outlet04-large.png#lightbox)
8. Откроется диалоговое окно. Оставьте **подключения** присвоено переменной экземпляра и введите `ClickedLabel` для **имя**:

    [![Задание свойств переменной экземпляра](xib-images/outlet05.png "задание свойств переменной экземпляра")](xib-images/outlet05-large.png#lightbox)
9. Нажмите кнопку **Connect** кнопку, чтобы создать на выходе:

    ![Завершенные розетки](xib-images/outlet06.png "завершенного переменной экземпляра")
10. Сохраните изменения в файле.


#### <a name="adding-an-action"></a>Добавление действия

Теперь давайте попробуем создать действие для улучшения взаимодействия пользователя с элементом пользовательского интерфейса для вашего C# кода.

Выполните следующие действия:

1. Убедитесь, что мы все еще являются **вспомогательном редакторе** и **MainWindow.h** отображается файл **редактор кода**.
2. В **редактор интерфейса**, удерживая нажатой **управления** клавишу на клавиатуре, щелкните и перетащите кнопку, мы создали выше, в редактор кода сразу же под `@property (assign) IBOutlet NSTextField *ClickedLabel;` кода:

    [![Перетаскивание для создания действий](xib-images/action01.png "перетаскивание для создания действия")](xib-images/action01-large.png#lightbox)
3. Изменение **подключения** тип действия:

    [![Выберите тип действия](xib-images/action02.png "выберите тип действия")](xib-images/action02-large.png#lightbox)
4. Введите `ClickedButton` в поле **Имя**:

    [![Настройка действия](xib-images/action03.png "Настройка действия")](xib-images/action03-large.png#lightbox)
5. Нажмите кнопку **Connect** кнопку, чтобы создать действие:

    ![Выполненного действия](xib-images/action04.png "выполненного действия")
6. Сохраните изменения в файле.

С помощью пользовательского интерфейса привязав и подвержен C# код, переключитесь в Visual Studio для Mac и позвольте ей синхронизации изменений между Xcode и конструкторе Interface Builder.


### <a name="writing-the-code"></a>Написание кода

Создав пользовательский интерфейс и его элементы пользовательского интерфейса, открыт для кода с помощью переменных экземпляров и действий вы будете готовы написать код для реализации программы. Например, откройте **MainWindow.cs** файл для редактирования, дважды щелкнув его в **панели решения**:

[![Файл MainWindow.cs](xib-images/code01.png "MainWindow.cs файла")](xib-images/code01-large.png#lightbox)

И добавьте следующий код, чтобы `MainWindow` класс для работы с на выходе пример, созданный выше:

```csharp
private int numberOfTimesClicked = 0;
...

public override void AwakeFromNib ()
{
    base.AwakeFromNib ();

    // Set the initial value for the label
    ClickedLabel.StringValue = "Button has not been clicked yet.";
}
```

Обратите внимание, что `NSLabel` осуществляется в C# по прямой имя, присвоенное его в Xcode, при создании его выхода в Xcode, таким образом, он называется `ClickedLabel`. Вы может получить доступ к любой метод или свойство, предоставляемого объекта так же, как любой обычный C# класса.

> [!IMPORTANT]
> Необходимо использовать `AwakeFromNib`, вместо другого метода, такого как `Initialize`, так как `AwakeFromNib` называется _после_ ОС загрузит и пользовательский интерфейс из файла .xib. Если использовались для доступа к элементу управления метки до файла .xib полной загрузки и создания экземпляра, получится `NullReferenceException` ошибка, так как элемент управления label бы еще не создан.

Затем добавьте следующие разделяемые классы `MainWindow` класс:

```csharp
partial void ClickedButton (Foundation.NSObject sender) {

    // Update counter and label
    ClickedLabel.StringValue = string.Format("The button has been clicked {0} time{1}.",++numberOfTimesClicked, (numberOfTimesClicked < 2) ? "" : "s");
}
```

Этот код присоединяет к действию, который был создан в Xcode и конструкторе Interface Builder и будет вызываться при каждом нажатии кнопки.

Некоторые элементы пользовательского интерфейса автоматически имеют встроенные действия, например, элементов на панели меню по умолчанию такие как **открыть...**  пункта меню (`openDocument:`). В **панели решения**, дважды щелкните **AppDelegate.cs** файл, чтобы открыть его для редактирования и добавьте следующий код ниже `DidFinishLaunching` метод:

```csharp
[Export ("openDocument:")]
void OpenDialog (NSObject sender)
{
    var dlg = NSOpenPanel.OpenPanel;
    dlg.CanChooseFiles = false;
    dlg.CanChooseDirectories = true;

    if (dlg.RunModal () == 1) {
        var alert = new NSAlert () {
            AlertStyle = NSAlertStyle.Informational,
            InformativeText = "At this point we should do something with the folder that the user just selected in the Open File Dialog box...",
            MessageText = "Folder Selected"
        };
        alert.RunModal ();
    }
}
```

Строки ключа является `[Export ("openDocument:")]`, он сообщает `NSMenu` , **AppDelegate** имеет метод `void OpenDialog (NSObject sender)` , реагирующий на `openDocument:` действие.

Дополнительные сведения о работе с меню, см. в разделе наших [меню](~/mac/user-interface/menu.md) документации.


## <a name="synchronizing-changes-with-xcode"></a>Синхронизация изменений с Xcode

При переключении обратно в Visual Studio для Mac с Xcode, любые изменения, внесенные в Xcode, автоматически синхронизируются с проектом Xamarin.Mac.

При выборе **MainWindow.designer.cs** в **панели решения** вы сможете увидеть, как наши розетки и действия связи между вверх наших C# кода:

[![Синхронизация изменений с Xcode](xib-images/sync01.png "синхронизация изменений с Xcode")](xib-images/sync01-large.png#lightbox)

Обратите внимание, что как два определения в **MainWindow.designer.cs** файла:

```csharp
[Outlet]
AppKit.NSTextField ClickedLabel { get; set; }

[Action ("ClickedButton:")]
partial void ClickedButton (Foundation.NSObject sender);
```

Выравнивание с помощью определения из **MainWindow.h** файл в Xcode:

```objc
@property (assign) IBOutlet NSTextField *ClickedLabel;
- (IBAction)ClickedButton:(id)sender;
```

Как вы видите, Visual Studio для Mac прослушивает изменения в h-файл и затем автоматически синхронизирует их в соответствующие **. designer.cs** файл, чтобы сделать его доступным для приложения. Также можно заметить, **MainWindow.designer.cs** является разделяемым классом, таким образом, чтобы Visual Studio для Mac не нужно изменять **MainWindow.cs** который перезапишет любые изменения, которые мы внесли в класс.

Обычно не нужно будет открыть **MainWindow.designer.cs** самостоятельно, он был представлен здесь только в целях обучения.

> [!IMPORTANT]
> В большинстве случаев Visual Studio для Mac автоматически видит изменения, внесенные в Xcode и синхронизировать их в проект Xamarin.Mac. В ситуации, если синхронизация не выполняется автоматически, вернитесь в Xcode и еще раз вернитесь в Visual Studio для Mac. Обычно эти действия запускают цикл синхронизации.


## <a name="adding-a-new-window-to-a-project"></a>Добавление в проект новое окно

Помимо основным окном документа в приложении Xamarin.Mac может потребоваться отображать другие типы окон для пользователя, например адаптируются к предпочтениям или панели инспектора. При добавлении в проект нового следует всегда использовать **окно Cocoa с контроллером** параметра, как это делает процесс загрузки окна из .xib файл проще.

Чтобы добавить новое окно, сделайте следующее:

1. В **панели решения**, правой кнопкой мыши проект и выберите **добавить** > **новый файл...** .
2. В диалоговом окне нового файла выберите **Xamarin.Mac** > **окно Cocoa с контроллером**:

    ![Добавления нового контроллера окно](xib-images/new01.png "добавления нового окна контроллера")
3. Введите в поле **Имя** значение `PreferencesWindow` и нажмите кнопку **Новый**.
4. Дважды щелкните **PreferencesWindow.xib** файл, чтобы открыть его для редактирования в конструкторе Interface Builder:

    [![Окно в Xcode](xib-images/new02.png "окно в Xcode")](xib-images/new02-large.png#lightbox)
5. Спроектировать свой интерфейс:

    [![Разработка макета windows](xib-images/new03.png "разработка макета windows")](xib-images/new03-large.png#lightbox)
6. Сохранить изменения и вернуться в Visual Studio для Mac синхронизировать с Xcode.

Добавьте следующий код, чтобы **AppDelegate.cs** для отображения в новом окне:

```csharp
[Export("applicationPreferences:")]
void ShowPreferences (NSObject sender)
{
    var preferences = new PreferencesWindowController ();
    preferences.Window.MakeKeyAndOrderFront (this);
}
```

`var preferences = new PreferencesWindowController ();` Строка создает новый экземпляр окна контроллера, который загружает из файла .xib окна и увеличивает его. `preferences.Window.MakeKeyAndOrderFront (this);` Строки отображает новое окно для пользователя.

Если вы запустите код и выберите **предпочтения...**  из **меню приложения**, откроется окно:

![При запуске образца приложения](xib-images/new04.png "при запуске образца приложения")

Дополнительные сведения о работе с Windows в приложении Xamarin.Mac, см. в разделе наших [Windows](~/mac/user-interface/window.md) документации.


## <a name="adding-a-new-view-to-a-project"></a>Добавление нового представления в проект

Бывают случаи, когда стало проще в окне конструктора разбить на несколько более управляемыми xib-файлов. Например, как переключение содержимое главного окна, при выборе элемента панели инструментов в **окно предпочтений** или замените содержимое в ответ **исходного списка** выбора.

При добавлении нового представления в проект следует всегда использовать **представление Cocoa с контроллером** параметра, как это делает процесс загрузки представления из .xib файл проще.

Чтобы добавить новое представление, сделайте следующее:

1. В **панели решения**, правой кнопкой мыши проект и выберите **добавить** > **новый файл...** .
2. В диалоговом окне нового файла выберите **Xamarin.Mac** > **представление Cocoa с контроллером**:

    ![Добавление нового представления](xib-images/view01.png "добавлении нового представления")
3. Введите в поле **Имя** значение `SubviewTable` и нажмите кнопку **Новый**.
4. Дважды щелкните **SubviewTable.xib** файл, чтобы открыть его для редактирования в конструкторе Interface Builder и разработке пользовательского интерфейса:

    [![Разработка нового представления в Xcode](xib-images/view02.png "разработки нового представления в Xcode")](xib-images/view02-large.png#lightbox)
5. Подключить все необходимые действия и переменные экземпляров.
6. Сохранить изменения и вернуться в Visual Studio для Mac синхронизировать с Xcode.

Далее изменить **SubviewTable.cs** и добавьте следующий код, чтобы **AwakeFromNib** файл для заполнения нового представления при загрузке:

```csharp
public override void AwakeFromNib ()
{
    base.AwakeFromNib ();

    // Create the Product Table Data Source and populate it
    var DataSource = new ProductTableDataSource ();
    DataSource.Products.Add (new Product ("Xamarin.iOS", "Allows you to develop native iOS Applications in C#"));
    DataSource.Products.Add (new Product ("Xamarin.Android", "Allows you to develop native Android Applications in C#"));
    DataSource.Products.Add (new Product ("Xamarin.Mac", "Allows you to develop Mac native Applications in C#"));
    DataSource.Sort ("Title", true);

    // Populate the Product Table
    ProductTable.DataSource = DataSource;
    ProductTable.Delegate = new ProductTableDelegate (DataSource);

    // Auto select the first row
    ProductTable.SelectRow (0, false);
}
```

Добавьте в проект для отслеживания, какое представление в настоящее время выполняется отображение перечисления. Например **SubviewType.cs**:

```csharp
public enum SubviewType
{
    None,
    TableView,
    OutlineView,
    ImageView
}
```

Измените файл .xib окна, которое будет использование представления и его отображения. Добавить **пользовательское представление** , будет выступать в качестве контейнера для представления после их загрузки в память по C# кода и привести к переменной экземпляра вызывается `ViewContainer`:

[![Создание необходимых розетки](xib-images/view03.png "создание необходимых переменной экземпляра")](xib-images/view03-large.png#lightbox)

Сохранить изменения и вернуться в Visual Studio для Mac синхронизировать с Xcode.

Теперь измените CS-файле окна, которое будет применяться для отображения нового представления (например, **MainWindow.cs**) и добавьте следующий код:

```csharp
private SubviewType ViewType = SubviewType.None;
private NSViewController SubviewController = null;
private NSView Subview = null;
...

private void DisplaySubview(NSViewController controller, SubviewType type) {

    // Is this view already displayed?
    if (ViewType == type) return;

    // Is there a view already being displayed?
    if (Subview != null) {
        // Yes, remove it from the view
        Subview.RemoveFromSuperview ();

        // Release memory
        Subview = null;
        SubviewController = null;
    }

    // Save values
    ViewType = type;
    SubviewController = controller;
    Subview = controller.View;

    // Define frame and display
    Subview.Frame = new CGRect (0, 0, ViewContainer.Frame.Width, ViewContainer.Frame.Height);
    ViewContainer.AddSubview (Subview);
}
```

Если необходимо показать новое представление, загруженная из файла .xib в контейнере окна ( **пользовательское представление** добавленных выше), этот код обрабатывает удаление любого существующего представления и последующее переключение out для создания нового. Он проверяет его у вас уже есть представление, отображаемое, если таким образом он удаляется из экрана. Далее необходимое представления, который был передан в (а загружаются из контроллера представления) изменяет размер в соответствии с потребностями в области содержимого и добавляет его к содержимому для отображения.

Чтобы отобразить новое представление, используйте следующий код:

```csharp
DisplaySubview(new SubviewTableController(), SubviewType.TableView);
```

Это создает новый экземпляр контроллера представления для нового представления для отображения, устанавливает его тип (как указано в перечисление добавлены в проект) и использует `DisplaySubview` метод в класс окна фактически выводит представление. Пример:

[![При запуске образца приложения](xib-images/view04.png "при запуске образца приложения")](xib-images/view04-large.png#lightbox)

Дополнительные сведения о работе с Windows в приложении Xamarin.Mac, см. в разделе наших [Windows](~/mac/user-interface/window.md) и [диалоговые окна](~/mac/user-interface/dialog.md) документации.


## <a name="summary"></a>Сводка

В этой статье были предприняты никакие подробные принципы работы с xib-файлов в приложении Xamarin.Mac. Мы видели различные типы и варианты использования xib-файлы для создания пользовательского интерфейса приложения, как создавать и обслуживать .xib файлы в Xcode интерфейс построителя и способы работы с xib-файлы в C# кода.


## <a name="related-links"></a>Связанные ссылки

- [MacImages (пример)](https://developer.xamarin.com/samples/mac/MacImages/)
- [Привет, Mac](~/mac/get-started/hello-mac.md)
- [Windows](~/mac/user-interface/window.md)
- [Меню](~/mac/user-interface/menu.md)
- [Диалоговые окна](~/mac/user-interface/dialog.md)
- [Работа с изображениями](~/mac/app-fundamentals/image.md)
- [Рекомендации по созданию пользовательских интерфейсов в macOS](https://developer.apple.com/macos/human-interface-guidelines/overview/themes/)
