---
title: Установка внедрения .NET
description: В этом документе описывается установка внедрения .NET. В нем описывается, как запускать средства вручную, как создавать привязки автоматически, как использовать пользовательские целевые объекты MSBuild и выполнять необходимые действия после сборки.
ms.prod: xamarin
ms.assetid: 47106AF3-AC6E-4A0E-B30B-9F73C116DDB3
author: chamons
ms.author: chhamo
ms.date: 04/18/2018
ms.openlocfilehash: 47efbaa12475f627b5963cb6613c3441a1d96aac
ms.sourcegitcommit: c9651cad80c2865bc628349d30e82721c01ddb4a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/03/2019
ms.locfileid: "70227837"
---
# <a name="installing-net-embedding"></a>Установка внедрения .NET

## <a name="installing-net-embedding-from-nuget"></a>Установка внедрения .NET из NuGet

Выберите **добавить > добавить пакеты NuGet...** и установите **ембеддинатор-4000** из диспетчера пакетов NuGet:

![Диспетчер пакетов NuGet](images/visualstudionuget.png)

При этом **Embeddinator-4000. exe** и **обжкжен** будут установлены в каталог **packages/ембеддинатор-4000/Tools** .

Как правило, для загрузки необходимо выбрать последний выпуск Ембеддинатор-4000. Для поддержки цели-C требуется 0,4 или более поздняя версия.

## <a name="running-manually"></a>Запуск вручную

Теперь, когда NuGet установлен, можно запустить Инструментарий вручную.

- Откройте окно терминала (macOS) или командную строку (Windows)
- Перейдите в корневой каталог решения.
- Инструментарий устанавливается в:
  - **./Packages/Embeddinator-4000. [Версия]/тулс/обжкжен** (цель-C)
  - **./Packages/Embeddinator-4000. [Версия]/tools/Embeddinator-4000.exe** (Java/C)
- В macOS **обжкжен** можно запустить напрямую.
- В Windows **Embeddinator-4000. exe** можно запустить напрямую.
- В macOS необходимо запустить **Embeddinator-4000. exe** с **Mono**:
  - `mono ./packages/Embeddinator-4000.[VERSION]/tools/Embeddinator-4000.exe`

При каждом вызове команды потребуется ряд параметров, перечисленных в документации для конкретной платформы.

## <a name="automatic-binding-generation"></a>Автоматическое создание привязок

Существует два подхода к автоматическому запуску процесса сборки, внедренного в .NET.

- Пользовательские целевые объекты MSBuild
- Шаги, выполняемые после сборки

Хотя в этом документе будет описываться и то, и другое, предпочтительнее использовать настраиваемый целевой объект MSBuild. Шаги после сборки не обязательно будут выполняться при сборке из командной строки.

### <a name="custom-msbuild-targets"></a>Пользовательские целевые объекты MSBuild

Чтобы настроить сборку с помощью целевых объектов MSbuild, сначала создайте файл **ембеддинатор-4000. targets** рядом с CSPROJ, как показано ниже:

```xml
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Target Name="RunEmbeddinator" AfterTargets="AfterBuild" Inputs="$(OutputPath)/$(AssemblyName).dll" Outputs="$(IntermediateOutputPath)/Embeddinator/$(AssemblyName).framework/$(AssemblyName)">
        <Exec Command="" />
    </Target>
</Project>
```

Здесь текст команды должен быть заполнен одним из вызовов внедрения .NET, перечисленных в документации для конкретной платформы.

Чтобы использовать этот целевой объект:

- Закройте проект в Visual Studio 2017 или Visual Studio для Mac
- Открытие библиотеки CSPROJ в текстовом редакторе
- Добавьте эту строку внизу, над последней `</Project>` строкой:

```xml
 <Import Project="Embeddinator-4000.targets" />
```

- Повторное открытие проекта

### <a name="post-build-steps"></a>Шаги, выполняемые после сборки

Шаги по добавлению шага после сборки для запуска внедрения .NET зависят от интегрированной среды разработки.

#### <a name="visual-studio-for-mac"></a>Visual Studio для Mac

В Visual Studio для Mac перейдите в раздел **Параметры проекта > создать > пользовательские команды** и добавьте шаг **после сборки** .

Настройте команду, указанную в документации для конкретной платформы.

> [!NOTE]
> Обязательно используйте номер версии, установленный из NuGet.

Если планируется выполнение текущей разработки C# проекта, можно также добавить пользовательскую команду для очистки **выходного** каталога перед запуском внедрения .NET:

```shell
rm -Rf '${SolutionDir}/output/'
```

![Настраиваемое действие сборки](images/visualstudiocustombuild.png)

> [!NOTE]
> Созданная привязка будет помещена в каталог, указанный `--outdir` параметром или. `--out` Созданное имя привязки может отличаться, так как некоторые платформы имеют ограничения на имена пакетов.

#### <a name="visual-studio-2017"></a>Visual Studio 2017

Мы будем настраивать то же самое, но меню в Visual Studio 2017 немного отличаются. Команды оболочки также немного отличаются.

Перейдите в раздел **Параметры проекта > события сборки** и введите команду, указанную в документации для конкретной платформы, в поле **Командная строка события после сборки** . Например:

![Внедрение .NET в Windows](images/visualstudiowindows.png)
 