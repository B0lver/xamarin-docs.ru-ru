---
title: Xamarin Profiler
description: В этом руководстве рассматриваются основные функции Xamarin Profiler. Найдите в средства профилирования, профилирование и когда их следует использовать и в стандартного рабочего процесса для профилирования приложения Xamarin.
ms.prod: xamarin
ms.assetid: 3247fcee-6acc-470d-ab87-c1c511d67363
author: lobrien
ms.author: laobri
ms.date: 06/03/2018
ms.openlocfilehash: 15739ff191953e4730d44c6ad9f63dccb9a0017e
ms.sourcegitcommit: 57e8a0a10246ff9a4bd37f01d67ddc635f81e723
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/08/2019
ms.locfileid: "57668417"
---
# <a name="xamarin-profiler"></a>Xamarin Profiler

_В этом руководстве рассматриваются основные функции Xamarin Profiler. Найдите в средства профилирования, профилирование и когда их следует использовать и в стандартного рабочего процесса для профилирования приложения Xamarin._

Успех приложения зависит от взаимодействие с пользователем. Как разработчик может реализован ряд действительно замечательных функций в приложении, но если приложение является низкой производительностью или полного сбоя, пользователь скорее всего избавиться от него.

Исторически Mono специальные мощные командной строки профилировщика для сбора сведений о программах, работающих в среде выполнения Mono, которая называется [профилировщик Mono журнала](https://www.mono-project.com/docs/debug+profile/profile/profiler/). Xamarin Profiler графический интерфейс для Mono журнала профилировщика и поддерживает профилирование Android, iOS, tvOS и приложений для Mac на Mac и Android, iOS и tvOS приложений на Windows.

Xamarin Profiler имеет ряд инструментов для профилирования, выделения, циклы и время Profiler. В этом руководстве изучаются что измеряют эти инструменты и как они анализируют приложение, а также поясняется значение данных, представленных на каждом экране.

В этом руководстве рассматриваются распространенные сценарии профилирования и вводит профилировщик как средство для анализа и оптимизации приложений iOS и Android.

## <a name="download-and-install"></a>Скачайте и установите

> [!NOTE]
> Вам необходимо будет [Visual Studio Enterprise](https://visualstudio.microsoft.com/vs/compare/) подписчика, чтобы разблокировать эту функцию в любом Visual Studio Enterprise на Windows или Visual Studio для Mac на компьютерах Mac.

Xamarin Profiler — это автономное приложение, а также интегрируется с Visual Studio для Mac и Visual Studio для включения профилирования из интегрированной среды разработки.

Скачайте пакет установки для вашей платформы.

- [**macOS**](https://dl.xamarin.com/profiler/profiler-mac.pkg)
- [**Windows**](https://dl.xamarin.com/profiler/profiler-windows.msi)

После скачивания запустите установщик, чтобы добавить Xamarin Profiler в систему.

## <a name="profilers-and-profiling"></a>Средства профилирования и профилирование

Профилирование — это важные и часто не уделяют должного внимания шаг в разработке приложений. Профилирование является разновидностью **анализа динамического программирования** -анализирует программы, пока он работает и находится в использования. Профилировщик — это средство интеллектуального анализа данных, которое собирает сведения о времени сложности, использование некоторых методов и выделяется память. Профилировщик позволяет глубокой детализации и анализировать эти метрики для выявления проблем в коде.

При проектировании и разработке приложения, важно не оптимизировать преждевременно; то есть тратить время на разработку кода в областях, которые редко будет осуществляться. Это возможности для профилирования. Профилировщик обеспечивает представление о наиболее часто используемые части базы кода и помогает обнаружения областей, необходимо потратить время внесения улучшений. Разработчикам следует позаботиться для понимания, проведенного в большинстве случаев в приложении, и использование памяти приложением.

Профилирование полезна для всех типов разработки, но это особенно важно для разработки мобильных приложений. Код становится гораздо более заметно на мобильных платформах, чем на настольных компьютерах и успех вашего приложения зависит от привлекательных и оптимизированный код, который эффективно выполняется в неоптимизированном виде.

## <a name="xamarin-profiler"></a>Xamarin Profiler

Xamarin Profiler предоставляет разработчикам способ профилировать приложения из среды Visual Studio для Mac или Visual Studio. Профилировщик собирает и отображает сведения о приложении, который затем может использоваться разработчиком для анализа поведения приложения. Существует несколько способов выполнить профилирование приложения с помощью Xamarin Profiler, а именно профилирование памяти и статистическая выборка. Они выполняются через выделения памяти и времени Profiler инструментирует соответственно.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

В настоящее время Xamarin Profiler может использоваться для тестирования приложений Xamarin.iOS, Xamarin.Android и Xamarin.Mac на компьютере Mac (с помощью Visual Studio для Mac). Профилировщик — это отдельный процесс, в интегрированной среде разработки, и таким образом, в дополнение к запуске из Visual Studio для Mac, его можно использовать как автономное приложение для проверки .exe и `.mlpd` файлы, которые выдали из [профилировщик mono журнала](https://www.mono-project.com/docs/debug+profile/profile/profiler/).

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

В настоящее время Xamarin Profiler может использоваться для тестирования приложений Xamarin.Android в Windows (с помощью Visual Studio и Visual Studio для Mac). Профилировщик — это отдельный процесс, в интегрированной среде разработки, и таким образом, в дополнение к запуске из Visual Studio, его можно использовать как автономное приложение для проверки .exe и `.mlpd` файлы, которые выдали из [профилировщик mono журнала](https://www.mono-project.com/docs/debug+profile/profile/profiler/) .

-----

<a name="Profiler_Support" />

## <a name="profiler-support"></a>Поддержка Profiler

Поддержка Xamarin Profiler доступно на следующих платформах:

 - Visual Studio для Mac (с корпоративной лицензией, macOS)
    - Android
        - Устройства и эмулятор
    - iOS
        - Устройств и симуляторов
    - tvOS (инструмент времени не поддерживается)
        - Устройств и симуляторов
    - Mac

 - Visual Studio (только **Enterprise** версии)
    - Android
        - Устройства и эмулятор
    - iOS [экспериментальная функция]
        - Устройств и симуляторов
    - tvOS
        - Устройств и симуляторов

Обратите внимание, что вы можете **только** профиль **Отладка** конфигураций.

## <a name="profiler-basics"></a>Основные сведения о Profiler

В этом разделе представлены части Xamarin Profiler и обзор его возможностей.

### <a name="allow-profiling-in-your-app"></a>Разрешить профилирования в приложении

Прежде чем вы успешно профилировать приложение, необходимо разрешить профилирования в параметрах приложения проекта.

 - iOS:

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  **Построение > Отладка iOS > включить профилирование**

  ![](images/ios-options-mac.png "iOS диалоговое окно параметров в Visual Studio для Mac")

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  **Свойства > сборка iOS > включить профилирование**

  ![](images/ios-project-options-vs.png "диалоговое окно параметров в Visual Studio iOS")

-----

 - Android:

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  **Построение > отладки Android > включить инструментирование для разработчика**

  ![Диалоговое окно Параметры Android в Visual Studio для Mac](images/android-project-options.png)

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  **Построение > отладки Android > включить инструментирование для разработчика**

  ![Диалоговое окно Параметры Android в Visual Studio для Mac](images/android-project-options-vs-sml.png)

-----

### <a name="launching-the-profiler"></a>Запуск Profiler

В интегрированной среде разработки при профилировании iOS или Android приложения или как отдельное приложение можно запустить Xamarin Profiler.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

#### <a name="launching-from-visual-studio-for-mac"></a>Запуск из Visual Studio для Mac

1. Во-первых убедитесь, что, пока приложение будет загружен в Visual Studio для Mac и выберите конфигурацию отладки (по умолчанию).
2. Перейдите к **запуска > запустить профилирование**в Visual Studio для Mac, или **анализ > Xamarin Profiler** в Visual Studio, чтобы открыть Profiler, как показано на следующей схеме:

  ![](images/start-profiling-xs.png "Запуск Profiler из Visual Studio для Mac")

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

#### <a name="launching-from-visual-studio"></a>Запуск из Visual Studio

1.  Во-первых убедитесь, что, пока приложение будет загружен в Visual Studio и Выбор конфигурации отладки (по умолчанию), как указано выше.
2.  Перейдите к **анализ > Xamarin Profiler** в Visual Studio, чтобы открыть Profiler, как показано на следующей схеме:

![Запуск Profiler из Visual Studio](images/start-profiling-vs.png)

-----

Если отсутствуют элементы меню, к [руководство по устранению неполадок](~/tools/profiler/troubleshooting.md).

Это запускает Profiler и автоматически запускает профилирование приложения.

Profiler может использоваться для измерения памяти и производительности. Это достигается с помощью выделения памяти и времени Profiler instruments, мы рассмотрим подробно в следующем разделе.

#### <a name="saving-and-loading-profiler-sessions"></a>Сохранение и загрузка сеансов Profiler

Чтобы сохранить сеанс профилирования, в любое время, выберите **файл > Сохранить как...**  в строке меню Profiler. Это сохраняет файл в _mlpd_ формате, формате специальные, высокой степенью сжатия для данных профилирования.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

После установки Xamarin Profiler можно найти в папке приложения, как показано на следующем снимке экрана:

![](images/applications.png "Открыть автономный Profiler из Mac")

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

После установки приложение Xamarin Profiler можно найти в каталоге приложения:

![](images/applications-vs.png "Открыть автономный Profiler из Windows ")

-----

Вы можете загрузить *.mlpd* файлы в Profiler, открыв автономное приложение, выбрав **выбрать целевой объект** и загрузке файла.

Дополнительные сведения см. в разделе [Создание файлов .mlpd ](~/tools/profiler/troubleshooting.md#gen_mlpd).

## <a name="profiler-features"></a>Функции Profiler

Xamarin Profiler состоит из пяти разделов, как показано ниже:

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

[![](images/profiler-mac-sml.png "Profiler разделы в Visual Studio для Mac")](images/profiler-mac.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

[![](images/profiler-vs.png "Profiler разделы в Visual Studio")](images/profiler-vs.png#lightbox)

-----

- **Панель инструментов** — находится в верхней части профилировщика, это обеспечивает параметры запуска и остановки профилирования, выберите целевой процесс, просмотреть время выполнения приложения и выберите разделение представления, из которых состоит приложение profiler.
- **Инструментирование списка** — эта команда выводит все инструменты, которые загружены в течение сеанса профилирования.
- **Построить диаграмму** — эти диаграммы по горизонтали связаны с соответствующих инструментов в списке инструментирования. Изменение масштаба можно использовать ползунок (показаны под Profiler времени).
- **Инструментирование область сведений** -содержит данные, отображаемых в выбранном представлении текущего документа. Мы рассмотрим эти представления, более подробно в следующем разделе.
- **Представление инспектор** – это содержит разделы, которые можно выбрать с помощью сегментированных элемента управления. В разделах зависят от выбранного инструмента и включает в себя: Параметры конфигурации, статистику, сведения о трассировке стека, а также путь к корней.

### <a name="allocations"></a>Выделение

Инструмент выделения предоставляет подробные сведения об объектах в приложении, как они создаются и сборщиком мусора.

В верхней части профилировщика является диаграмму распределения, которая отображает объем памяти, выделенной с регулярными интервалами, во время профилирования. В настоящее время граф распределения — общее число выделений, а не размер кучи в этот момент времени. В некотором смысле оно никогда не переместится, только когда-нибудь увеличится. Сюда входят объекты, размещенные в стеке. В зависимости от версией среды выполнения диаграммы могут отличаться — даже для одного приложения.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

[![](images/allocations1.png "Инструмент выделения")](images/allocations1.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

[![](images/allocations1-vs.png "Инструмент выделения")](images/allocations1-vs.png#lightbox)

-----

Существуют разных представлений данных в инструмент выделения, которые позволяют разработчикам анализировать как свои приложения с помощью и освобождении памяти. Ниже описаны эти представления:

 -   **Выделение** — это список всех операций выделения и группирует их по имени класса. Это обеспечивает великолепный Обзор классы и методы, как часто они используются и общий размер классы, используемые. Дважды щелкнув класс будет показано как память, выделенную: 

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  [![](images/allocations3.png "Вкладка выделения")](images/allocations3.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  [![](images/allocations2-vs.png "Вкладка выделения")](images/allocations2-vs.png#lightbox)

-----

Инспектор представления для выделений предоставляет параметры фильтрации и группирования объектов, который предоставляет статистику на выделенной памяти и максимальные выделения, а также представления для трассировки стека и путь к корню.

 -   **Дерево вызовов** — отображается дерево вызовов всех потоков в приложении и включает в себя сведения о памяти, выделенной на каждом узле. При выборе элемента в списке всех одноуровневых узлов будет отображаться серый цвет. Можно развернуть дерево или дважды щелкнуть элемент, чтобы детализировать его. При отображении этого представления данных, в представлении инспектор параметров отображения позволяют изменить способ их представления. В настоящее время существует два варианта:
    1.  **Инвертированная дерево вызовов** – это считает, что трассировка стека сверху вниз. Это удобный просмотр вариант так как она показывает самой глубокой методы ЦП тратит время его.
    2.  **Отдельный поток** — этот параметр позволяет упорядочить дерево вызовов потоком.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  [![](images/allocations2.png "Вкладка «Дерево вызовов»")](images/allocations2.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  [![](images/allocations3-vs.png "Вкладка «Дерево вызовов»")](images/allocations3-vs.png#lightbox)

-----

 -   **Моментальные снимки** — в этой области отображаются сведения о моментальных снимках памяти. Чтобы создать их при профилировании приложения в реальном времени, щелкните _камеры_ кнопку на панели инструментов в каждой точке, вы бы хотели видеть сохраняется и выпущен памяти. Затем можно щелкнуть каждый моментальный снимок, чтобы изучить, что происходит за кулисами. Обратите внимание на то, что моментальные снимки можно создавать только после ввода в эксплуатацию, профилирование приложения. 

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  [![](images/allocations4.png "Вкладка моментальные снимки")](images/allocations4.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  [![](images/allocations4-vs.png "Вкладка моментальные снимки")](images/allocations4-vs.png#lightbox)

-----

### <a name="time-profiler"></a>Время Profiler

Инструмент Profiler время измеряет точно сколько времени занимает каждый метод приложения. Приложение приостановлено с регулярными интервалами, и трассировку стека выполняется на каждому активному потоку. Каждая строка в область данных инструментирования показывает путь выполнения, соблюдается.

Блочная диаграмма, как показано на снимке экрана ниже, отображает количество выборок, полученные приложением, во время выполнения:

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

[![Инструмент Profiler времени](images/time1.png)](images/time1.png#lightbox) 

[![Инструмент Profiler времени — список примеров](images/time3.png)](images/time3.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

[![Инструмент Profiler времени](images/time1-vs.png)](images/time1-vs.png#lightbox) 

[![Инструмент Profiler времени — список примеров](images/time3-vs.png)](images/time3-vs.png#lightbox) 

-----

- **Дерево вызовов** — показывает количество времени, затраченное на каждый метод:

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

  [![](images/time2.png "Инструмент Profiler времени — дерево вызовов")](images/time2.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

  [![](images/time2-vs.png "Инструмент Profiler времени — дерево вызовов")](images/time2-vs.png#lightbox) 

-----

### <a name="cycles"></a>Циклы

Воспользоваться C# и F# управляемого кода, она может быть довольно часто и к сожалению, довольно просто создание ссылок на объекты, которые никогда не будет удален. Этот инструмент позволяет выявить эти объекты и отобразить циклов, на которые ссылается приложение.

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

[![Инструмент циклов](images/cycles.m751-sml.png)](images/cycles.m751.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

[![Инструмент циклов](images/cycles-vs-sml.png)](images/cycles-vs.png#lightbox) 

-----

## <a name="profiling-applications"></a>Профилирование приложений

В настоящее время можно профилировать только настройки отладки по умолчанию.

Если вы выполняете профилирование приложения с помощью любой другой конфигурации, появится следующее диалоговое окно сообщения:


# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

[![Профилирование диалоговое окно ошибки](images/image001.png)](images/image001.png#lightbox) 

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

[![](images/image1vs.png "Профилирование диалоговое окно ошибки")](images/image1vs.png#lightbox) 

-----

Выберите **обновления** для продолжения.

### <a name="sgen-garbage-collector-and-profiling"></a>Сборщик мусора SGen и профилирование

[SGen](https://www.mono-project.com/docs/advanced/garbage-collector/sgen/) сборщик мусора используется для всех платформ Xamarin.

SGen является generational GC, который выделяет память для объектов из приложения в трех куч — Инкубатор, основная куча и пространство больших объектов. Это позволяет быстрее выполнения сборки мусора. SGen в данный момент сборщик Мусора по умолчанию для Xamarin.Android и приложения Xamarin.iOS Unified.

Приложение Xamarin.iOS в классический API используется сборщик Мусора Boehm — консервативной, не учитывающий сборщику мусора. Как это консервативной, это менее вероятно освободить память, что может привести к неточные результаты, при использовании профилировщика. По этой причине инструмента распределения не может использоваться с сборщика Boehm.

Появится диалоговое окно сообщения, если ваше приложение использует сборщик Мусора Boehm, Xamarin не рекомендуем переключение существующего приложения iOS, используйте Boehm для SGen без тщательного исследования и тщательного тестирования. Xamarin также не рекомендуем переключение на SGen для профилирования и затем переключиться обратно, так как эти результаты не будет предоставлять точные показатели использования памяти.

Дополнительные сведения о управление памятью, см. [памяти и рекомендации по повышению производительности](~/cross-platform/deploy-test/memory-perf-best-practices.md) руководства.

## <a name="summary"></a>Сводка

В этом руководстве мы рассмотрели какие профилирования и как он является предпочтительным для разработчика. Затем мы представили Xamarin Profiler, предоставляя некоторые журнал и сведения о его работе. Наконец мы особое функции Xamarin Profiler и изучили выделения памяти и времени Instruments Profiler.

## <a name="related-links"></a>Связанные ссылки

- [Рекомендации по памяти и производительности](~/cross-platform/deploy-test/memory-perf-best-practices.md)
- [Заметки о выпуске](https://developer.xamarin.com/releases/profiler/preview/)
