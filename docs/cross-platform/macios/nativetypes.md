---
title: Собственные типы для iOS и macOS
description: В этом документе описывается, как Unified API в Xamarin сопоставляет типы .NET с 32-разрядными и 64-разрядными машинными типами по мере необходимости на основе целевой архитектуры компиляции.
ms.prod: xamarin
ms.assetid: B5237770-0FC3-4B01-9E22-766B35C9A952
author: davidortinau
ms.author: daortin
ms.date: 01/25/2016
ms.openlocfilehash: 1168dfe0f2120e87c57b46011caba5e7a8a0c020
ms.sourcegitcommit: 2fbe4932a319af4ebc829f65eb1fb1816ba305d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73015480"
---
# <a name="native-types-for-ios-and-macos"></a>Собственные типы для iOS и macOS

Интерфейсы API Mac и iOS используют специфические для архитектуры типы данных, всегда 32 бит на 32-разрядных платформах и 64 бит на 64-разрядных платформах.

Например, цель-C сопоставляет `NSInteger` тип данных с `int32_t` в 32-разрядных системах и `int64_t` на 64 разрядных системах.

Для обеспечения соответствия этому поведению в нашем унифицированном API мы заменяем предыдущие варианты использования `int` (которые в .NET определены как всегда `System.Int32`) в новый тип данных: `System.nint`. "N" можно представить как "машинный код", поэтому собственный целочисленный тип платформы.

С этими новыми типами данных один и тот же исходный код компилируется для 32-разрядных и 64-разрядных архитектур в зависимости от флагов компиляции.

## <a name="new-data-types"></a>Новые типы данных

В следующей таблице показаны изменения наших типов данных в соответствии с новым 32-разрядным миром.

|Собственный тип|32-разрядный тип резервного копирования|64-разрядный тип резервного копирования|
|--- |--- |--- |
|`System.nint`|`System.Int32` (`int`)|`System.Int64` (`long`)|
|`System.nuint`|`System.UInt32` (`uint`)|`System.UInt64` (`ulong`)|
|`System.nfloat`|`System.Single` (`float`)|`System.Double` (`double`)|

Мы выбрали эти имена, чтобы C# код мог выглядеть более или менее точно так же, как на сегодняшний день.

### <a name="implicit-and-explicit-conversions"></a>Явные и неявные преобразования

Структура новых типов данных предназначена для того, чтобы один C# исходный файл использовался для естественного использования 32 или 64-разрядного хранилища в зависимости от платформы узла и параметров компиляции.

Это требовало бы разработки набора явных и неявных преобразований в типы данных платформы и из типов данных с плавающей запятой .NET.

Операторы неявных преобразований предоставляются при отсутствии возможности потери данных (32 разрядов хранятся в 64-разрядном пространстве).

Операторы явного преобразования предоставляются при возможной потере данных (64-разрядное значение хранится в расположении 32 или потенциально 32).

`int`, `uint` и `float` неявно преобразуемыми в `nint`, `nuint` и `nfloat`, так как 32 бит всегда помещается в 32 или 64 бит.

`nint`, `nuint` и `nfloat` все неявно преобразуются в `long`, `ulong` и `double` как 32 или 64 разрядные значения всегда будут помещаться в 64 бит хранения.

Необходимо использовать явные преобразования из `nint`, `nuint` и `nfloat` в `int`, `uint` и `float`, так как собственные типы могут содержать 64 бит хранилища.

Необходимо использовать явные преобразования из `long`, `ulong` и `double` в `nint`, `nuint` и `nfloat`, так как собственные типы могут содержать только 32 бит хранилища.

## <a name="coregraphics-types"></a>Типы Кореграфикс

Типы данных Point, Size и Rectangle, используемые с Кореграфикс, используют биты 32 или 64 в зависимости от устройства, на котором они выполняются.  При первоначальной привязке интерфейсов API iOS и Mac мы использовали существующие структуры данных в соответствии с размерами платформы узла (типы данных в `System.Drawing`).

При переходе к **единой системе**необходимо заменить экземпляры `System.Drawing` своими аналогами `CoreGraphics`, как показано в следующей таблице.

|Старый тип в System. Drawing|Новый тип данных Кореграфикс|Описание|
|--- |--- |--- |
|`RectangleF`|`CGRect`|Содержит сведения о прямоугольнике с плавающей точкой.|
|`SizeF`|`CGSize`|Содержит сведения о размере с плавающей запятой (ширина, высота)|
|`PointF`|`CGPoint`|Содержит плавающую точку, сведения о точке (X, Y)|

Старые типы данных использовались для хранения элементов структур данных, в то время как в новом используется `System.nfloat`.

## <a name="related-links"></a>Связанные ссылки

- [Работа с собственными типами в кроссплатформенных приложениях](~/cross-platform/macios/native-types-cross-platform.md)
- [Различия между классическими и Unified APIми](https://github.com/xamarin/release-notes-archive/blob/master/release-notes/ios/api_changes/classic-vs-unified-8.6.0/index.md)
