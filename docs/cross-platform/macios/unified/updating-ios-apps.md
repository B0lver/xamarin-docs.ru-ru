---
title: Обновление имеющихся приложений iOS
description: В этом документе описаны шаги, которые должны выполняться для обновления приложения Xamarin.iOS из классический API на единый API.
ms.prod: xamarin
ms.assetid: 303C36A8-CBF4-48C0-9412-387E95024CAB
author: asb3993
ms.author: amburns
ms.date: 03/29/2017
ms.openlocfilehash: 4d506232903d4a94ac20a1fb9f93a39884d9099c
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61213718"
---
# <a name="updating-existing-ios-apps"></a>Обновление имеющихся приложений iOS

_Выполните следующие действия для обновления существующего приложения для использования на единый API Xamarin.iOS._

Обновление существующего приложения для использования на единый API требуется внести изменения в файле проекта также пространства имен и API, используемые в коде приложения.

## <a name="the-road-to-64-bits"></a>Пути к 64-разрядная

Новые интерфейсы API единой необходимы для поддержки 64-разрядных архитектур из мобильных приложений Xamarin.iOS. Начиная с 1 февраля 2015 г. компания Apple требует, что все новые отправки приложения в iTunes App Store поддержки 64-разрядных архитектур.

Xamarin предоставляет средства для Visual Studio для Mac и Visual Studio для автоматизации процесса миграции с классической API на единый API или файлы проекта можно преобразовать вручную. Хотя настоятельно рекомендуется с помощью автоматического средства, в этой статье мы рассмотрим оба метода.

### <a name="before-you-start"></a>Перед началом работы …

Перед обновлением существующего кода на единый API, настоятельно рекомендуется устранить все *предупреждения компиляции*. Многие *предупреждения* в классический API станет как ошибки, после перехода на единой системе. Исправления ошибок, перед началом стало проще, поскольку компилятор сообщений из классический API часто предоставляют рекомендации о том, что для обновления.

## <a name="automated-updating"></a>Автоматическое обновление

После устранения предупреждения, выделите существующий проект iOS в Visual Studio для Mac или Visual Studio и выберите **переходу на единый API Xamarin.iOS** из **проекта** меню. Пример:

![](updating-ios-apps-images/beta-tool1.png "Выберите \"Миграция\" единый API Xamarin.iOS из меню \"проект\"")

Вам потребуется принять данное предупреждение, перед запуском автоматической миграции (очевидно, что следует убедиться у вас есть резервные копии или систему управления версиями перед тем, как это adventure):

![](updating-ios-apps-images/beta-tool2.png "Согласиться на это предупреждение, перед запуском автоматической миграции")

По сути, оно автоматизирует все действия, описанные в **обновления вручную** разделе представленные ниже и он предлагается преобразования существующего проекта Xamarin.iOS на единый API.

## <a name="steps-to-update-manually"></a>Действия для обновления вручную

Опять же после устранения предупреждения выполните следующие действия для ручного обновления приложений Xamarin.iOS для использования на новый единый API.

### <a name="1-update-project-type--build-target"></a>1. Тип обновления проекта & целевого объекта сборки

Изменение версии проекта в вашей **csproj** файлов из `6BC8ED88-2882-458C-8E55-DFD12B67127B` для `FEACFBD2-3405-455C-9665-78FE426C6842`. Изменить **csproj** файл в текстовом редакторе, заменив первый элемент в `<ProjectTypeGuids>` элемент, как показано:

![](updating-ios-apps-images/csproj.png "Изменить csproj-файла в текстовом редакторе, заменив первый элемент в элемент ProjectTypeGuids, как показано")

Изменение **импорта** элемент, содержащий `Xamarin.MonoTouch.CSharp.targets` для `Xamarin.iOS.CSharp.targets` как показано:

![](updating-ios-apps-images/csproj2.png "Изменить элемент импорта, содержащий Xamarin.MonoTouch.CSharp.targets для Xamarin.iOS.CSharp.targets, как показано")

### <a name="2-update-project-references"></a>2. Обновление ссылок проекта

Разверните проект приложения iOS **ссылки** узла. Первоначально будут отображены * неработающих - **monotouch** ссылку как на этом снимке экрана (так как мы только что изменили тип проекта):

![](updating-ios-apps-images/references.png "Он первоначально будут отображены ссылку разбить monotouch примерно из-за изменения типа проекта")

Щелкните правой кнопкой мыши проект приложения iOS для **изменить ссылки**, затем щелкнуть **monotouch** ссылки и удалите его с помощью кнопки красный «X».

![](updating-ios-apps-images/references-delete-monotouch-sml.png "Правой кнопкой мыши проект приложения iOS, чтобы изменить ссылки, а затем щелкните ссылку на библиотеку monotouch и его удалить с помощью красный значок X кнопки")

Теперь прокрутите в конец списка ссылок, а также делений **Xamarin.iOS** сборки.

![](updating-ios-apps-images/references-add-xamarinios-sml.png "Теперь прокрутите в конец списка ссылок и их сборки Xamarin.iOS")

Нажмите клавишу **ОК** следует сохранить проект ссылки изменения.

### <a name="3-remove-monotouch-from-namespaces"></a>3. Удалить MonoTouch из пространства имен

Удалить **MonoTouch** префикс пространства имен в `using` инструкций или везде, где classname полностью квалифицирован (например) `MonoTouch.UIKit` становится просто `UIKit`).

### <a name="4-remap-types"></a>4. Сопоставление типов

[Собственные типы](~/cross-platform/macios/nativetypes.md) были представлены, которые заменяют некоторые типы, которые ранее были использованы, например для экземпляров `System.Drawing.RectangleF` с `CoreGraphics.CGRect` (к примеру). Полный список типов можно найти на [собственные типы](~/cross-platform/macios/nativetypes.md) страницы.

### <a name="5-fix-method-overrides"></a>5. Исправьте переопределения методов

Некоторые `UIKit` методы были изменены для использования нового подпись [собственные типы](~/cross-platform/macios/nativetypes.md) (такие как `nint`). Если пользовательские подклассы переопределить эти методы, подписи больше не будут соответствовать и приведет к ошибкам. Исправьте эти переопределения методов, изменив подкласс, в соответствии с новой подпись, используя собственные типы.

Примеры включают изменение `public override int NumberOfSections (UITableView tableView)` для возврата `nint` и изменив обе возвращают тип и типы параметров в `public override int RowsInSection (UITableView tableView, int section)` для `nint`.

## <a name="considerations"></a>Особенности

Следующие факторы следует принимать во внимание при преобразовании существующего проекта Xamarin.iOS из классический API в новый единый API, если приложение зависит от того, компонент или пакет NuGet.

### <a name="components"></a>Компоненты

Любой компонент, который включен в приложении также потребуется обновить на единый API или при попытке компиляции возникнет конфликт. Для любой включен компонент замену текущей версии до новой версии из Store компонента Xamarin, который поддерживает единый API и выполните чистую сборку. Любой компонент, который еще не был преобразован автором, будут отображаться 32-разрядная версия только предупреждение в хранилище компонентов.

### <a name="nuget-support"></a>Поддержка NuGet

Хотя мы отправили изменения в NuGet для работы с поддержкой единый API, не было новую версию NuGet, поэтому мы при оценке способы получения NuGet для распознавания новых интерфейсов API.

До этого времени, так же, как компоненты вам потребуется для переключения любой пакет NuGet в проекте версию, которая поддерживает унифицированными API и после выполнения чистой сборки.

> [!IMPORTANT]
> При наличии ошибки в форме _«ошибка 3 нельзя включать в том же проекте Xamarin.iOS «monotouch.dll» и «Xamarin.iOS.dll» — «Xamarin.iOS.dll» указывается явным образом, хотя «monotouch.dll» ссылается "xxx, версия = 0.0.000, Culture = neutral, PublicKeyToken = null'»_ после преобразования приложения Unified API-интерфейсам, это обычно из-за наличия компонента или пакета NuGet в проекте, который не был обновлен на единый API. Необходимо удалить существующий компонент/NuGet, обновление до версии, которая поддерживает унифицированными API и выполните чистую сборку.

## <a name="enabling-64-bit-builds-of-xamarinios-apps"></a>Включение 64-разрядных сборок приложений Xamarin.iOS

Для мобильного приложения Xamarin.iOS, был преобразован в единый API разработчик по-прежнему необходимо позволяют построить приложение для 64-разрядных компьютерах из параметров приложения. См. в разделе **Включение 64 разрядных сборок для приложений Xamarin.iOS** из [32 или 64-разрядных платформ](~/cross-platform/macios/32-and-64/index.md#enable-64) документа подробные инструкции по включению 64-разрядная версия сборки.

## <a name="finishing-up"></a>Завершение

Независимо от того, имеется ли вы решили использовать автоматический или ручной метод для преобразования приложения Xamarin.iOS из классической модели в Unified API-интерфейсы, существует несколько экземпляров, кроме того, требующих ручного вмешательства. См. наш [советы для обновления кода на единый API](~/cross-platform/macios/unified/updating-tips.md) Документирование известных проблем и обходных пути.

## <a name="related-links"></a>Связанные ссылки

- [Советы по обновлению кода в Unified API](~/cross-platform/macios/unified/updating-tips.md)
- [Работа с собственными типами в кроссплатформенных приложениях](~/cross-platform/macios/native-types-cross-platform.md)
- [Классический и отличия Unified API](https://developer.xamarin.com/releases/ios/api_changes/classic-vs-unified-8.6.0/)
- [Миграция на единый API (видео)](http://university.xamarin.com/lightninglectures/migrating-to-the-unified-api)
