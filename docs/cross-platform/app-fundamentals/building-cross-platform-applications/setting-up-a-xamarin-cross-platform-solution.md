---
title: Часть 3. Настройка межплатформенного решения Xamarin
description: В этом документе описывается настройка кросс-платформенного решения в Xamarin. В нем обсуждаются различные стратегии совместного использования кода, такие как общие проекты и .NET Standard.
ms.prod: xamarin
ms.assetid: 4139A6C2-D477-C563-C1AB-98CCD0D10A93
author: davidortinau
ms.author: daortin
ms.date: 03/27/2017
ms.openlocfilehash: e7cde22115830a845ed82aa907195521f36b6866
ms.sourcegitcommit: d8af612b6b3218fea396d2f180e92071c4d4bf92
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/04/2020
ms.locfileid: "75663277"
---
# <a name="part-3---setting-up-a-xamarin-cross-platform-solution"></a>Часть 3. Настройка межплатформенного решения Xamarin

Независимо от того, какие платформы используются, проекты Xamarin используют один и тот же формат файла решения (формат файла Visual Studio **. sln** ). Решения могут совместно использоваться в разных средах разработки, даже если не удается загрузить отдельные проекты (например, проект Windows в Visual Studio для Mac).

При создании нового кросс-платформенного приложения первым шагом является создание пустого решения. В этом разделе объясняется, что происходит дальше: Настройка проектов для создания кросс-платформенных мобильных приложений.

## <a name="sharing-code"></a>Общий доступ к коду

Подробное описание реализации совместного использования кода на разных платформах см. в документе с [вариантами совместного использования кода](~/cross-platform/app-fundamentals/code-sharing.md) .

### <a name="net-standard"></a>.NET Standard

[.NET Standard](~/cross-platform/app-fundamentals/net-standard.md) проекты предоставляют простой способ совместного использования кода на разных платформах, создавая сборки, которые можно использовать в Windows, платформах Xamarin (iOS, Android, Mac) и Linux.
Это рекомендуемый способ совместного использования кода для решений Xamarin.

### <a name="other-options"></a>Другие параметры

По исторически Xamarin использовал [переносимые библиотеки классов (PCL)](~/cross-platform/app-fundamentals/pcl.md)] и [Общие проекты](~/cross-platform/app-fundamentals/shared-projects.md). Ни один из них не рекомендуется для новых проектов. также следует рассмотреть возможность переноса существующих приложений для использования .NET Standard.

## <a name="populating-the-solution"></a>Заполнение решения

Независимо от того, какой метод используется для совместного использования кода, Общая структура решения должна реализовывать многоуровневую архитектуру, которая способствует совместному использованию кода.
Подход Xamarin заключается в группировании кода на два типа проектов:

- **Базовый (или "общий") проект** — запись повторно используемого кода в одном месте для совместного использования на разных платформах. Используйте принципы инкапсуляции, чтобы скрыть детали реализации везде, где это возможно.
- **Проекты приложений для конкретных платформ** — использование повторно используемого кода с минимальными возможными связываниями. Компоненты, зависящие от платформы, добавляются на этом уровне, построенные на основе компонентов, доступных в основном проекте.

### <a name="core-project"></a>Основной проект

Основные проекты, использующие код, должны быть .NET Standard и ссылаться только на сборки, доступные на всех платформах — IE. Общие пространства имен платформы, такие как `System`, `System.Core` и `System.Xml`.

Базовые проекты должны реализовывать как можно больше функций, не связанных с интерфейсом пользователя, что может включать следующие уровни:

- **Уровень данных** — код, который принимает на себя хранение физических данных, например. [SQLite-NET](https://www.nuget.org/packages/sqlite-net-pcl/) или даже XML-файлы. Классы уровня данных обычно используются только на уровне доступа к данным.
- **Уровень доступа к данным** — определяет API, который поддерживает необходимые операции с данными для функциональности приложения, такие как методы для доступа к спискам данных, отдельные элементы данных, а также их создание, изменение и удаление.
- **Уровень доступа к службам** — дополнительный слой для предоставления приложению облачных служб. Содержит код, обращающийся к удаленным сетевым ресурсам (веб-службам, загрузкам образов и т. д.) и, возможно, кэширование результатов.
- **Бизнес-уровень** — определение классов модели, а также классов фасадной или Manager, которые предоставляют функциональные возможности для приложений, зависящих от платформы.

### <a name="platform-specific-application-projects"></a>Проекты приложений для конкретных платформ

Проекты, зависящие от платформы, должны ссылаться на сборки, необходимые для привязки к пакету SDK для каждой платформы (Xamarin. iOS, Xamarin. Android, Xamarin. Mac или Windows), а также к .NET Standardному проекту.

Проекты, зависящие от платформы, должны реализовывать:

- **Уровень приложения** — функции, связанные с платформой, а также привязка и преобразование между объектами бизнес-уровня и пользовательским интерфейсом.
- **Уровень пользовательского интерфейса** — экраны, пользовательские элементы управления пользовательского интерфейса, представление логики проверки.

## <a name="project-references"></a>Ссылки на проекты

Ссылки проекта отражать зависимости для проекта. Базовые проекты ограничивают свои ссылки на общие сборки, чтобы код был легко обмениваться.
Проекты приложений для конкретных платформ ссылаются на проект .NET Standard, а также на любые другие зависящие от платформы сборки, необходимые для использования преимуществ целевой платформы.

Конкретные примеры структурирования проектов приведены в примерах внедрения.

## <a name="adding-files"></a>Добавление файлов

### <a name="build-action"></a>Действие при сборке

Важно правильно задать действие сборки для определенных типов файлов. В этом списке показано действие сборки для некоторых распространенных типов файлов:

- **Все C# файлы** — действие сборки: компилировать
- **Изображения в Xamarin. iOS & Windows** — действие сборки: содержимое
- **XIB и файлы раскадровки в Xamarin. iOS** — действие сборки: интерфацедефинитион
- **Изображения и макеты XML в Android** — действие сборки: AndroidResource
- **XAML-файлы в проектах Windows** — действие сборки: страница
- **Файлы XAML Xamarin. Forms** — действие сборки: EmbeddedResource

Как правило, интегрированная среда разработки определит тип файла и предложит правильное действие сборки.

### <a name="case-sensitivity"></a>Учитывать регистр

Наконец, помните, что некоторые платформы имеют файловые системы с учетом регистра (например,
iOS и Android), поэтому обязательно используйте согласованный стандарт именования файлов и убедитесь, что имена файлов, используемые в коде, точно соответствуют файловой системе. Это особенно важно для изображений и других ресурсов, на которые вы ссылаетесь в коде.
